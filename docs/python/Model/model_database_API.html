<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 15.0.1"/>
    <title>Model.model_database_API API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:.75rem center;margin-bottom:1rem;}.pdoc .alert > em{display:none;}.pdoc .alert > *:last-child{margin-bottom:0;}.pdoc .alert.note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .alert.warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .alert.danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .decorator-deprecated{color:#842029;}.pdoc .decorator-deprecated ~ span{filter:grayscale(1) opacity(0.8);}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../Model.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;Model</a>


            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="variable" href="#DATABASE_URL">DATABASE_URL</a>
            </li>
            <li>
                    <a class="variable" href="#engine">engine</a>
            </li>
            <li>
                    <a class="variable" href="#SessionLocal">SessionLocal</a>
            </li>
            <li>
                    <a class="class" href="#Base">Base</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Base.__init__">Base</a>
                        </li>
                        <li>
                                <a class="variable" href="#Base.registry">registry</a>
                        </li>
                        <li>
                                <a class="variable" href="#Base.metadata">metadata</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="variable" href="#app">app</a>
            </li>
            <li>
                    <a class="function" href="#get_db">get_db</a>
            </li>
            <li>
                    <a class="function" href="#get_inspection_docs">get_inspection_docs</a>
            </li>
            <li>
                    <a class="function" href="#get_inspection_doc">get_inspection_doc</a>
            </li>
            <li>
                    <a class="function" href="#edit_inspection_report">edit_inspection_report</a>
            </li>
            <li>
                    <a class="function" href="#get_inspection_term">get_inspection_term</a>
            </li>
            <li>
                    <a class="function" href="#edit_inspection_team">edit_inspection_team</a>
            </li>
            <li>
                    <a class="function" href="#get_inspection_terms">get_inspection_terms</a>
            </li>
            <li>
                    <a class="function" href="#remove_teacher_from_team">remove_teacher_from_team</a>
            </li>
            <li>
                    <a class="function" href="#get_lesson_with_dates">get_lesson_with_dates</a>
            </li>
            <li>
                    <a class="function" href="#get_inspection_teams">get_inspection_teams</a>
            </li>
            <li>
                    <a class="function" href="#create_inspection_team">create_inspection_team</a>
            </li>
            <li>
                    <a class="function" href="#view_inspection_team">view_inspection_team</a>
            </li>
            <li>
                    <a class="function" href="#add_teacher_to_team">add_teacher_to_team</a>
            </li>
            <li>
                    <a class="function" href="#get_specified_inspection_teams">get_specified_inspection_teams</a>
            </li>
            <li>
                    <a class="function" href="#get_teachers">get_teachers</a>
            </li>
            <li>
                    <a class="function" href="#get_subjects">get_subjects</a>
            </li>
            <li>
                    <a class="function" href="#get_lessons">get_lessons</a>
            </li>
            <li>
                    <a class="function" href="#get_available_semesters">get_available_semesters</a>
            </li>
            <li>
                    <a class="function" href="#get_schedule">get_schedule</a>
            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
<a href="./../Model.html">Model</a><wbr>.model_database_API    </h1>

                
                        <input id="mod-model_database_API-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-model_database_API-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">   1</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">   2</span></a>
</span><span id="L-3"><a href="#L-3"><span class="linenos">   3</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">uvicorn</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos">   4</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">fastapi</span><span class="w"> </span><span class="kn">import</span> <span class="n">Depends</span><span class="p">,</span> <span class="n">FastAPI</span><span class="p">,</span> <span class="n">HTTPException</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">   5</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">fastapi.middleware.cors</span><span class="w"> </span><span class="kn">import</span> <span class="n">CORSMiddleware</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">   6</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.models_pydantic</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">   7</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.models_sqlalchemy</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">   8</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">sqlalchemy</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_engine</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">   9</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">sqlalchemy.exc</span><span class="w"> </span><span class="kn">import</span> <span class="n">IntegrityError</span><span class="p">,</span> <span class="n">NoResultFound</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos">  10</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">sqlalchemy.orm</span><span class="w"> </span><span class="kn">import</span> <span class="n">aliased</span><span class="p">,</span> <span class="n">declarative_base</span><span class="p">,</span> <span class="n">sessionmaker</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos">  11</span></a>
</span><span id="L-12"><a href="#L-12"><span class="linenos">  12</span></a><span class="n">DATABASE_URL</span> <span class="o">=</span> <span class="s2">&quot;postgresql://postgres:postgres@localhost/inspections&quot;</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos">  13</span></a><span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">DATABASE_URL</span><span class="p">)</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos">  14</span></a><span class="n">SessionLocal</span> <span class="o">=</span> <span class="n">sessionmaker</span><span class="p">(</span><span class="n">autocommit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">autoflush</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">bind</span><span class="o">=</span><span class="n">engine</span><span class="p">)</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos">  15</span></a><span class="n">Base</span> <span class="o">=</span> <span class="n">declarative_base</span><span class="p">()</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos">  16</span></a>
</span><span id="L-17"><a href="#L-17"><span class="linenos">  17</span></a><span class="n">app</span> <span class="o">=</span> <span class="n">FastAPI</span><span class="p">()</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos">  18</span></a>
</span><span id="L-19"><a href="#L-19"><span class="linenos">  19</span></a><span class="n">app</span><span class="o">.</span><span class="n">add_middleware</span><span class="p">(</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos">  20</span></a>    <span class="n">CORSMiddleware</span><span class="p">,</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos">  21</span></a>    <span class="n">allow_origins</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;*&quot;</span><span class="p">],</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos">  22</span></a>    <span class="n">allow_credentials</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos">  23</span></a>    <span class="n">allow_methods</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;*&quot;</span><span class="p">],</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos">  24</span></a>    <span class="n">allow_headers</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;*&quot;</span><span class="p">],</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos">  25</span></a><span class="p">)</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos">  26</span></a>
</span><span id="L-27"><a href="#L-27"><span class="linenos">  27</span></a>
</span><span id="L-28"><a href="#L-28"><span class="linenos">  28</span></a><span class="k">def</span><span class="w"> </span><span class="nf">get_db</span><span class="p">():</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos">  29</span></a>    <span class="n">db</span> <span class="o">=</span> <span class="n">SessionLocal</span><span class="p">()</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos">  30</span></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos">  31</span></a>        <span class="k">yield</span> <span class="n">db</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos">  32</span></a>    <span class="k">finally</span><span class="p">:</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos">  33</span></a>        <span class="n">db</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos">  34</span></a>
</span><span id="L-35"><a href="#L-35"><span class="linenos">  35</span></a>
</span><span id="L-36"><a href="#L-36"><span class="linenos">  36</span></a><span class="nd">@app</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;/inspection-docs/&quot;</span><span class="p">,</span> <span class="n">response_model</span><span class="o">=</span><span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">])</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos">  37</span></a><span class="k">def</span><span class="w"> </span><span class="nf">get_inspection_docs</span><span class="p">(</span><span class="n">db</span><span class="p">:</span> <span class="n">sessionmaker</span> <span class="o">=</span> <span class="n">Depends</span><span class="p">(</span><span class="n">get_db</span><span class="p">)):</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos">  38</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos">  39</span></a><span class="sd">    Fetch inspection documents from the database.</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos">  40</span></a>
</span><span id="L-41"><a href="#L-41"><span class="linenos">  41</span></a><span class="sd">    This endpoint retrieves a list of inspection documents, including details such as</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos">  42</span></a><span class="sd">    the inspection date, subject, and teacher information. Data is queried from the</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos">  43</span></a><span class="sd">    database using SQLAlchemy and structured into a response-friendly format.</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos">  44</span></a>
</span><span id="L-45"><a href="#L-45"><span class="linenos">  45</span></a><span class="sd">    Args:</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos">  46</span></a><span class="sd">        db (sessionmaker): The database session dependency injected by FastAPI.</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos">  47</span></a>
</span><span id="L-48"><a href="#L-48"><span class="linenos">  48</span></a><span class="sd">    Returns:</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos">  49</span></a><span class="sd">        list[dict]: A list of dictionaries containing the following keys:</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos">  50</span></a><span class="sd">            - id (int): The ID of the inspection document.</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos">  51</span></a><span class="sd">            - date (datetime): The date of the inspection.</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos">  52</span></a><span class="sd">            - subject (str): The name of the subject.</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos">  53</span></a><span class="sd">            - teacher (str): The full name of the teacher, including title, first name, and surname.</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos">  54</span></a>
</span><span id="L-55"><a href="#L-55"><span class="linenos">  55</span></a><span class="sd">    Example Response:</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos">  56</span></a><span class="sd">        [</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos">  57</span></a><span class="sd">            {</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos">  58</span></a><span class="sd">                &quot;id&quot;: 1,</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos">  59</span></a><span class="sd">                &quot;date&quot;: &quot;2025-01-01T10:00:00&quot;,</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos">  60</span></a><span class="sd">                &quot;subject&quot;: &quot;Mathematics&quot;,</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos">  61</span></a><span class="sd">                &quot;teacher&quot;: &quot;Dr. John Doe&quot;</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos">  62</span></a><span class="sd">            },</span>
</span><span id="L-63"><a href="#L-63"><span class="linenos">  63</span></a><span class="sd">            ...</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos">  64</span></a><span class="sd">        ]</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos">  65</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos">  66</span></a>    <span class="n">inspection_docs</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos">  67</span></a>        <span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos">  68</span></a>            <span class="n">InspectionReport</span><span class="o">.</span><span class="n">id</span><span class="o">.</span><span class="n">label</span><span class="p">(</span><span class="s2">&quot;document_id&quot;</span><span class="p">),</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos">  69</span></a>            <span class="n">Lesson</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">label</span><span class="p">(</span><span class="s2">&quot;inspection_date&quot;</span><span class="p">),</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos">  70</span></a>            <span class="n">Subject</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">label</span><span class="p">(</span><span class="s2">&quot;subject_name&quot;</span><span class="p">),</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos">  71</span></a>            <span class="n">Subject</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">label</span><span class="p">(</span><span class="s2">&quot;subject_type&quot;</span><span class="p">),</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos">  72</span></a>            <span class="n">Teacher</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">label</span><span class="p">(</span><span class="s2">&quot;teacher_name&quot;</span><span class="p">),</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos">  73</span></a>            <span class="n">Teacher</span><span class="o">.</span><span class="n">surname</span><span class="o">.</span><span class="n">label</span><span class="p">(</span><span class="s2">&quot;teacher_surname&quot;</span><span class="p">),</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos">  74</span></a>            <span class="n">Teacher</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">label</span><span class="p">(</span><span class="s2">&quot;teacher_title&quot;</span><span class="p">),</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos">  75</span></a>        <span class="p">)</span>
</span><span id="L-76"><a href="#L-76"><span class="linenos">  76</span></a>        <span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">Inspection</span><span class="p">,</span> <span class="n">Inspection</span><span class="o">.</span><span class="n">fk_inspectionReport</span> <span class="o">==</span> <span class="n">InspectionReport</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos">  77</span></a>        <span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">Lesson</span><span class="p">,</span> <span class="n">Inspection</span><span class="o">.</span><span class="n">fk_lesson</span> <span class="o">==</span> <span class="n">Lesson</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos">  78</span></a>        <span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">Subject</span><span class="p">,</span> <span class="n">Lesson</span><span class="o">.</span><span class="n">fk_subject</span> <span class="o">==</span> <span class="n">Subject</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos">  79</span></a>        <span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">Teacher</span><span class="p">,</span> <span class="n">Lesson</span><span class="o">.</span><span class="n">fk_teacher</span> <span class="o">==</span> <span class="n">Teacher</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos">  80</span></a>        <span class="o">.</span><span class="n">all</span><span class="p">()</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos">  81</span></a>    <span class="p">)</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos">  82</span></a>    <span class="n">result</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos">  83</span></a>        <span class="p">{</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos">  84</span></a>            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="n">doc</span><span class="o">.</span><span class="n">document_id</span><span class="p">,</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos">  85</span></a>            <span class="s2">&quot;date&quot;</span><span class="p">:</span> <span class="n">doc</span><span class="o">.</span><span class="n">inspection_date</span><span class="p">,</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos">  86</span></a>            <span class="s2">&quot;subject&quot;</span><span class="p">:</span> <span class="n">doc</span><span class="o">.</span><span class="n">subject_name</span><span class="p">,</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos">  87</span></a>            <span class="s2">&quot;subject_type&quot;</span><span class="p">:</span> <span class="n">doc</span><span class="o">.</span><span class="n">subject_type</span><span class="p">,</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos">  88</span></a>            <span class="s2">&quot;teacher&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">doc</span><span class="o">.</span><span class="n">teacher_title</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">doc</span><span class="o">.</span><span class="n">teacher_name</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">doc</span><span class="o">.</span><span class="n">teacher_surname</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos">  89</span></a>        <span class="p">}</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos">  90</span></a>        <span class="k">for</span> <span class="n">doc</span> <span class="ow">in</span> <span class="n">inspection_docs</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos">  91</span></a>    <span class="p">]</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos">  92</span></a>    <span class="k">return</span> <span class="n">result</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos">  93</span></a>
</span><span id="L-94"><a href="#L-94"><span class="linenos">  94</span></a>
</span><span id="L-95"><a href="#L-95"><span class="linenos">  95</span></a><span class="nd">@app</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;/inspection-docs/</span><span class="si">{docs_id}</span><span class="s2">/&quot;</span><span class="p">,</span> <span class="n">response_model</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos">  96</span></a><span class="k">def</span><span class="w"> </span><span class="nf">get_inspection_doc</span><span class="p">(</span><span class="n">docs_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">db</span><span class="p">:</span> <span class="n">sessionmaker</span> <span class="o">=</span> <span class="n">Depends</span><span class="p">(</span><span class="n">get_db</span><span class="p">)):</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos">  97</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos">  98</span></a><span class="sd">    Fetch a specific inspection document by its ID.</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos">  99</span></a>
</span><span id="L-100"><a href="#L-100"><span class="linenos"> 100</span></a><span class="sd">    This endpoint retrieves detailed information about a specific inspection document,</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos"> 101</span></a><span class="sd">    including teacher, subject, inspection team, and report ratings.</span>
</span><span id="L-102"><a href="#L-102"><span class="linenos"> 102</span></a>
</span><span id="L-103"><a href="#L-103"><span class="linenos"> 103</span></a><span class="sd">    Args:</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos"> 104</span></a><span class="sd">        docs_id (int): The unique identifier of the inspection document.</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos"> 105</span></a><span class="sd">        db (sessionmaker): The database session dependency injected by FastAPI.</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos"> 106</span></a>
</span><span id="L-107"><a href="#L-107"><span class="linenos"> 107</span></a><span class="sd">    Raises:</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos"> 108</span></a><span class="sd">        HTTPException: If the inspection document with the given ID is not found.</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos"> 109</span></a>
</span><span id="L-110"><a href="#L-110"><span class="linenos"> 110</span></a><span class="sd">    Returns:</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos"> 111</span></a><span class="sd">        dict: A dictionary containing the inspection document details:</span>
</span><span id="L-112"><a href="#L-112"><span class="linenos"> 112</span></a><span class="sd">            - inspected_name (str): Full name (with title) of the inspected teacher.</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos"> 113</span></a><span class="sd">            - department_name (str): Department of the inspected teacher.</span>
</span><span id="L-114"><a href="#L-114"><span class="linenos"> 114</span></a><span class="sd">            - date_of_inspection (datetime): Date and time of the inspection.</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos"> 115</span></a><span class="sd">            - subject_name (str): Name of the subject inspected.</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos"> 116</span></a><span class="sd">            - subject_code (int): Code/ID of the subject inspected.</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos"> 117</span></a><span class="sd">            - inspectors (list[dict]): List of inspectors, with:</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos"> 118</span></a><span class="sd">                - name (str): Inspector&#39;s name.</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos"> 119</span></a><span class="sd">                - surname (str): Inspector&#39;s surname.</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos"> 120</span></a><span class="sd">                - title (str): Inspector&#39;s title.</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos"> 121</span></a><span class="sd">            - lateness_minutes (int): Lateness duration in minutes, if any.</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos"> 122</span></a><span class="sd">            - student_attendance (int): Number of students present during inspection.</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos"> 123</span></a><span class="sd">            - room_adaptation (bool): Whether the room was adapted for the lesson.</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos"> 124</span></a><span class="sd">            - content_compatibility (bool): Whether content was compatible with objectives.</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos"> 125</span></a><span class="sd">            - substantive_rating (float): Rating for the substantive content.</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos"> 126</span></a><span class="sd">            - final_rating (float): Final rating of the inspection.</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos"> 127</span></a><span class="sd">            - objection (str | None): Any objections noted in the report.</span>
</span><span id="L-128"><a href="#L-128"><span class="linenos"> 128</span></a>
</span><span id="L-129"><a href="#L-129"><span class="linenos"> 129</span></a><span class="sd">    Example Response:</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos"> 130</span></a><span class="sd">        {</span>
</span><span id="L-131"><a href="#L-131"><span class="linenos"> 131</span></a><span class="sd">            &quot;inspected_name&quot;: &quot;Dr. Jane Doe&quot;,</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos"> 132</span></a><span class="sd">            &quot;department_name&quot;: &quot;Mathematics&quot;,</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos"> 133</span></a><span class="sd">            &quot;date_of_inspection&quot;: &quot;2025-01-01T10:00:00&quot;,</span>
</span><span id="L-134"><a href="#L-134"><span class="linenos"> 134</span></a><span class="sd">            &quot;subject_name&quot;: &quot;Calculus&quot;,</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos"> 135</span></a><span class="sd">            &quot;subject_code&quot;: 101,</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos"> 136</span></a><span class="sd">            &quot;inspectors&quot;: [</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos"> 137</span></a><span class="sd">                {&quot;name&quot;: &quot;John&quot;, &quot;surname&quot;:&quot;Smith&quot; , &quot;title&quot;: &quot;SeniorMr.&quot;}</span>
</span><span id="L-138"><a href="#L-138"><span class="linenos"> 138</span></a><span class="sd">            ],</span>
</span><span id="L-139"><a href="#L-139"><span class="linenos"> 139</span></a><span class="sd">            &quot;lateness_minutes&quot;: 0,</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos"> 140</span></a><span class="sd">            &quot;student_attendance&quot;: 25,</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos"> 141</span></a><span class="sd">            &quot;room_adaptation&quot;: true,</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos"> 142</span></a><span class="sd">            &quot;content_compatibility&quot;: true,</span>
</span><span id="L-143"><a href="#L-143"><span class="linenos"> 143</span></a><span class="sd">            &quot;substantive_rating&quot;: 4.5,</span>
</span><span id="L-144"><a href="#L-144"><span class="linenos"> 144</span></a><span class="sd">            &quot;final_rating&quot;: 4.8,</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos"> 145</span></a><span class="sd">            &quot;objection&quot;: None</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos"> 146</span></a><span class="sd">        }</span>
</span><span id="L-147"><a href="#L-147"><span class="linenos"> 147</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-148"><a href="#L-148"><span class="linenos"> 148</span></a>
</span><span id="L-149"><a href="#L-149"><span class="linenos"> 149</span></a>    <span class="n">teacher_alias_1</span> <span class="o">=</span> <span class="n">aliased</span><span class="p">(</span><span class="n">Teacher</span><span class="p">)</span>
</span><span id="L-150"><a href="#L-150"><span class="linenos"> 150</span></a>    <span class="n">teacher_alias_2</span> <span class="o">=</span> <span class="n">aliased</span><span class="p">(</span><span class="n">Teacher</span><span class="p">)</span>
</span><span id="L-151"><a href="#L-151"><span class="linenos"> 151</span></a>    <span class="n">inspection</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos"> 152</span></a>        <span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">Inspection</span><span class="p">)</span>
</span><span id="L-153"><a href="#L-153"><span class="linenos"> 153</span></a>        <span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">Lesson</span><span class="p">,</span> <span class="n">Lesson</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">Inspection</span><span class="o">.</span><span class="n">fk_lesson</span><span class="p">)</span>
</span><span id="L-154"><a href="#L-154"><span class="linenos"> 154</span></a>        <span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">Subject</span><span class="p">,</span> <span class="n">Subject</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">Lesson</span><span class="o">.</span><span class="n">fk_subject</span><span class="p">)</span>
</span><span id="L-155"><a href="#L-155"><span class="linenos"> 155</span></a>        <span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">teacher_alias_1</span><span class="p">,</span> <span class="n">teacher_alias_1</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">Lesson</span><span class="o">.</span><span class="n">fk_teacher</span><span class="p">)</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos"> 156</span></a>        <span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">InspectionReport</span><span class="p">,</span> <span class="n">InspectionReport</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">Inspection</span><span class="o">.</span><span class="n">fk_inspectionReport</span><span class="p">)</span>
</span><span id="L-157"><a href="#L-157"><span class="linenos"> 157</span></a>        <span class="o">.</span><span class="n">outerjoin</span><span class="p">(</span><span class="n">InspectionTeam</span><span class="p">,</span> <span class="n">InspectionTeam</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">Inspection</span><span class="o">.</span><span class="n">fk_inspectionTeam</span><span class="p">)</span>
</span><span id="L-158"><a href="#L-158"><span class="linenos"> 158</span></a>        <span class="o">.</span><span class="n">outerjoin</span><span class="p">(</span>
</span><span id="L-159"><a href="#L-159"><span class="linenos"> 159</span></a>            <span class="n">TeacherInspectionTeam</span><span class="p">,</span>
</span><span id="L-160"><a href="#L-160"><span class="linenos"> 160</span></a>            <span class="n">TeacherInspectionTeam</span><span class="o">.</span><span class="n">fk_inspectionTeam</span> <span class="o">==</span> <span class="n">InspectionTeam</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos"> 161</span></a>        <span class="p">)</span>
</span><span id="L-162"><a href="#L-162"><span class="linenos"> 162</span></a>        <span class="o">.</span><span class="n">outerjoin</span><span class="p">(</span>
</span><span id="L-163"><a href="#L-163"><span class="linenos"> 163</span></a>            <span class="n">teacher_alias_2</span><span class="p">,</span> <span class="n">teacher_alias_2</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">TeacherInspectionTeam</span><span class="o">.</span><span class="n">fk_teacher</span>
</span><span id="L-164"><a href="#L-164"><span class="linenos"> 164</span></a>        <span class="p">)</span>
</span><span id="L-165"><a href="#L-165"><span class="linenos"> 165</span></a>        <span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">Inspection</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">docs_id</span><span class="p">)</span>
</span><span id="L-166"><a href="#L-166"><span class="linenos"> 166</span></a>        <span class="o">.</span><span class="n">first</span><span class="p">()</span>
</span><span id="L-167"><a href="#L-167"><span class="linenos"> 167</span></a>    <span class="p">)</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos"> 168</span></a>
</span><span id="L-169"><a href="#L-169"><span class="linenos"> 169</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">inspection</span><span class="p">:</span>
</span><span id="L-170"><a href="#L-170"><span class="linenos"> 170</span></a>        <span class="k">raise</span> <span class="n">HTTPException</span><span class="p">(</span><span class="n">status_code</span><span class="o">=</span><span class="mi">404</span><span class="p">,</span> <span class="n">detail</span><span class="o">=</span><span class="s2">&quot;Inspection document not found&quot;</span><span class="p">)</span>
</span><span id="L-171"><a href="#L-171"><span class="linenos"> 171</span></a>
</span><span id="L-172"><a href="#L-172"><span class="linenos"> 172</span></a>    <span class="n">inspection_details</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-173"><a href="#L-173"><span class="linenos"> 173</span></a>        <span class="s2">&quot;inspected_name&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">inspection</span><span class="o">.</span><span class="n">lesson</span><span class="o">.</span><span class="n">teacher</span><span class="o">.</span><span class="n">title</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">inspection</span><span class="o">.</span><span class="n">lesson</span><span class="o">.</span><span class="n">teacher</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="L-174"><a href="#L-174"><span class="linenos"> 174</span></a>        <span class="s2">&quot;department_name&quot;</span><span class="p">:</span> <span class="n">inspection</span><span class="o">.</span><span class="n">lesson</span><span class="o">.</span><span class="n">teacher</span><span class="o">.</span><span class="n">department</span><span class="p">,</span>
</span><span id="L-175"><a href="#L-175"><span class="linenos"> 175</span></a>        <span class="s2">&quot;date_of_inspection&quot;</span><span class="p">:</span> <span class="n">inspection</span><span class="o">.</span><span class="n">lesson</span><span class="o">.</span><span class="n">time</span><span class="p">,</span>
</span><span id="L-176"><a href="#L-176"><span class="linenos"> 176</span></a>        <span class="s2">&quot;subject_name&quot;</span><span class="p">:</span> <span class="n">inspection</span><span class="o">.</span><span class="n">lesson</span><span class="o">.</span><span class="n">subject</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos"> 177</span></a>        <span class="s2">&quot;subject_code&quot;</span><span class="p">:</span> <span class="n">inspection</span><span class="o">.</span><span class="n">lesson</span><span class="o">.</span><span class="n">subject</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
</span><span id="L-178"><a href="#L-178"><span class="linenos"> 178</span></a>        <span class="s2">&quot;inspectors&quot;</span><span class="p">:</span> <span class="p">(</span>
</span><span id="L-179"><a href="#L-179"><span class="linenos"> 179</span></a>            <span class="p">[</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos"> 180</span></a>                <span class="p">{</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos"> 181</span></a>                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">inspector</span><span class="o">.</span><span class="n">teacher</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos"> 182</span></a>                    <span class="s2">&quot;surname&quot;</span><span class="p">:</span> <span class="n">inspector</span><span class="o">.</span><span class="n">teacher</span><span class="o">.</span><span class="n">surname</span><span class="p">,</span>
</span><span id="L-183"><a href="#L-183"><span class="linenos"> 183</span></a>                    <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="n">inspector</span><span class="o">.</span><span class="n">teacher</span><span class="o">.</span><span class="n">title</span><span class="p">,</span>
</span><span id="L-184"><a href="#L-184"><span class="linenos"> 184</span></a>                <span class="p">}</span>
</span><span id="L-185"><a href="#L-185"><span class="linenos"> 185</span></a>                <span class="k">for</span> <span class="n">inspector</span> <span class="ow">in</span> <span class="n">inspection</span><span class="o">.</span><span class="n">inspection_team</span><span class="o">.</span><span class="n">teachers</span>
</span><span id="L-186"><a href="#L-186"><span class="linenos"> 186</span></a>                <span class="k">if</span> <span class="n">inspector</span><span class="o">.</span><span class="n">teacher</span>
</span><span id="L-187"><a href="#L-187"><span class="linenos"> 187</span></a>            <span class="p">]</span>
</span><span id="L-188"><a href="#L-188"><span class="linenos"> 188</span></a>            <span class="k">if</span> <span class="n">inspection</span><span class="o">.</span><span class="n">inspection_team</span>
</span><span id="L-189"><a href="#L-189"><span class="linenos"> 189</span></a>            <span class="k">else</span> <span class="p">[]</span>
</span><span id="L-190"><a href="#L-190"><span class="linenos"> 190</span></a>        <span class="p">),</span>
</span><span id="L-191"><a href="#L-191"><span class="linenos"> 191</span></a>        <span class="s2">&quot;lateness_minutes&quot;</span><span class="p">:</span> <span class="p">(</span>
</span><span id="L-192"><a href="#L-192"><span class="linenos"> 192</span></a>            <span class="n">inspection</span><span class="o">.</span><span class="n">inspection_report</span><span class="o">.</span><span class="n">lateness_minutes</span>
</span><span id="L-193"><a href="#L-193"><span class="linenos"> 193</span></a>            <span class="k">if</span> <span class="n">inspection</span><span class="o">.</span><span class="n">inspection_report</span><span class="o">.</span><span class="n">lateness_minutes</span>
</span><span id="L-194"><a href="#L-194"><span class="linenos"> 194</span></a>            <span class="k">else</span> <span class="mi">0</span>
</span><span id="L-195"><a href="#L-195"><span class="linenos"> 195</span></a>        <span class="p">),</span>
</span><span id="L-196"><a href="#L-196"><span class="linenos"> 196</span></a>        <span class="s2">&quot;student_attendance&quot;</span><span class="p">:</span> <span class="n">inspection</span><span class="o">.</span><span class="n">inspection_report</span><span class="o">.</span><span class="n">students_attendance</span><span class="p">,</span>
</span><span id="L-197"><a href="#L-197"><span class="linenos"> 197</span></a>        <span class="s2">&quot;room_adaptation&quot;</span><span class="p">:</span> <span class="n">inspection</span><span class="o">.</span><span class="n">inspection_report</span><span class="o">.</span><span class="n">room_adaptation</span><span class="p">,</span>
</span><span id="L-198"><a href="#L-198"><span class="linenos"> 198</span></a>        <span class="s2">&quot;content_compatibility&quot;</span><span class="p">:</span> <span class="n">inspection</span><span class="o">.</span><span class="n">inspection_report</span><span class="o">.</span><span class="n">content_compatibility</span><span class="p">,</span>
</span><span id="L-199"><a href="#L-199"><span class="linenos"> 199</span></a>        <span class="s2">&quot;substantive_rating&quot;</span><span class="p">:</span> <span class="n">inspection</span><span class="o">.</span><span class="n">inspection_report</span><span class="o">.</span><span class="n">substantive_rating</span><span class="p">,</span>
</span><span id="L-200"><a href="#L-200"><span class="linenos"> 200</span></a>        <span class="s2">&quot;final_rating&quot;</span><span class="p">:</span> <span class="n">inspection</span><span class="o">.</span><span class="n">inspection_report</span><span class="o">.</span><span class="n">final_rating</span><span class="p">,</span>
</span><span id="L-201"><a href="#L-201"><span class="linenos"> 201</span></a>        <span class="s2">&quot;objection&quot;</span><span class="p">:</span> <span class="n">inspection</span><span class="o">.</span><span class="n">inspection_report</span><span class="o">.</span><span class="n">objection</span><span class="p">,</span>
</span><span id="L-202"><a href="#L-202"><span class="linenos"> 202</span></a>    <span class="p">}</span>
</span><span id="L-203"><a href="#L-203"><span class="linenos"> 203</span></a>
</span><span id="L-204"><a href="#L-204"><span class="linenos"> 204</span></a>    <span class="k">return</span> <span class="n">inspection_details</span>
</span><span id="L-205"><a href="#L-205"><span class="linenos"> 205</span></a>
</span><span id="L-206"><a href="#L-206"><span class="linenos"> 206</span></a>
</span><span id="L-207"><a href="#L-207"><span class="linenos"> 207</span></a><span class="nd">@app</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="s2">&quot;/inspection-docs/</span><span class="si">{docs_id}</span><span class="s2">/edit/&quot;</span><span class="p">)</span>
</span><span id="L-208"><a href="#L-208"><span class="linenos"> 208</span></a><span class="k">def</span><span class="w"> </span><span class="nf">edit_inspection_report</span><span class="p">(</span>
</span><span id="L-209"><a href="#L-209"><span class="linenos"> 209</span></a>    <span class="n">docs_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">updated_data</span><span class="p">:</span> <span class="n">EditInspectionReport</span><span class="p">,</span> <span class="n">db</span><span class="p">:</span> <span class="n">sessionmaker</span> <span class="o">=</span> <span class="n">Depends</span><span class="p">(</span><span class="n">get_db</span><span class="p">)</span>
</span><span id="L-210"><a href="#L-210"><span class="linenos"> 210</span></a><span class="p">):</span>
</span><span id="L-211"><a href="#L-211"><span class="linenos"> 211</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-212"><a href="#L-212"><span class="linenos"> 212</span></a><span class="sd">    Edit an existing inspection report.</span>
</span><span id="L-213"><a href="#L-213"><span class="linenos"> 213</span></a>
</span><span id="L-214"><a href="#L-214"><span class="linenos"> 214</span></a><span class="sd">    This endpoint allows updating specific fields of an inspection report identified by its ID.</span>
</span><span id="L-215"><a href="#L-215"><span class="linenos"> 215</span></a><span class="sd">    Partial updates are supported, and only the provided fields in the request body will be updated.</span>
</span><span id="L-216"><a href="#L-216"><span class="linenos"> 216</span></a>
</span><span id="L-217"><a href="#L-217"><span class="linenos"> 217</span></a><span class="sd">    Args:</span>
</span><span id="L-218"><a href="#L-218"><span class="linenos"> 218</span></a><span class="sd">        docs_id (int): The unique identifier of the inspection document.</span>
</span><span id="L-219"><a href="#L-219"><span class="linenos"> 219</span></a><span class="sd">        updated_data (EditInspectionReport): Data model containing the fields to update.</span>
</span><span id="L-220"><a href="#L-220"><span class="linenos"> 220</span></a><span class="sd">        db (sessionmaker): The database session dependency injected by FastAPI.</span>
</span><span id="L-221"><a href="#L-221"><span class="linenos"> 221</span></a>
</span><span id="L-222"><a href="#L-222"><span class="linenos"> 222</span></a><span class="sd">    Raises:</span>
</span><span id="L-223"><a href="#L-223"><span class="linenos"> 223</span></a><span class="sd">        HTTPException: If the inspection or its associated report is not found.</span>
</span><span id="L-224"><a href="#L-224"><span class="linenos"> 224</span></a>
</span><span id="L-225"><a href="#L-225"><span class="linenos"> 225</span></a><span class="sd">    Returns:</span>
</span><span id="L-226"><a href="#L-226"><span class="linenos"> 226</span></a><span class="sd">        dict: A success message indicating the report was updated.</span>
</span><span id="L-227"><a href="#L-227"><span class="linenos"> 227</span></a>
</span><span id="L-228"><a href="#L-228"><span class="linenos"> 228</span></a><span class="sd">    Example Request Body (JSON):</span>
</span><span id="L-229"><a href="#L-229"><span class="linenos"> 229</span></a><span class="sd">        {</span>
</span><span id="L-230"><a href="#L-230"><span class="linenos"> 230</span></a><span class="sd">            &quot;lateness_minutes&quot;: 5,</span>
</span><span id="L-231"><a href="#L-231"><span class="linenos"> 231</span></a><span class="sd">            &quot;student_attendance&quot;: 20,</span>
</span><span id="L-232"><a href="#L-232"><span class="linenos"> 232</span></a><span class="sd">            &quot;final_rating&quot;: 4.7</span>
</span><span id="L-233"><a href="#L-233"><span class="linenos"> 233</span></a><span class="sd">        }</span>
</span><span id="L-234"><a href="#L-234"><span class="linenos"> 234</span></a>
</span><span id="L-235"><a href="#L-235"><span class="linenos"> 235</span></a><span class="sd">    Example Response:</span>
</span><span id="L-236"><a href="#L-236"><span class="linenos"> 236</span></a><span class="sd">        {</span>
</span><span id="L-237"><a href="#L-237"><span class="linenos"> 237</span></a><span class="sd">            &quot;message&quot;: &quot;Inspection report updated successfully&quot;</span>
</span><span id="L-238"><a href="#L-238"><span class="linenos"> 238</span></a><span class="sd">        }</span>
</span><span id="L-239"><a href="#L-239"><span class="linenos"> 239</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-240"><a href="#L-240"><span class="linenos"> 240</span></a>
</span><span id="L-241"><a href="#L-241"><span class="linenos"> 241</span></a>    <span class="n">inspection</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-242"><a href="#L-242"><span class="linenos"> 242</span></a>        <span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">Inspection</span><span class="p">)</span>
</span><span id="L-243"><a href="#L-243"><span class="linenos"> 243</span></a>        <span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">InspectionReport</span><span class="p">,</span> <span class="n">InspectionReport</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">Inspection</span><span class="o">.</span><span class="n">fk_inspectionReport</span><span class="p">)</span>
</span><span id="L-244"><a href="#L-244"><span class="linenos"> 244</span></a>        <span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">Inspection</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">docs_id</span><span class="p">)</span>
</span><span id="L-245"><a href="#L-245"><span class="linenos"> 245</span></a>        <span class="o">.</span><span class="n">first</span><span class="p">()</span>
</span><span id="L-246"><a href="#L-246"><span class="linenos"> 246</span></a>    <span class="p">)</span>
</span><span id="L-247"><a href="#L-247"><span class="linenos"> 247</span></a>
</span><span id="L-248"><a href="#L-248"><span class="linenos"> 248</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">inspection</span><span class="p">:</span>
</span><span id="L-249"><a href="#L-249"><span class="linenos"> 249</span></a>        <span class="k">raise</span> <span class="n">HTTPException</span><span class="p">(</span><span class="n">status_code</span><span class="o">=</span><span class="mi">404</span><span class="p">,</span> <span class="n">detail</span><span class="o">=</span><span class="s2">&quot;Inspection report not found&quot;</span><span class="p">)</span>
</span><span id="L-250"><a href="#L-250"><span class="linenos"> 250</span></a>
</span><span id="L-251"><a href="#L-251"><span class="linenos"> 251</span></a>    <span class="n">inspection_report</span> <span class="o">=</span> <span class="n">inspection</span><span class="o">.</span><span class="n">inspection_report</span>
</span><span id="L-252"><a href="#L-252"><span class="linenos"> 252</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">inspection_report</span><span class="p">:</span>
</span><span id="L-253"><a href="#L-253"><span class="linenos"> 253</span></a>        <span class="k">raise</span> <span class="n">HTTPException</span><span class="p">(</span><span class="n">status_code</span><span class="o">=</span><span class="mi">404</span><span class="p">,</span> <span class="n">detail</span><span class="o">=</span><span class="s2">&quot;Inspection report not found&quot;</span><span class="p">)</span>
</span><span id="L-254"><a href="#L-254"><span class="linenos"> 254</span></a>
</span><span id="L-255"><a href="#L-255"><span class="linenos"> 255</span></a>    <span class="n">update_fields</span> <span class="o">=</span> <span class="n">updated_data</span><span class="o">.</span><span class="n">dict</span><span class="p">(</span><span class="n">exclude_unset</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-256"><a href="#L-256"><span class="linenos"> 256</span></a>    <span class="k">for</span> <span class="n">field</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">update_fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="L-257"><a href="#L-257"><span class="linenos"> 257</span></a>        <span class="nb">setattr</span><span class="p">(</span><span class="n">inspection_report</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</span><span id="L-258"><a href="#L-258"><span class="linenos"> 258</span></a>
</span><span id="L-259"><a href="#L-259"><span class="linenos"> 259</span></a>    <span class="n">db</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="L-260"><a href="#L-260"><span class="linenos"> 260</span></a>
</span><span id="L-261"><a href="#L-261"><span class="linenos"> 261</span></a>    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;Inspection report updated successfully&quot;</span><span class="p">}</span>
</span><span id="L-262"><a href="#L-262"><span class="linenos"> 262</span></a>
</span><span id="L-263"><a href="#L-263"><span class="linenos"> 263</span></a>
</span><span id="L-264"><a href="#L-264"><span class="linenos"> 264</span></a><span class="nd">@app</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;/inspection-term/</span><span class="si">{term_id}</span><span class="s2">/&quot;</span><span class="p">)</span>
</span><span id="L-265"><a href="#L-265"><span class="linenos"> 265</span></a><span class="k">def</span><span class="w"> </span><span class="nf">get_inspection_term</span><span class="p">(</span><span class="n">term_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">db</span><span class="p">:</span> <span class="n">sessionmaker</span> <span class="o">=</span> <span class="n">Depends</span><span class="p">(</span><span class="n">get_db</span><span class="p">)):</span>
</span><span id="L-266"><a href="#L-266"><span class="linenos"> 266</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-267"><a href="#L-267"><span class="linenos"> 267</span></a><span class="sd">    Fetch details of an inspection term by its ID.</span>
</span><span id="L-268"><a href="#L-268"><span class="linenos"> 268</span></a>
</span><span id="L-269"><a href="#L-269"><span class="linenos"> 269</span></a><span class="sd">    This endpoint retrieves information about a specific inspection term, including details</span>
</span><span id="L-270"><a href="#L-270"><span class="linenos"> 270</span></a><span class="sd">    about the lesson, subject, and teacher.</span>
</span><span id="L-271"><a href="#L-271"><span class="linenos"> 271</span></a>
</span><span id="L-272"><a href="#L-272"><span class="linenos"> 272</span></a><span class="sd">    Args:</span>
</span><span id="L-273"><a href="#L-273"><span class="linenos"> 273</span></a><span class="sd">        term_id (int): The unique identifier of the inspection term.</span>
</span><span id="L-274"><a href="#L-274"><span class="linenos"> 274</span></a><span class="sd">        db (sessionmaker): The database session dependency injected by FastAPI.</span>
</span><span id="L-275"><a href="#L-275"><span class="linenos"> 275</span></a>
</span><span id="L-276"><a href="#L-276"><span class="linenos"> 276</span></a><span class="sd">    Raises:</span>
</span><span id="L-277"><a href="#L-277"><span class="linenos"> 277</span></a><span class="sd">        HTTPException: If the inspection term is not found.</span>
</span><span id="L-278"><a href="#L-278"><span class="linenos"> 278</span></a>
</span><span id="L-279"><a href="#L-279"><span class="linenos"> 279</span></a><span class="sd">    Returns:</span>
</span><span id="L-280"><a href="#L-280"><span class="linenos"> 280</span></a><span class="sd">        dict: A dictionary containing the inspection term details:</span>
</span><span id="L-281"><a href="#L-281"><span class="linenos"> 281</span></a><span class="sd">            - lesson_id (int): ID of the lesson.</span>
</span><span id="L-282"><a href="#L-282"><span class="linenos"> 282</span></a><span class="sd">            - subject_id (int): ID of the subject.</span>
</span><span id="L-283"><a href="#L-283"><span class="linenos"> 283</span></a><span class="sd">            - subject_code (str): Code of the subject.</span>
</span><span id="L-284"><a href="#L-284"><span class="linenos"> 284</span></a><span class="sd">            - subject_name (str): Name of the subject.</span>
</span><span id="L-285"><a href="#L-285"><span class="linenos"> 285</span></a><span class="sd">            - subject_type (str): Type/category of the subject.</span>
</span><span id="L-286"><a href="#L-286"><span class="linenos"> 286</span></a><span class="sd">            - teacher_id (int): ID of the teacher.</span>
</span><span id="L-287"><a href="#L-287"><span class="linenos"> 287</span></a><span class="sd">            - teacher_name (str): First name of the teacher.</span>
</span><span id="L-288"><a href="#L-288"><span class="linenos"> 288</span></a><span class="sd">            - teacher_surname (str): Surname of the teacher.</span>
</span><span id="L-289"><a href="#L-289"><span class="linenos"> 289</span></a><span class="sd">            - teacher_title (str): Title of the teacher (e.g., Dr., Mr.).</span>
</span><span id="L-290"><a href="#L-290"><span class="linenos"> 290</span></a><span class="sd">            - department (str): Department the teacher belongs to.</span>
</span><span id="L-291"><a href="#L-291"><span class="linenos"> 291</span></a><span class="sd">            - time (datetime): Date and time of the lesson.</span>
</span><span id="L-292"><a href="#L-292"><span class="linenos"> 292</span></a><span class="sd">            - room (str): Room where the lesson took place.</span>
</span><span id="L-293"><a href="#L-293"><span class="linenos"> 293</span></a><span class="sd">            - building (str): Building where the lesson took place.</span>
</span><span id="L-294"><a href="#L-294"><span class="linenos"> 294</span></a>
</span><span id="L-295"><a href="#L-295"><span class="linenos"> 295</span></a><span class="sd">    Example Response:</span>
</span><span id="L-296"><a href="#L-296"><span class="linenos"> 296</span></a><span class="sd">        {</span>
</span><span id="L-297"><a href="#L-297"><span class="linenos"> 297</span></a><span class="sd">            &quot;lesson_id&quot;: 1,</span>
</span><span id="L-298"><a href="#L-298"><span class="linenos"> 298</span></a><span class="sd">            &quot;subject_id&quot;: 101,</span>
</span><span id="L-299"><a href="#L-299"><span class="linenos"> 299</span></a><span class="sd">            &quot;subject_code&quot;: &quot;MATH101&quot;,</span>
</span><span id="L-300"><a href="#L-300"><span class="linenos"> 300</span></a><span class="sd">            &quot;subject_name&quot;: &quot;Calculus&quot;,</span>
</span><span id="L-301"><a href="#L-301"><span class="linenos"> 301</span></a><span class="sd">            &quot;subject_type&quot;: &quot;Core&quot;,</span>
</span><span id="L-302"><a href="#L-302"><span class="linenos"> 302</span></a><span class="sd">            &quot;teacher_id&quot;: 10,</span>
</span><span id="L-303"><a href="#L-303"><span class="linenos"> 303</span></a><span class="sd">            &quot;teacher_name&quot;: &quot;Jane&quot;,</span>
</span><span id="L-304"><a href="#L-304"><span class="linenos"> 304</span></a><span class="sd">            &quot;teacher_surname&quot;: &quot;Doe&quot;,</span>
</span><span id="L-305"><a href="#L-305"><span class="linenos"> 305</span></a><span class="sd">            &quot;teacher_title&quot;: &quot;Dr.&quot;,</span>
</span><span id="L-306"><a href="#L-306"><span class="linenos"> 306</span></a><span class="sd">            &quot;department&quot;: &quot;Mathematics&quot;,</span>
</span><span id="L-307"><a href="#L-307"><span class="linenos"> 307</span></a><span class="sd">            &quot;time&quot;: &quot;2025-01-01T10:00:00&quot;,</span>
</span><span id="L-308"><a href="#L-308"><span class="linenos"> 308</span></a><span class="sd">            &quot;room&quot;: &quot;101&quot;,</span>
</span><span id="L-309"><a href="#L-309"><span class="linenos"> 309</span></a><span class="sd">            &quot;building&quot;: &quot;Science Block&quot;</span>
</span><span id="L-310"><a href="#L-310"><span class="linenos"> 310</span></a><span class="sd">        }</span>
</span><span id="L-311"><a href="#L-311"><span class="linenos"> 311</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-312"><a href="#L-312"><span class="linenos"> 312</span></a>
</span><span id="L-313"><a href="#L-313"><span class="linenos"> 313</span></a>    <span class="n">data</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-314"><a href="#L-314"><span class="linenos"> 314</span></a>        <span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">Inspection</span><span class="p">)</span>
</span><span id="L-315"><a href="#L-315"><span class="linenos"> 315</span></a>        <span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">Lesson</span><span class="p">,</span> <span class="n">Lesson</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">Inspection</span><span class="o">.</span><span class="n">fk_lesson</span><span class="p">)</span>
</span><span id="L-316"><a href="#L-316"><span class="linenos"> 316</span></a>        <span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">Subject</span><span class="p">,</span> <span class="n">Subject</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">Lesson</span><span class="o">.</span><span class="n">fk_subject</span><span class="p">)</span>
</span><span id="L-317"><a href="#L-317"><span class="linenos"> 317</span></a>        <span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">Teacher</span><span class="p">,</span> <span class="n">Teacher</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">Lesson</span><span class="o">.</span><span class="n">fk_teacher</span><span class="p">)</span>
</span><span id="L-318"><a href="#L-318"><span class="linenos"> 318</span></a>        <span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">Lesson</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">term_id</span><span class="p">)</span>
</span><span id="L-319"><a href="#L-319"><span class="linenos"> 319</span></a>        <span class="o">.</span><span class="n">first</span><span class="p">()</span>
</span><span id="L-320"><a href="#L-320"><span class="linenos"> 320</span></a>    <span class="p">)</span>
</span><span id="L-321"><a href="#L-321"><span class="linenos"> 321</span></a>
</span><span id="L-322"><a href="#L-322"><span class="linenos"> 322</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">data</span><span class="p">:</span>
</span><span id="L-323"><a href="#L-323"><span class="linenos"> 323</span></a>        <span class="k">raise</span> <span class="n">HTTPException</span><span class="p">(</span><span class="n">status_code</span><span class="o">=</span><span class="mi">404</span><span class="p">,</span> <span class="n">detail</span><span class="o">=</span><span class="s2">&quot;Inspection term not found&quot;</span><span class="p">)</span>
</span><span id="L-324"><a href="#L-324"><span class="linenos"> 324</span></a>
</span><span id="L-325"><a href="#L-325"><span class="linenos"> 325</span></a>    <span class="k">return</span> <span class="p">{</span>
</span><span id="L-326"><a href="#L-326"><span class="linenos"> 326</span></a>        <span class="s2">&quot;lesson_id&quot;</span><span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">lesson</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
</span><span id="L-327"><a href="#L-327"><span class="linenos"> 327</span></a>        <span class="s2">&quot;subject_id&quot;</span><span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">lesson</span><span class="o">.</span><span class="n">subject</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
</span><span id="L-328"><a href="#L-328"><span class="linenos"> 328</span></a>        <span class="s2">&quot;subject_code&quot;</span><span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">lesson</span><span class="o">.</span><span class="n">subject</span><span class="o">.</span><span class="n">code</span><span class="p">,</span>
</span><span id="L-329"><a href="#L-329"><span class="linenos"> 329</span></a>        <span class="s2">&quot;subject_name&quot;</span><span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">lesson</span><span class="o">.</span><span class="n">subject</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="L-330"><a href="#L-330"><span class="linenos"> 330</span></a>        <span class="s2">&quot;subject_type&quot;</span><span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">lesson</span><span class="o">.</span><span class="n">subject</span><span class="o">.</span><span class="n">type</span><span class="p">,</span>
</span><span id="L-331"><a href="#L-331"><span class="linenos"> 331</span></a>        <span class="s2">&quot;teacher_id&quot;</span><span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">lesson</span><span class="o">.</span><span class="n">teacher</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
</span><span id="L-332"><a href="#L-332"><span class="linenos"> 332</span></a>        <span class="s2">&quot;teacher_name&quot;</span><span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">lesson</span><span class="o">.</span><span class="n">teacher</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="L-333"><a href="#L-333"><span class="linenos"> 333</span></a>        <span class="s2">&quot;teacher_surname&quot;</span><span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">lesson</span><span class="o">.</span><span class="n">teacher</span><span class="o">.</span><span class="n">surname</span><span class="p">,</span>
</span><span id="L-334"><a href="#L-334"><span class="linenos"> 334</span></a>        <span class="s2">&quot;teacher_title&quot;</span><span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">lesson</span><span class="o">.</span><span class="n">teacher</span><span class="o">.</span><span class="n">title</span><span class="p">,</span>
</span><span id="L-335"><a href="#L-335"><span class="linenos"> 335</span></a>        <span class="s2">&quot;department&quot;</span><span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">lesson</span><span class="o">.</span><span class="n">teacher</span><span class="o">.</span><span class="n">department</span><span class="p">,</span>
</span><span id="L-336"><a href="#L-336"><span class="linenos"> 336</span></a>        <span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">lesson</span><span class="o">.</span><span class="n">time</span><span class="p">,</span>
</span><span id="L-337"><a href="#L-337"><span class="linenos"> 337</span></a>        <span class="s2">&quot;room&quot;</span><span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">lesson</span><span class="o">.</span><span class="n">room</span><span class="p">,</span>
</span><span id="L-338"><a href="#L-338"><span class="linenos"> 338</span></a>        <span class="s2">&quot;building&quot;</span><span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">lesson</span><span class="o">.</span><span class="n">building</span><span class="p">,</span>
</span><span id="L-339"><a href="#L-339"><span class="linenos"> 339</span></a>    <span class="p">}</span>
</span><span id="L-340"><a href="#L-340"><span class="linenos"> 340</span></a>
</span><span id="L-341"><a href="#L-341"><span class="linenos"> 341</span></a>
</span><span id="L-342"><a href="#L-342"><span class="linenos"> 342</span></a><span class="nd">@app</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="s2">&quot;/inspection-term/edit/</span><span class="si">{term_id}</span><span class="s2">/&quot;</span><span class="p">)</span>
</span><span id="L-343"><a href="#L-343"><span class="linenos"> 343</span></a><span class="k">def</span><span class="w"> </span><span class="nf">edit_inspection_team</span><span class="p">(</span>
</span><span id="L-344"><a href="#L-344"><span class="linenos"> 344</span></a>    <span class="n">term_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">updated_data</span><span class="p">:</span> <span class="n">CreateInspection</span><span class="p">,</span> <span class="n">db</span><span class="p">:</span> <span class="n">sessionmaker</span> <span class="o">=</span> <span class="n">Depends</span><span class="p">(</span><span class="n">get_db</span><span class="p">)</span>
</span><span id="L-345"><a href="#L-345"><span class="linenos"> 345</span></a><span class="p">):</span>
</span><span id="L-346"><a href="#L-346"><span class="linenos"> 346</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-347"><a href="#L-347"><span class="linenos"> 347</span></a><span class="sd">    Edit an existing inspection term.</span>
</span><span id="L-348"><a href="#L-348"><span class="linenos"> 348</span></a>
</span><span id="L-349"><a href="#L-349"><span class="linenos"> 349</span></a><span class="sd">    This endpoint updates the details of an inspection term identified by its ID. Partial updates</span>
</span><span id="L-350"><a href="#L-350"><span class="linenos"> 350</span></a><span class="sd">    are supported, and only the fields provided in the request body will be updated.</span>
</span><span id="L-351"><a href="#L-351"><span class="linenos"> 351</span></a>
</span><span id="L-352"><a href="#L-352"><span class="linenos"> 352</span></a><span class="sd">    Args:</span>
</span><span id="L-353"><a href="#L-353"><span class="linenos"> 353</span></a><span class="sd">        term_id (int): The unique identifier of the inspection term.</span>
</span><span id="L-354"><a href="#L-354"><span class="linenos"> 354</span></a><span class="sd">        updated_data (CreateInspection): Data model containing the fields to update.</span>
</span><span id="L-355"><a href="#L-355"><span class="linenos"> 355</span></a><span class="sd">        db (sessionmaker): The database session dependency injected by FastAPI.</span>
</span><span id="L-356"><a href="#L-356"><span class="linenos"> 356</span></a>
</span><span id="L-357"><a href="#L-357"><span class="linenos"> 357</span></a><span class="sd">    Raises:</span>
</span><span id="L-358"><a href="#L-358"><span class="linenos"> 358</span></a><span class="sd">        HTTPException: If the inspection term with the given ID is not found.</span>
</span><span id="L-359"><a href="#L-359"><span class="linenos"> 359</span></a>
</span><span id="L-360"><a href="#L-360"><span class="linenos"> 360</span></a><span class="sd">    Returns:</span>
</span><span id="L-361"><a href="#L-361"><span class="linenos"> 361</span></a><span class="sd">        dict: A success message indicating the inspection term was updated.</span>
</span><span id="L-362"><a href="#L-362"><span class="linenos"> 362</span></a>
</span><span id="L-363"><a href="#L-363"><span class="linenos"> 363</span></a><span class="sd">    Example Request Body (JSON):</span>
</span><span id="L-364"><a href="#L-364"><span class="linenos"> 364</span></a><span class="sd">        {</span>
</span><span id="L-365"><a href="#L-365"><span class="linenos"> 365</span></a><span class="sd">            &quot;fk_lesson&quot;: 5,</span>
</span><span id="L-366"><a href="#L-366"><span class="linenos"> 366</span></a><span class="sd">            &quot;fk_inspectionReport&quot;: 3,</span>
</span><span id="L-367"><a href="#L-367"><span class="linenos"> 367</span></a><span class="sd">            &quot;fk_inspectionTeam&quot;: 2</span>
</span><span id="L-368"><a href="#L-368"><span class="linenos"> 368</span></a><span class="sd">        }</span>
</span><span id="L-369"><a href="#L-369"><span class="linenos"> 369</span></a>
</span><span id="L-370"><a href="#L-370"><span class="linenos"> 370</span></a><span class="sd">    Example Response:</span>
</span><span id="L-371"><a href="#L-371"><span class="linenos"> 371</span></a><span class="sd">        {</span>
</span><span id="L-372"><a href="#L-372"><span class="linenos"> 372</span></a><span class="sd">            &quot;message&quot;: &quot;Inspection term updated successfully&quot;</span>
</span><span id="L-373"><a href="#L-373"><span class="linenos"> 373</span></a><span class="sd">        }</span>
</span><span id="L-374"><a href="#L-374"><span class="linenos"> 374</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-375"><a href="#L-375"><span class="linenos"> 375</span></a>
</span><span id="L-376"><a href="#L-376"><span class="linenos"> 376</span></a>    <span class="n">inspection</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">Inspection</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">Inspection</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">term_id</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
</span><span id="L-377"><a href="#L-377"><span class="linenos"> 377</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">inspection</span><span class="p">:</span>
</span><span id="L-378"><a href="#L-378"><span class="linenos"> 378</span></a>        <span class="k">raise</span> <span class="n">HTTPException</span><span class="p">(</span><span class="n">status_code</span><span class="o">=</span><span class="mi">404</span><span class="p">,</span> <span class="n">detail</span><span class="o">=</span><span class="s2">&quot;Inspection term not found&quot;</span><span class="p">)</span>
</span><span id="L-379"><a href="#L-379"><span class="linenos"> 379</span></a>
</span><span id="L-380"><a href="#L-380"><span class="linenos"> 380</span></a>    <span class="n">update_fields</span> <span class="o">=</span> <span class="n">updated_data</span><span class="o">.</span><span class="n">dict</span><span class="p">(</span><span class="n">exclude_unset</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-381"><a href="#L-381"><span class="linenos"> 381</span></a>    <span class="k">for</span> <span class="n">field</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">update_fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="L-382"><a href="#L-382"><span class="linenos"> 382</span></a>        <span class="nb">setattr</span><span class="p">(</span><span class="n">inspection</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</span><span id="L-383"><a href="#L-383"><span class="linenos"> 383</span></a>
</span><span id="L-384"><a href="#L-384"><span class="linenos"> 384</span></a>    <span class="n">db</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="L-385"><a href="#L-385"><span class="linenos"> 385</span></a>
</span><span id="L-386"><a href="#L-386"><span class="linenos"> 386</span></a>    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;Inspection term updated successfully&quot;</span><span class="p">}</span>
</span><span id="L-387"><a href="#L-387"><span class="linenos"> 387</span></a>
</span><span id="L-388"><a href="#L-388"><span class="linenos"> 388</span></a>
</span><span id="L-389"><a href="#L-389"><span class="linenos"> 389</span></a><span class="nd">@app</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;/inspection-terms/&quot;</span><span class="p">,</span> <span class="n">response_model</span><span class="o">=</span><span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">])</span>
</span><span id="L-390"><a href="#L-390"><span class="linenos"> 390</span></a><span class="k">def</span><span class="w"> </span><span class="nf">get_inspection_terms</span><span class="p">(</span><span class="n">db</span><span class="p">:</span> <span class="n">sessionmaker</span> <span class="o">=</span> <span class="n">Depends</span><span class="p">(</span><span class="n">get_db</span><span class="p">)):</span>
</span><span id="L-391"><a href="#L-391"><span class="linenos"> 391</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-392"><a href="#L-392"><span class="linenos"> 392</span></a><span class="sd">    Fetch all inspection terms.</span>
</span><span id="L-393"><a href="#L-393"><span class="linenos"> 393</span></a>
</span><span id="L-394"><a href="#L-394"><span class="linenos"> 394</span></a><span class="sd">    This endpoint retrieves a list of inspection terms, including information about</span>
</span><span id="L-395"><a href="#L-395"><span class="linenos"> 395</span></a><span class="sd">    the inspection date, subject, teacher, and associated lesson and team details.</span>
</span><span id="L-396"><a href="#L-396"><span class="linenos"> 396</span></a>
</span><span id="L-397"><a href="#L-397"><span class="linenos"> 397</span></a><span class="sd">    Args:</span>
</span><span id="L-398"><a href="#L-398"><span class="linenos"> 398</span></a><span class="sd">        db (sessionmaker): The database session dependency injected by FastAPI.</span>
</span><span id="L-399"><a href="#L-399"><span class="linenos"> 399</span></a>
</span><span id="L-400"><a href="#L-400"><span class="linenos"> 400</span></a><span class="sd">    Returns:</span>
</span><span id="L-401"><a href="#L-401"><span class="linenos"> 401</span></a><span class="sd">        list[dict]: A list of dictionaries containing inspection term details:</span>
</span><span id="L-402"><a href="#L-402"><span class="linenos"> 402</span></a><span class="sd">            - id (int): ID of the inspection term.</span>
</span><span id="L-403"><a href="#L-403"><span class="linenos"> 403</span></a><span class="sd">            - date (datetime): Date of the inspection.</span>
</span><span id="L-404"><a href="#L-404"><span class="linenos"> 404</span></a><span class="sd">            - subject (str): Name of the subject.</span>
</span><span id="L-405"><a href="#L-405"><span class="linenos"> 405</span></a><span class="sd">            - teacher (str): Full name of the teacher (title, first name, surname).</span>
</span><span id="L-406"><a href="#L-406"><span class="linenos"> 406</span></a><span class="sd">            - teacher_id (int): ID of the teacher.</span>
</span><span id="L-407"><a href="#L-407"><span class="linenos"> 407</span></a><span class="sd">            - lesson_id (int): ID of the lesson associated with the inspection.</span>
</span><span id="L-408"><a href="#L-408"><span class="linenos"> 408</span></a><span class="sd">            - team_id (int): ID of the inspection team associated with the inspection.</span>
</span><span id="L-409"><a href="#L-409"><span class="linenos"> 409</span></a>
</span><span id="L-410"><a href="#L-410"><span class="linenos"> 410</span></a><span class="sd">    Example Response:</span>
</span><span id="L-411"><a href="#L-411"><span class="linenos"> 411</span></a><span class="sd">        [</span>
</span><span id="L-412"><a href="#L-412"><span class="linenos"> 412</span></a><span class="sd">            {</span>
</span><span id="L-413"><a href="#L-413"><span class="linenos"> 413</span></a><span class="sd">                &quot;id&quot;: 1,</span>
</span><span id="L-414"><a href="#L-414"><span class="linenos"> 414</span></a><span class="sd">                &quot;date&quot;: &quot;2025-01-01T10:00:00&quot;,</span>
</span><span id="L-415"><a href="#L-415"><span class="linenos"> 415</span></a><span class="sd">                &quot;subject&quot;: &quot;Physics&quot;,</span>
</span><span id="L-416"><a href="#L-416"><span class="linenos"> 416</span></a><span class="sd">                &quot;teacher&quot;: &quot;Dr. John Smith&quot;,</span>
</span><span id="L-417"><a href="#L-417"><span class="linenos"> 417</span></a><span class="sd">                &quot;teacher_id&quot;: 12,</span>
</span><span id="L-418"><a href="#L-418"><span class="linenos"> 418</span></a><span class="sd">                &quot;lesson_id&quot;: 101,</span>
</span><span id="L-419"><a href="#L-419"><span class="linenos"> 419</span></a><span class="sd">                &quot;team_id&quot;: 3</span>
</span><span id="L-420"><a href="#L-420"><span class="linenos"> 420</span></a><span class="sd">            },</span>
</span><span id="L-421"><a href="#L-421"><span class="linenos"> 421</span></a><span class="sd">            ...</span>
</span><span id="L-422"><a href="#L-422"><span class="linenos"> 422</span></a><span class="sd">        ]</span>
</span><span id="L-423"><a href="#L-423"><span class="linenos"> 423</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-424"><a href="#L-424"><span class="linenos"> 424</span></a>
</span><span id="L-425"><a href="#L-425"><span class="linenos"> 425</span></a>    <span class="n">inspection_terms</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-426"><a href="#L-426"><span class="linenos"> 426</span></a>        <span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span>
</span><span id="L-427"><a href="#L-427"><span class="linenos"> 427</span></a>            <span class="n">Inspection</span><span class="o">.</span><span class="n">id</span><span class="o">.</span><span class="n">label</span><span class="p">(</span><span class="s2">&quot;inspection_id&quot;</span><span class="p">),</span>
</span><span id="L-428"><a href="#L-428"><span class="linenos"> 428</span></a>            <span class="n">Inspection</span><span class="o">.</span><span class="n">fk_inspectionTeam</span><span class="o">.</span><span class="n">label</span><span class="p">(</span><span class="s2">&quot;team_id&quot;</span><span class="p">),</span>
</span><span id="L-429"><a href="#L-429"><span class="linenos"> 429</span></a>            <span class="n">Lesson</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">label</span><span class="p">(</span><span class="s2">&quot;inspection_date&quot;</span><span class="p">),</span>
</span><span id="L-430"><a href="#L-430"><span class="linenos"> 430</span></a>            <span class="n">Subject</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">label</span><span class="p">(</span><span class="s2">&quot;subject_name&quot;</span><span class="p">),</span>
</span><span id="L-431"><a href="#L-431"><span class="linenos"> 431</span></a>            <span class="n">Subject</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">label</span><span class="p">(</span><span class="s2">&quot;subject_type&quot;</span><span class="p">),</span>
</span><span id="L-432"><a href="#L-432"><span class="linenos"> 432</span></a>            <span class="n">Teacher</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">label</span><span class="p">(</span><span class="s2">&quot;teacher_name&quot;</span><span class="p">),</span>
</span><span id="L-433"><a href="#L-433"><span class="linenos"> 433</span></a>            <span class="n">Teacher</span><span class="o">.</span><span class="n">id</span><span class="o">.</span><span class="n">label</span><span class="p">(</span><span class="s2">&quot;teacher_id&quot;</span><span class="p">),</span>
</span><span id="L-434"><a href="#L-434"><span class="linenos"> 434</span></a>            <span class="n">Teacher</span><span class="o">.</span><span class="n">surname</span><span class="o">.</span><span class="n">label</span><span class="p">(</span><span class="s2">&quot;teacher_surname&quot;</span><span class="p">),</span>
</span><span id="L-435"><a href="#L-435"><span class="linenos"> 435</span></a>            <span class="n">Teacher</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">label</span><span class="p">(</span><span class="s2">&quot;teacher_title&quot;</span><span class="p">),</span>
</span><span id="L-436"><a href="#L-436"><span class="linenos"> 436</span></a>            <span class="n">Lesson</span><span class="o">.</span><span class="n">id</span><span class="o">.</span><span class="n">label</span><span class="p">(</span><span class="s2">&quot;lesson_id&quot;</span><span class="p">),</span>
</span><span id="L-437"><a href="#L-437"><span class="linenos"> 437</span></a>        <span class="p">)</span>
</span><span id="L-438"><a href="#L-438"><span class="linenos"> 438</span></a>        <span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">Lesson</span><span class="p">,</span> <span class="n">Inspection</span><span class="o">.</span><span class="n">fk_lesson</span> <span class="o">==</span> <span class="n">Lesson</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
</span><span id="L-439"><a href="#L-439"><span class="linenos"> 439</span></a>        <span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">Subject</span><span class="p">,</span> <span class="n">Lesson</span><span class="o">.</span><span class="n">fk_subject</span> <span class="o">==</span> <span class="n">Subject</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
</span><span id="L-440"><a href="#L-440"><span class="linenos"> 440</span></a>        <span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">Teacher</span><span class="p">,</span> <span class="n">Lesson</span><span class="o">.</span><span class="n">fk_teacher</span> <span class="o">==</span> <span class="n">Teacher</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
</span><span id="L-441"><a href="#L-441"><span class="linenos"> 441</span></a>        <span class="o">.</span><span class="n">all</span><span class="p">()</span>
</span><span id="L-442"><a href="#L-442"><span class="linenos"> 442</span></a>    <span class="p">)</span>
</span><span id="L-443"><a href="#L-443"><span class="linenos"> 443</span></a>    <span class="n">result</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-444"><a href="#L-444"><span class="linenos"> 444</span></a>        <span class="p">{</span>
</span><span id="L-445"><a href="#L-445"><span class="linenos"> 445</span></a>            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="n">term</span><span class="o">.</span><span class="n">inspection_id</span><span class="p">,</span>
</span><span id="L-446"><a href="#L-446"><span class="linenos"> 446</span></a>            <span class="s2">&quot;date&quot;</span><span class="p">:</span> <span class="n">term</span><span class="o">.</span><span class="n">inspection_date</span><span class="p">,</span>
</span><span id="L-447"><a href="#L-447"><span class="linenos"> 447</span></a>            <span class="s2">&quot;subject&quot;</span><span class="p">:</span> <span class="n">term</span><span class="o">.</span><span class="n">subject_name</span><span class="p">,</span>
</span><span id="L-448"><a href="#L-448"><span class="linenos"> 448</span></a>            <span class="s2">&quot;subject_type&quot;</span><span class="p">:</span> <span class="n">term</span><span class="o">.</span><span class="n">subject_type</span><span class="p">,</span>
</span><span id="L-449"><a href="#L-449"><span class="linenos"> 449</span></a>            <span class="s2">&quot;teacher&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">term</span><span class="o">.</span><span class="n">teacher_title</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">term</span><span class="o">.</span><span class="n">teacher_name</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">term</span><span class="o">.</span><span class="n">teacher_surname</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="L-450"><a href="#L-450"><span class="linenos"> 450</span></a>            <span class="s2">&quot;teacher_id&quot;</span><span class="p">:</span> <span class="n">term</span><span class="o">.</span><span class="n">teacher_id</span><span class="p">,</span>
</span><span id="L-451"><a href="#L-451"><span class="linenos"> 451</span></a>            <span class="s2">&quot;lesson_id&quot;</span><span class="p">:</span> <span class="n">term</span><span class="o">.</span><span class="n">lesson_id</span><span class="p">,</span>
</span><span id="L-452"><a href="#L-452"><span class="linenos"> 452</span></a>            <span class="s2">&quot;team_id&quot;</span><span class="p">:</span> <span class="n">term</span><span class="o">.</span><span class="n">team_id</span><span class="p">,</span>
</span><span id="L-453"><a href="#L-453"><span class="linenos"> 453</span></a>        <span class="p">}</span>
</span><span id="L-454"><a href="#L-454"><span class="linenos"> 454</span></a>        <span class="k">for</span> <span class="n">term</span> <span class="ow">in</span> <span class="n">inspection_terms</span>
</span><span id="L-455"><a href="#L-455"><span class="linenos"> 455</span></a>    <span class="p">]</span>
</span><span id="L-456"><a href="#L-456"><span class="linenos"> 456</span></a>    <span class="k">return</span> <span class="n">result</span>
</span><span id="L-457"><a href="#L-457"><span class="linenos"> 457</span></a>
</span><span id="L-458"><a href="#L-458"><span class="linenos"> 458</span></a>
</span><span id="L-459"><a href="#L-459"><span class="linenos"> 459</span></a><span class="nd">@app</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="s2">&quot;/inspection-terms/&quot;</span><span class="p">)</span>
</span><span id="L-460"><a href="#L-460"><span class="linenos"> 460</span></a><span class="k">def</span><span class="w"> </span><span class="nf">get_inspection_terms</span><span class="p">(</span><span class="n">term</span><span class="p">:</span> <span class="n">CreateInspection</span><span class="p">,</span> <span class="n">db</span><span class="p">:</span> <span class="n">sessionmaker</span> <span class="o">=</span> <span class="n">Depends</span><span class="p">(</span><span class="n">get_db</span><span class="p">)):</span>
</span><span id="L-461"><a href="#L-461"><span class="linenos"> 461</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-462"><a href="#L-462"><span class="linenos"> 462</span></a><span class="sd">    Create a new inspection term.</span>
</span><span id="L-463"><a href="#L-463"><span class="linenos"> 463</span></a>
</span><span id="L-464"><a href="#L-464"><span class="linenos"> 464</span></a><span class="sd">    This endpoint adds a new inspection term to the database, associating it with an inspection schedule,</span>
</span><span id="L-465"><a href="#L-465"><span class="linenos"> 465</span></a><span class="sd">    team, and lesson.</span>
</span><span id="L-466"><a href="#L-466"><span class="linenos"> 466</span></a>
</span><span id="L-467"><a href="#L-467"><span class="linenos"> 467</span></a><span class="sd">    Args:</span>
</span><span id="L-468"><a href="#L-468"><span class="linenos"> 468</span></a><span class="sd">        term (CreateInspection): The data model containing inspection term details.</span>
</span><span id="L-469"><a href="#L-469"><span class="linenos"> 469</span></a><span class="sd">            - team_id (int): ID of the inspection team.</span>
</span><span id="L-470"><a href="#L-470"><span class="linenos"> 470</span></a><span class="sd">            - lesson_id (int): ID of the lesson.</span>
</span><span id="L-471"><a href="#L-471"><span class="linenos"> 471</span></a><span class="sd">        db (sessionmaker): The database session dependency injected by FastAPI.</span>
</span><span id="L-472"><a href="#L-472"><span class="linenos"> 472</span></a>
</span><span id="L-473"><a href="#L-473"><span class="linenos"> 473</span></a><span class="sd">    Raises:</span>
</span><span id="L-474"><a href="#L-474"><span class="linenos"> 474</span></a><span class="sd">        HTTPException: If no inspection schedule is found or if an error occurs during creation.</span>
</span><span id="L-475"><a href="#L-475"><span class="linenos"> 475</span></a>
</span><span id="L-476"><a href="#L-476"><span class="linenos"> 476</span></a><span class="sd">    Returns:</span>
</span><span id="L-477"><a href="#L-477"><span class="linenos"> 477</span></a><span class="sd">        dict: A success message indicating the inspection term was created successfully.</span>
</span><span id="L-478"><a href="#L-478"><span class="linenos"> 478</span></a>
</span><span id="L-479"><a href="#L-479"><span class="linenos"> 479</span></a><span class="sd">    Example Request Body (JSON):</span>
</span><span id="L-480"><a href="#L-480"><span class="linenos"> 480</span></a><span class="sd">        {</span>
</span><span id="L-481"><a href="#L-481"><span class="linenos"> 481</span></a><span class="sd">            &quot;team_id&quot;: 2,</span>
</span><span id="L-482"><a href="#L-482"><span class="linenos"> 482</span></a><span class="sd">            &quot;lesson_id&quot;: 5</span>
</span><span id="L-483"><a href="#L-483"><span class="linenos"> 483</span></a><span class="sd">        }</span>
</span><span id="L-484"><a href="#L-484"><span class="linenos"> 484</span></a>
</span><span id="L-485"><a href="#L-485"><span class="linenos"> 485</span></a><span class="sd">    Example Response:</span>
</span><span id="L-486"><a href="#L-486"><span class="linenos"> 486</span></a><span class="sd">        {</span>
</span><span id="L-487"><a href="#L-487"><span class="linenos"> 487</span></a><span class="sd">            &quot;message&quot;: &quot;Inspection report updated successfully&quot;</span>
</span><span id="L-488"><a href="#L-488"><span class="linenos"> 488</span></a><span class="sd">        }</span>
</span><span id="L-489"><a href="#L-489"><span class="linenos"> 489</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-490"><a href="#L-490"><span class="linenos"> 490</span></a>    <span class="n">schedule</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">InspectionSchedule</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span><span class="o">.</span><span class="n">id</span>
</span><span id="L-491"><a href="#L-491"><span class="linenos"> 491</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">schedule</span><span class="p">:</span>
</span><span id="L-492"><a href="#L-492"><span class="linenos"> 492</span></a>        <span class="k">raise</span> <span class="n">HTTPException</span><span class="p">(</span><span class="n">status_code</span><span class="o">=</span><span class="mi">404</span><span class="p">,</span> <span class="n">detail</span><span class="o">=</span><span class="s2">&quot;No inspection schedule found.&quot;</span><span class="p">)</span>
</span><span id="L-493"><a href="#L-493"><span class="linenos"> 493</span></a>
</span><span id="L-494"><a href="#L-494"><span class="linenos"> 494</span></a>    <span class="n">all_inspection</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-495"><a href="#L-495"><span class="linenos"> 495</span></a>        <span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">Inspection</span><span class="p">)</span>
</span><span id="L-496"><a href="#L-496"><span class="linenos"> 496</span></a>        <span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">Inspection</span><span class="o">.</span><span class="n">fk_inspectionSchedule</span> <span class="o">==</span> <span class="n">schedule</span><span class="p">)</span>
</span><span id="L-497"><a href="#L-497"><span class="linenos"> 497</span></a>        <span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">Lesson</span><span class="p">,</span> <span class="n">Inspection</span><span class="o">.</span><span class="n">fk_lesson</span> <span class="o">==</span> <span class="n">Lesson</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
</span><span id="L-498"><a href="#L-498"><span class="linenos"> 498</span></a>        <span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">Lesson</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">term</span><span class="o">.</span><span class="n">fk_lesson</span><span class="p">)</span>
</span><span id="L-499"><a href="#L-499"><span class="linenos"> 499</span></a>        <span class="o">.</span><span class="n">first</span><span class="p">()</span>
</span><span id="L-500"><a href="#L-500"><span class="linenos"> 500</span></a>    <span class="p">)</span>
</span><span id="L-501"><a href="#L-501"><span class="linenos"> 501</span></a>
</span><span id="L-502"><a href="#L-502"><span class="linenos"> 502</span></a>    <span class="k">if</span> <span class="n">all_inspection</span><span class="p">:</span>
</span><span id="L-503"><a href="#L-503"><span class="linenos"> 503</span></a>        <span class="k">raise</span> <span class="n">HTTPException</span><span class="p">(</span>
</span><span id="L-504"><a href="#L-504"><span class="linenos"> 504</span></a>            <span class="n">status_code</span><span class="o">=</span><span class="mi">409</span><span class="p">,</span> <span class="n">detail</span><span class="o">=</span><span class="s2">&quot;Lesson already has an inspection scheduled.&quot;</span>
</span><span id="L-505"><a href="#L-505"><span class="linenos"> 505</span></a>        <span class="p">)</span>
</span><span id="L-506"><a href="#L-506"><span class="linenos"> 506</span></a>
</span><span id="L-507"><a href="#L-507"><span class="linenos"> 507</span></a>    <span class="n">inspection</span> <span class="o">=</span> <span class="n">Inspection</span><span class="p">(</span>
</span><span id="L-508"><a href="#L-508"><span class="linenos"> 508</span></a>        <span class="n">fk_inspectionSchedule</span><span class="o">=</span><span class="n">schedule</span><span class="p">,</span>
</span><span id="L-509"><a href="#L-509"><span class="linenos"> 509</span></a>        <span class="n">fk_inspectionTeam</span><span class="o">=</span><span class="n">term</span><span class="o">.</span><span class="n">fk_inspectionTeam</span><span class="p">,</span>
</span><span id="L-510"><a href="#L-510"><span class="linenos"> 510</span></a>        <span class="n">fk_lesson</span><span class="o">=</span><span class="n">term</span><span class="o">.</span><span class="n">fk_lesson</span><span class="p">,</span>
</span><span id="L-511"><a href="#L-511"><span class="linenos"> 511</span></a>    <span class="p">)</span>
</span><span id="L-512"><a href="#L-512"><span class="linenos"> 512</span></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="L-513"><a href="#L-513"><span class="linenos"> 513</span></a>        <span class="n">db</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">inspection</span><span class="p">)</span>
</span><span id="L-514"><a href="#L-514"><span class="linenos"> 514</span></a>        <span class="n">db</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="L-515"><a href="#L-515"><span class="linenos"> 515</span></a>        <span class="n">db</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">inspection</span><span class="p">)</span>
</span><span id="L-516"><a href="#L-516"><span class="linenos"> 516</span></a>        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;Inspection report updated successfully&quot;</span><span class="p">}</span>
</span><span id="L-517"><a href="#L-517"><span class="linenos"> 517</span></a>
</span><span id="L-518"><a href="#L-518"><span class="linenos"> 518</span></a>    <span class="k">except</span> <span class="n">IntegrityError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="L-519"><a href="#L-519"><span class="linenos"> 519</span></a>        <span class="n">db</span><span class="o">.</span><span class="n">rollback</span><span class="p">()</span>
</span><span id="L-520"><a href="#L-520"><span class="linenos"> 520</span></a>        <span class="k">raise</span> <span class="n">HTTPException</span><span class="p">(</span>
</span><span id="L-521"><a href="#L-521"><span class="linenos"> 521</span></a>            <span class="n">status_code</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>
</span><span id="L-522"><a href="#L-522"><span class="linenos"> 522</span></a>            <span class="n">detail</span><span class="o">=</span><span class="s2">&quot;An error occurred while creating the inspection term.&quot;</span><span class="p">,</span>
</span><span id="L-523"><a href="#L-523"><span class="linenos"> 523</span></a>        <span class="p">)</span>
</span><span id="L-524"><a href="#L-524"><span class="linenos"> 524</span></a>
</span><span id="L-525"><a href="#L-525"><span class="linenos"> 525</span></a>
</span><span id="L-526"><a href="#L-526"><span class="linenos"> 526</span></a><span class="nd">@app</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="s2">&quot;/inspection-terms/</span><span class="si">{term_id}</span><span class="s2">/remove-term/&quot;</span><span class="p">)</span>
</span><span id="L-527"><a href="#L-527"><span class="linenos"> 527</span></a><span class="k">def</span><span class="w"> </span><span class="nf">remove_teacher_from_team</span><span class="p">(</span><span class="n">term_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">db</span><span class="p">:</span> <span class="n">sessionmaker</span> <span class="o">=</span> <span class="n">Depends</span><span class="p">(</span><span class="n">get_db</span><span class="p">)):</span>
</span><span id="L-528"><a href="#L-528"><span class="linenos"> 528</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-529"><a href="#L-529"><span class="linenos"> 529</span></a><span class="sd">    Remove an inspection term by its ID.</span>
</span><span id="L-530"><a href="#L-530"><span class="linenos"> 530</span></a>
</span><span id="L-531"><a href="#L-531"><span class="linenos"> 531</span></a><span class="sd">    This endpoint deletes a specific inspection term from the database.</span>
</span><span id="L-532"><a href="#L-532"><span class="linenos"> 532</span></a>
</span><span id="L-533"><a href="#L-533"><span class="linenos"> 533</span></a><span class="sd">    Args:</span>
</span><span id="L-534"><a href="#L-534"><span class="linenos"> 534</span></a><span class="sd">        term_id (int): The unique identifier of the inspection term to be deleted.</span>
</span><span id="L-535"><a href="#L-535"><span class="linenos"> 535</span></a><span class="sd">        db (sessionmaker): The database session dependency injected by FastAPI.</span>
</span><span id="L-536"><a href="#L-536"><span class="linenos"> 536</span></a>
</span><span id="L-537"><a href="#L-537"><span class="linenos"> 537</span></a><span class="sd">    Raises:</span>
</span><span id="L-538"><a href="#L-538"><span class="linenos"> 538</span></a><span class="sd">        HTTPException: If the inspection term with the given ID is not found.</span>
</span><span id="L-539"><a href="#L-539"><span class="linenos"> 539</span></a>
</span><span id="L-540"><a href="#L-540"><span class="linenos"> 540</span></a><span class="sd">    Returns:</span>
</span><span id="L-541"><a href="#L-541"><span class="linenos"> 541</span></a><span class="sd">        dict: A success message indicating the term was deleted successfully.</span>
</span><span id="L-542"><a href="#L-542"><span class="linenos"> 542</span></a>
</span><span id="L-543"><a href="#L-543"><span class="linenos"> 543</span></a><span class="sd">    Example Response:</span>
</span><span id="L-544"><a href="#L-544"><span class="linenos"> 544</span></a><span class="sd">        {</span>
</span><span id="L-545"><a href="#L-545"><span class="linenos"> 545</span></a><span class="sd">            &quot;message&quot;: &quot;Term has been deleted successfully&quot;</span>
</span><span id="L-546"><a href="#L-546"><span class="linenos"> 546</span></a><span class="sd">        }</span>
</span><span id="L-547"><a href="#L-547"><span class="linenos"> 547</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-548"><a href="#L-548"><span class="linenos"> 548</span></a>
</span><span id="L-549"><a href="#L-549"><span class="linenos"> 549</span></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="L-550"><a href="#L-550"><span class="linenos"> 550</span></a>        <span class="n">term</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">Inspection</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">Inspection</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">term_id</span><span class="p">)</span><span class="o">.</span><span class="n">one_or_none</span><span class="p">()</span>
</span><span id="L-551"><a href="#L-551"><span class="linenos"> 551</span></a>    <span class="k">except</span> <span class="n">NoResultFound</span><span class="p">:</span>
</span><span id="L-552"><a href="#L-552"><span class="linenos"> 552</span></a>        <span class="k">raise</span> <span class="n">HTTPException</span><span class="p">(</span><span class="n">status_code</span><span class="o">=</span><span class="mi">404</span><span class="p">,</span> <span class="n">detail</span><span class="o">=</span><span class="s2">&quot;Inspection term not found&quot;</span><span class="p">)</span>
</span><span id="L-553"><a href="#L-553"><span class="linenos"> 553</span></a>    <span class="n">db</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">term</span><span class="p">)</span>
</span><span id="L-554"><a href="#L-554"><span class="linenos"> 554</span></a>    <span class="n">db</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="L-555"><a href="#L-555"><span class="linenos"> 555</span></a>    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;Term has been deleted successfully&quot;</span><span class="p">}</span>
</span><span id="L-556"><a href="#L-556"><span class="linenos"> 556</span></a>
</span><span id="L-557"><a href="#L-557"><span class="linenos"> 557</span></a>
</span><span id="L-558"><a href="#L-558"><span class="linenos"> 558</span></a><span class="nd">@app</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;/lesson_with_dates/</span><span class="si">{teacher_id}</span><span class="s2">/</span><span class="si">{subject_id}</span><span class="s2">/&quot;</span><span class="p">)</span>
</span><span id="L-559"><a href="#L-559"><span class="linenos"> 559</span></a><span class="k">def</span><span class="w"> </span><span class="nf">get_lesson_with_dates</span><span class="p">(</span>
</span><span id="L-560"><a href="#L-560"><span class="linenos"> 560</span></a>    <span class="n">teacher_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">subject_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">db</span><span class="p">:</span> <span class="n">sessionmaker</span> <span class="o">=</span> <span class="n">Depends</span><span class="p">(</span><span class="n">get_db</span><span class="p">)</span>
</span><span id="L-561"><a href="#L-561"><span class="linenos"> 561</span></a><span class="p">):</span>
</span><span id="L-562"><a href="#L-562"><span class="linenos"> 562</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-563"><a href="#L-563"><span class="linenos"> 563</span></a><span class="sd">    Fetch lessons for a specific teacher and subject.</span>
</span><span id="L-564"><a href="#L-564"><span class="linenos"> 564</span></a>
</span><span id="L-565"><a href="#L-565"><span class="linenos"> 565</span></a><span class="sd">    This endpoint retrieves all lessons for a given teacher and subject, including the relevant details.</span>
</span><span id="L-566"><a href="#L-566"><span class="linenos"> 566</span></a>
</span><span id="L-567"><a href="#L-567"><span class="linenos"> 567</span></a><span class="sd">    Args:</span>
</span><span id="L-568"><a href="#L-568"><span class="linenos"> 568</span></a><span class="sd">        teacher_id (int): The unique identifier of the teacher.</span>
</span><span id="L-569"><a href="#L-569"><span class="linenos"> 569</span></a><span class="sd">        subject_id (int): The unique identifier of the subject.</span>
</span><span id="L-570"><a href="#L-570"><span class="linenos"> 570</span></a><span class="sd">        db (sessionmaker): The database session dependency injected by FastAPI.</span>
</span><span id="L-571"><a href="#L-571"><span class="linenos"> 571</span></a>
</span><span id="L-572"><a href="#L-572"><span class="linenos"> 572</span></a><span class="sd">    Returns:</span>
</span><span id="L-573"><a href="#L-573"><span class="linenos"> 573</span></a><span class="sd">        list[dict]: A list of lesson details, or an empty list if no lessons are found.</span>
</span><span id="L-574"><a href="#L-574"><span class="linenos"> 574</span></a>
</span><span id="L-575"><a href="#L-575"><span class="linenos"> 575</span></a><span class="sd">    Example Response:</span>
</span><span id="L-576"><a href="#L-576"><span class="linenos"> 576</span></a><span class="sd">        [</span>
</span><span id="L-577"><a href="#L-577"><span class="linenos"> 577</span></a><span class="sd">            {</span>
</span><span id="L-578"><a href="#L-578"><span class="linenos"> 578</span></a><span class="sd">                &quot;id&quot;: 1,</span>
</span><span id="L-579"><a href="#L-579"><span class="linenos"> 579</span></a><span class="sd">                &quot;teacher_id&quot;: 10,</span>
</span><span id="L-580"><a href="#L-580"><span class="linenos"> 580</span></a><span class="sd">                &quot;subject_id&quot;: 101,</span>
</span><span id="L-581"><a href="#L-581"><span class="linenos"> 581</span></a><span class="sd">                &quot;time&quot;: &quot;2025-01-01T10:00:00&quot;,</span>
</span><span id="L-582"><a href="#L-582"><span class="linenos"> 582</span></a><span class="sd">                &quot;room&quot;: &quot;101&quot;,</span>
</span><span id="L-583"><a href="#L-583"><span class="linenos"> 583</span></a><span class="sd">                &quot;building&quot;: &quot;Science Block&quot;</span>
</span><span id="L-584"><a href="#L-584"><span class="linenos"> 584</span></a><span class="sd">            },</span>
</span><span id="L-585"><a href="#L-585"><span class="linenos"> 585</span></a><span class="sd">            ...</span>
</span><span id="L-586"><a href="#L-586"><span class="linenos"> 586</span></a><span class="sd">        ]</span>
</span><span id="L-587"><a href="#L-587"><span class="linenos"> 587</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-588"><a href="#L-588"><span class="linenos"> 588</span></a>
</span><span id="L-589"><a href="#L-589"><span class="linenos"> 589</span></a>    <span class="n">lessons</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-590"><a href="#L-590"><span class="linenos"> 590</span></a>        <span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">Lesson</span><span class="p">)</span>
</span><span id="L-591"><a href="#L-591"><span class="linenos"> 591</span></a>        <span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">Teacher</span><span class="p">,</span> <span class="n">Lesson</span><span class="o">.</span><span class="n">fk_teacher</span> <span class="o">==</span> <span class="n">Teacher</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
</span><span id="L-592"><a href="#L-592"><span class="linenos"> 592</span></a>        <span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">Subject</span><span class="p">,</span> <span class="n">Lesson</span><span class="o">.</span><span class="n">fk_subject</span> <span class="o">==</span> <span class="n">Subject</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
</span><span id="L-593"><a href="#L-593"><span class="linenos"> 593</span></a>        <span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">Teacher</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">teacher_id</span><span class="p">,</span> <span class="n">Subject</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">subject_id</span><span class="p">)</span>
</span><span id="L-594"><a href="#L-594"><span class="linenos"> 594</span></a>        <span class="c1"># .filter(Lesson.time &gt;= datetime.now()) TODO!!</span>
</span><span id="L-595"><a href="#L-595"><span class="linenos"> 595</span></a>        <span class="o">.</span><span class="n">all</span><span class="p">()</span>
</span><span id="L-596"><a href="#L-596"><span class="linenos"> 596</span></a>    <span class="p">)</span>
</span><span id="L-597"><a href="#L-597"><span class="linenos"> 597</span></a>
</span><span id="L-598"><a href="#L-598"><span class="linenos"> 598</span></a>    <span class="k">return</span> <span class="n">lessons</span> <span class="k">if</span> <span class="n">lessons</span> <span class="k">else</span> <span class="p">[]</span>
</span><span id="L-599"><a href="#L-599"><span class="linenos"> 599</span></a>
</span><span id="L-600"><a href="#L-600"><span class="linenos"> 600</span></a>
</span><span id="L-601"><a href="#L-601"><span class="linenos"> 601</span></a><span class="nd">@app</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;/inspection-teams/&quot;</span><span class="p">)</span>
</span><span id="L-602"><a href="#L-602"><span class="linenos"> 602</span></a><span class="k">def</span><span class="w"> </span><span class="nf">get_inspection_teams</span><span class="p">(</span><span class="n">db</span><span class="p">:</span> <span class="n">sessionmaker</span> <span class="o">=</span> <span class="n">Depends</span><span class="p">(</span><span class="n">get_db</span><span class="p">)):</span>
</span><span id="L-603"><a href="#L-603"><span class="linenos"> 603</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-604"><a href="#L-604"><span class="linenos"> 604</span></a><span class="sd">    Fetch all inspection teams.</span>
</span><span id="L-605"><a href="#L-605"><span class="linenos"> 605</span></a>
</span><span id="L-606"><a href="#L-606"><span class="linenos"> 606</span></a><span class="sd">    This endpoint retrieves a list of all inspection teams, including their ID and name.</span>
</span><span id="L-607"><a href="#L-607"><span class="linenos"> 607</span></a>
</span><span id="L-608"><a href="#L-608"><span class="linenos"> 608</span></a><span class="sd">    Args:</span>
</span><span id="L-609"><a href="#L-609"><span class="linenos"> 609</span></a><span class="sd">        db (sessionmaker): The database session dependency injected by FastAPI.</span>
</span><span id="L-610"><a href="#L-610"><span class="linenos"> 610</span></a>
</span><span id="L-611"><a href="#L-611"><span class="linenos"> 611</span></a><span class="sd">    Returns:</span>
</span><span id="L-612"><a href="#L-612"><span class="linenos"> 612</span></a><span class="sd">        list[dict]: A list of dictionaries containing the inspection team details:</span>
</span><span id="L-613"><a href="#L-613"><span class="linenos"> 613</span></a><span class="sd">            - id (int): ID of the inspection team.</span>
</span><span id="L-614"><a href="#L-614"><span class="linenos"> 614</span></a><span class="sd">            - name (str): Name of the inspection team.</span>
</span><span id="L-615"><a href="#L-615"><span class="linenos"> 615</span></a>
</span><span id="L-616"><a href="#L-616"><span class="linenos"> 616</span></a><span class="sd">    Example Response:</span>
</span><span id="L-617"><a href="#L-617"><span class="linenos"> 617</span></a><span class="sd">        [</span>
</span><span id="L-618"><a href="#L-618"><span class="linenos"> 618</span></a><span class="sd">            {</span>
</span><span id="L-619"><a href="#L-619"><span class="linenos"> 619</span></a><span class="sd">                &quot;id&quot;: 1,</span>
</span><span id="L-620"><a href="#L-620"><span class="linenos"> 620</span></a><span class="sd">                &quot;name&quot;: &quot;Team A&quot;</span>
</span><span id="L-621"><a href="#L-621"><span class="linenos"> 621</span></a><span class="sd">            },</span>
</span><span id="L-622"><a href="#L-622"><span class="linenos"> 622</span></a><span class="sd">            {</span>
</span><span id="L-623"><a href="#L-623"><span class="linenos"> 623</span></a><span class="sd">                &quot;id&quot;: 2,</span>
</span><span id="L-624"><a href="#L-624"><span class="linenos"> 624</span></a><span class="sd">                &quot;name&quot;: &quot;Team B&quot;</span>
</span><span id="L-625"><a href="#L-625"><span class="linenos"> 625</span></a><span class="sd">            }</span>
</span><span id="L-626"><a href="#L-626"><span class="linenos"> 626</span></a><span class="sd">        ]</span>
</span><span id="L-627"><a href="#L-627"><span class="linenos"> 627</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-628"><a href="#L-628"><span class="linenos"> 628</span></a>
</span><span id="L-629"><a href="#L-629"><span class="linenos"> 629</span></a>    <span class="n">teams</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">InspectionTeam</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
</span><span id="L-630"><a href="#L-630"><span class="linenos"> 630</span></a>    <span class="k">return</span> <span class="p">[{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="n">team</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">team</span><span class="o">.</span><span class="n">name</span><span class="p">}</span> <span class="k">for</span> <span class="n">team</span> <span class="ow">in</span> <span class="n">teams</span><span class="p">]</span>
</span><span id="L-631"><a href="#L-631"><span class="linenos"> 631</span></a>
</span><span id="L-632"><a href="#L-632"><span class="linenos"> 632</span></a>
</span><span id="L-633"><a href="#L-633"><span class="linenos"> 633</span></a><span class="nd">@app</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="s2">&quot;/inspection-teams/&quot;</span><span class="p">,</span> <span class="n">response_model</span><span class="o">=</span><span class="n">InspectionTeamBase</span><span class="p">)</span>
</span><span id="L-634"><a href="#L-634"><span class="linenos"> 634</span></a><span class="k">def</span><span class="w"> </span><span class="nf">create_inspection_team</span><span class="p">(</span>
</span><span id="L-635"><a href="#L-635"><span class="linenos"> 635</span></a>    <span class="n">team</span><span class="p">:</span> <span class="n">CreateInspectionTeam</span><span class="p">,</span> <span class="n">db</span><span class="p">:</span> <span class="n">sessionmaker</span> <span class="o">=</span> <span class="n">Depends</span><span class="p">(</span><span class="n">get_db</span><span class="p">)</span>
</span><span id="L-636"><a href="#L-636"><span class="linenos"> 636</span></a><span class="p">):</span>
</span><span id="L-637"><a href="#L-637"><span class="linenos"> 637</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-638"><a href="#L-638"><span class="linenos"> 638</span></a><span class="sd">    Create a new inspection team.</span>
</span><span id="L-639"><a href="#L-639"><span class="linenos"> 639</span></a>
</span><span id="L-640"><a href="#L-640"><span class="linenos"> 640</span></a><span class="sd">    This endpoint allows for the creation of a new inspection team by providing its name.</span>
</span><span id="L-641"><a href="#L-641"><span class="linenos"> 641</span></a><span class="sd">    If the team name already exists, an error is raised.</span>
</span><span id="L-642"><a href="#L-642"><span class="linenos"> 642</span></a>
</span><span id="L-643"><a href="#L-643"><span class="linenos"> 643</span></a><span class="sd">    Args:</span>
</span><span id="L-644"><a href="#L-644"><span class="linenos"> 644</span></a><span class="sd">        team (CreateInspectionTeam): The data model containing the name of the inspection team.</span>
</span><span id="L-645"><a href="#L-645"><span class="linenos"> 645</span></a><span class="sd">        db (sessionmaker): The database session dependency injected by FastAPI.</span>
</span><span id="L-646"><a href="#L-646"><span class="linenos"> 646</span></a>
</span><span id="L-647"><a href="#L-647"><span class="linenos"> 647</span></a><span class="sd">    Raises:</span>
</span><span id="L-648"><a href="#L-648"><span class="linenos"> 648</span></a><span class="sd">        HTTPException: If the team name already exists or an error occurs during team creation.</span>
</span><span id="L-649"><a href="#L-649"><span class="linenos"> 649</span></a>
</span><span id="L-650"><a href="#L-650"><span class="linenos"> 650</span></a><span class="sd">    Returns:</span>
</span><span id="L-651"><a href="#L-651"><span class="linenos"> 651</span></a><span class="sd">        InspectionTeamBase: The newly created inspection team details.</span>
</span><span id="L-652"><a href="#L-652"><span class="linenos"> 652</span></a>
</span><span id="L-653"><a href="#L-653"><span class="linenos"> 653</span></a><span class="sd">    Example Request Body (JSON):</span>
</span><span id="L-654"><a href="#L-654"><span class="linenos"> 654</span></a><span class="sd">        {</span>
</span><span id="L-655"><a href="#L-655"><span class="linenos"> 655</span></a><span class="sd">            &quot;name&quot;: &quot;Team C&quot;</span>
</span><span id="L-656"><a href="#L-656"><span class="linenos"> 656</span></a><span class="sd">        }</span>
</span><span id="L-657"><a href="#L-657"><span class="linenos"> 657</span></a>
</span><span id="L-658"><a href="#L-658"><span class="linenos"> 658</span></a><span class="sd">    Example Response:</span>
</span><span id="L-659"><a href="#L-659"><span class="linenos"> 659</span></a><span class="sd">        {</span>
</span><span id="L-660"><a href="#L-660"><span class="linenos"> 660</span></a><span class="sd">            &quot;id&quot;: 3,</span>
</span><span id="L-661"><a href="#L-661"><span class="linenos"> 661</span></a><span class="sd">            &quot;name&quot;: &quot;Team C&quot;</span>
</span><span id="L-662"><a href="#L-662"><span class="linenos"> 662</span></a><span class="sd">        }</span>
</span><span id="L-663"><a href="#L-663"><span class="linenos"> 663</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-664"><a href="#L-664"><span class="linenos"> 664</span></a>
</span><span id="L-665"><a href="#L-665"><span class="linenos"> 665</span></a>    <span class="n">new_team</span> <span class="o">=</span> <span class="n">InspectionTeam</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">team</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="L-666"><a href="#L-666"><span class="linenos"> 666</span></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="L-667"><a href="#L-667"><span class="linenos"> 667</span></a>        <span class="n">db</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">new_team</span><span class="p">)</span>
</span><span id="L-668"><a href="#L-668"><span class="linenos"> 668</span></a>        <span class="n">db</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="L-669"><a href="#L-669"><span class="linenos"> 669</span></a>        <span class="n">db</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">new_team</span><span class="p">)</span>
</span><span id="L-670"><a href="#L-670"><span class="linenos"> 670</span></a>        <span class="k">return</span> <span class="n">new_team</span>
</span><span id="L-671"><a href="#L-671"><span class="linenos"> 671</span></a>    <span class="k">except</span> <span class="n">IntegrityError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="L-672"><a href="#L-672"><span class="linenos"> 672</span></a>        <span class="n">db</span><span class="o">.</span><span class="n">rollback</span><span class="p">()</span>
</span><span id="L-673"><a href="#L-673"><span class="linenos"> 673</span></a>        <span class="k">if</span> <span class="s2">&quot;inspectionteam_name_unique&quot;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">orig</span><span class="p">):</span>
</span><span id="L-674"><a href="#L-674"><span class="linenos"> 674</span></a>            <span class="k">raise</span> <span class="n">HTTPException</span><span class="p">(</span><span class="n">status_code</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> <span class="n">detail</span><span class="o">=</span><span class="s2">&quot;Team name already exists.&quot;</span><span class="p">)</span>
</span><span id="L-675"><a href="#L-675"><span class="linenos"> 675</span></a>        <span class="k">raise</span> <span class="n">HTTPException</span><span class="p">(</span>
</span><span id="L-676"><a href="#L-676"><span class="linenos"> 676</span></a>            <span class="n">status_code</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">detail</span><span class="o">=</span><span class="s2">&quot;An error occurred while creating the team.&quot;</span>
</span><span id="L-677"><a href="#L-677"><span class="linenos"> 677</span></a>        <span class="p">)</span>
</span><span id="L-678"><a href="#L-678"><span class="linenos"> 678</span></a>
</span><span id="L-679"><a href="#L-679"><span class="linenos"> 679</span></a>
</span><span id="L-680"><a href="#L-680"><span class="linenos"> 680</span></a><span class="nd">@app</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;/inspection-teams/</span><span class="si">{team_id}</span><span class="s2">/&quot;</span><span class="p">,</span> <span class="n">response_model</span><span class="o">=</span><span class="n">InspectionTeamBase</span><span class="p">)</span>
</span><span id="L-681"><a href="#L-681"><span class="linenos"> 681</span></a><span class="k">def</span><span class="w"> </span><span class="nf">view_inspection_team</span><span class="p">(</span><span class="n">team_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">db</span><span class="p">:</span> <span class="n">sessionmaker</span> <span class="o">=</span> <span class="n">Depends</span><span class="p">(</span><span class="n">get_db</span><span class="p">)):</span>
</span><span id="L-682"><a href="#L-682"><span class="linenos"> 682</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-683"><a href="#L-683"><span class="linenos"> 683</span></a><span class="sd">    View details of a specific inspection team.</span>
</span><span id="L-684"><a href="#L-684"><span class="linenos"> 684</span></a>
</span><span id="L-685"><a href="#L-685"><span class="linenos"> 685</span></a><span class="sd">    This endpoint retrieves the details of an inspection team, including its name and a list of teachers</span>
</span><span id="L-686"><a href="#L-686"><span class="linenos"> 686</span></a><span class="sd">    associated with the team.</span>
</span><span id="L-687"><a href="#L-687"><span class="linenos"> 687</span></a>
</span><span id="L-688"><a href="#L-688"><span class="linenos"> 688</span></a><span class="sd">    Args:</span>
</span><span id="L-689"><a href="#L-689"><span class="linenos"> 689</span></a><span class="sd">        team_id (int): The unique identifier of the inspection team.</span>
</span><span id="L-690"><a href="#L-690"><span class="linenos"> 690</span></a><span class="sd">        db (sessionmaker): The database session dependency injected by FastAPI.</span>
</span><span id="L-691"><a href="#L-691"><span class="linenos"> 691</span></a>
</span><span id="L-692"><a href="#L-692"><span class="linenos"> 692</span></a><span class="sd">    Raises:</span>
</span><span id="L-693"><a href="#L-693"><span class="linenos"> 693</span></a><span class="sd">        HTTPException: If the inspection team with the given ID is not found.</span>
</span><span id="L-694"><a href="#L-694"><span class="linenos"> 694</span></a>
</span><span id="L-695"><a href="#L-695"><span class="linenos"> 695</span></a><span class="sd">    Returns:</span>
</span><span id="L-696"><a href="#L-696"><span class="linenos"> 696</span></a><span class="sd">        InspectionTeamBase: The inspection team details along with a list of teachers:</span>
</span><span id="L-697"><a href="#L-697"><span class="linenos"> 697</span></a><span class="sd">            - id (int): The ID of the inspection team.</span>
</span><span id="L-698"><a href="#L-698"><span class="linenos"> 698</span></a><span class="sd">            - name (str): The name of the inspection team.</span>
</span><span id="L-699"><a href="#L-699"><span class="linenos"> 699</span></a><span class="sd">            - teachers (list[TeacherBase]): A list of teachers associated with the team, where each teacher</span>
</span><span id="L-700"><a href="#L-700"><span class="linenos"> 700</span></a><span class="sd">              includes their ID, name, surname, and title.</span>
</span><span id="L-701"><a href="#L-701"><span class="linenos"> 701</span></a>
</span><span id="L-702"><a href="#L-702"><span class="linenos"> 702</span></a><span class="sd">    Example Response:</span>
</span><span id="L-703"><a href="#L-703"><span class="linenos"> 703</span></a><span class="sd">        {</span>
</span><span id="L-704"><a href="#L-704"><span class="linenos"> 704</span></a><span class="sd">            &quot;id&quot;: 1,</span>
</span><span id="L-705"><a href="#L-705"><span class="linenos"> 705</span></a><span class="sd">            &quot;name&quot;: &quot;Team A&quot;,</span>
</span><span id="L-706"><a href="#L-706"><span class="linenos"> 706</span></a><span class="sd">            &quot;teachers&quot;: [</span>
</span><span id="L-707"><a href="#L-707"><span class="linenos"> 707</span></a><span class="sd">                {</span>
</span><span id="L-708"><a href="#L-708"><span class="linenos"> 708</span></a><span class="sd">                    &quot;id&quot;: 10,</span>
</span><span id="L-709"><a href="#L-709"><span class="linenos"> 709</span></a><span class="sd">                    &quot;name&quot;: &quot;Jane&quot;,</span>
</span><span id="L-710"><a href="#L-710"><span class="linenos"> 710</span></a><span class="sd">                    &quot;surname&quot;: &quot;Doe&quot;,</span>
</span><span id="L-711"><a href="#L-711"><span class="linenos"> 711</span></a><span class="sd">                    &quot;title&quot;: &quot;Dr.&quot;</span>
</span><span id="L-712"><a href="#L-712"><span class="linenos"> 712</span></a><span class="sd">                },</span>
</span><span id="L-713"><a href="#L-713"><span class="linenos"> 713</span></a><span class="sd">                {</span>
</span><span id="L-714"><a href="#L-714"><span class="linenos"> 714</span></a><span class="sd">                    &quot;id&quot;: 11,</span>
</span><span id="L-715"><a href="#L-715"><span class="linenos"> 715</span></a><span class="sd">                    &quot;name&quot;: &quot;John&quot;,</span>
</span><span id="L-716"><a href="#L-716"><span class="linenos"> 716</span></a><span class="sd">                    &quot;surname&quot;: &quot;Smith&quot;,</span>
</span><span id="L-717"><a href="#L-717"><span class="linenos"> 717</span></a><span class="sd">                    &quot;title&quot;: &quot;Prof.&quot;</span>
</span><span id="L-718"><a href="#L-718"><span class="linenos"> 718</span></a><span class="sd">                }</span>
</span><span id="L-719"><a href="#L-719"><span class="linenos"> 719</span></a><span class="sd">            ]</span>
</span><span id="L-720"><a href="#L-720"><span class="linenos"> 720</span></a><span class="sd">        }</span>
</span><span id="L-721"><a href="#L-721"><span class="linenos"> 721</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-722"><a href="#L-722"><span class="linenos"> 722</span></a>
</span><span id="L-723"><a href="#L-723"><span class="linenos"> 723</span></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="L-724"><a href="#L-724"><span class="linenos"> 724</span></a>        <span class="n">team</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">InspectionTeam</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">InspectionTeam</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">team_id</span><span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="L-725"><a href="#L-725"><span class="linenos"> 725</span></a>        <span class="n">teachers</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-726"><a href="#L-726"><span class="linenos"> 726</span></a>            <span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">Teacher</span><span class="p">)</span>
</span><span id="L-727"><a href="#L-727"><span class="linenos"> 727</span></a>            <span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">TeacherInspectionTeam</span><span class="p">)</span>
</span><span id="L-728"><a href="#L-728"><span class="linenos"> 728</span></a>            <span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">TeacherInspectionTeam</span><span class="o">.</span><span class="n">fk_inspectionTeam</span> <span class="o">==</span> <span class="n">team_id</span><span class="p">)</span>
</span><span id="L-729"><a href="#L-729"><span class="linenos"> 729</span></a>            <span class="o">.</span><span class="n">all</span><span class="p">()</span>
</span><span id="L-730"><a href="#L-730"><span class="linenos"> 730</span></a>        <span class="p">)</span>
</span><span id="L-731"><a href="#L-731"><span class="linenos"> 731</span></a>        <span class="k">return</span> <span class="n">InspectionTeamBase</span><span class="p">(</span>
</span><span id="L-732"><a href="#L-732"><span class="linenos"> 732</span></a>            <span class="nb">id</span><span class="o">=</span><span class="n">team</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
</span><span id="L-733"><a href="#L-733"><span class="linenos"> 733</span></a>            <span class="n">name</span><span class="o">=</span><span class="n">team</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="L-734"><a href="#L-734"><span class="linenos"> 734</span></a>            <span class="n">teachers</span><span class="o">=</span><span class="p">[</span>
</span><span id="L-735"><a href="#L-735"><span class="linenos"> 735</span></a>                <span class="n">TeacherBase</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">t</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">t</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">surname</span><span class="o">=</span><span class="n">t</span><span class="o">.</span><span class="n">surname</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">t</span><span class="o">.</span><span class="n">title</span><span class="p">)</span>
</span><span id="L-736"><a href="#L-736"><span class="linenos"> 736</span></a>                <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">teachers</span>
</span><span id="L-737"><a href="#L-737"><span class="linenos"> 737</span></a>            <span class="p">],</span>
</span><span id="L-738"><a href="#L-738"><span class="linenos"> 738</span></a>        <span class="p">)</span>
</span><span id="L-739"><a href="#L-739"><span class="linenos"> 739</span></a>    <span class="k">except</span> <span class="n">NoResultFound</span><span class="p">:</span>
</span><span id="L-740"><a href="#L-740"><span class="linenos"> 740</span></a>        <span class="k">raise</span> <span class="n">HTTPException</span><span class="p">(</span><span class="n">status_code</span><span class="o">=</span><span class="mi">404</span><span class="p">,</span> <span class="n">detail</span><span class="o">=</span><span class="s2">&quot;Inspection Team not found&quot;</span><span class="p">)</span>
</span><span id="L-741"><a href="#L-741"><span class="linenos"> 741</span></a>
</span><span id="L-742"><a href="#L-742"><span class="linenos"> 742</span></a>
</span><span id="L-743"><a href="#L-743"><span class="linenos"> 743</span></a><span class="nd">@app</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="s2">&quot;/inspection-teams/</span><span class="si">{team_id}</span><span class="s2">/add-teacher/&quot;</span><span class="p">)</span>
</span><span id="L-744"><a href="#L-744"><span class="linenos"> 744</span></a><span class="k">def</span><span class="w"> </span><span class="nf">add_teacher_to_team</span><span class="p">(</span>
</span><span id="L-745"><a href="#L-745"><span class="linenos"> 745</span></a>    <span class="n">team_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">payload</span><span class="p">:</span> <span class="n">AddTeacherToTeam</span><span class="p">,</span> <span class="n">db</span><span class="p">:</span> <span class="n">sessionmaker</span> <span class="o">=</span> <span class="n">Depends</span><span class="p">(</span><span class="n">get_db</span><span class="p">)</span>
</span><span id="L-746"><a href="#L-746"><span class="linenos"> 746</span></a><span class="p">):</span>
</span><span id="L-747"><a href="#L-747"><span class="linenos"> 747</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-748"><a href="#L-748"><span class="linenos"> 748</span></a><span class="sd">    Add a teacher to an inspection team.</span>
</span><span id="L-749"><a href="#L-749"><span class="linenos"> 749</span></a>
</span><span id="L-750"><a href="#L-750"><span class="linenos"> 750</span></a><span class="sd">    This endpoint assigns a teacher to a specific inspection team. If the teacher is already part of the team,</span>
</span><span id="L-751"><a href="#L-751"><span class="linenos"> 751</span></a><span class="sd">    an error is raised. If the teacher or the team is not found, a corresponding error message is returned.</span>
</span><span id="L-752"><a href="#L-752"><span class="linenos"> 752</span></a>
</span><span id="L-753"><a href="#L-753"><span class="linenos"> 753</span></a><span class="sd">    Args:</span>
</span><span id="L-754"><a href="#L-754"><span class="linenos"> 754</span></a><span class="sd">        team_id (int): The unique identifier of the inspection team.</span>
</span><span id="L-755"><a href="#L-755"><span class="linenos"> 755</span></a><span class="sd">        payload (AddTeacherToTeam): The data model containing the teacher&#39;s ID to be added to the team.</span>
</span><span id="L-756"><a href="#L-756"><span class="linenos"> 756</span></a><span class="sd">        db (sessionmaker): The database session dependency injected by FastAPI.</span>
</span><span id="L-757"><a href="#L-757"><span class="linenos"> 757</span></a>
</span><span id="L-758"><a href="#L-758"><span class="linenos"> 758</span></a><span class="sd">    Raises:</span>
</span><span id="L-759"><a href="#L-759"><span class="linenos"> 759</span></a><span class="sd">        HTTPException: If the inspection team or teacher is not found, or if the teacher is already assigned to the team,</span>
</span><span id="L-760"><a href="#L-760"><span class="linenos"> 760</span></a><span class="sd">        or if there is an issue adding the teacher to the team.</span>
</span><span id="L-761"><a href="#L-761"><span class="linenos"> 761</span></a>
</span><span id="L-762"><a href="#L-762"><span class="linenos"> 762</span></a><span class="sd">    Returns:</span>
</span><span id="L-763"><a href="#L-763"><span class="linenos"> 763</span></a><span class="sd">        dict: A success message indicating the teacher was added to the team.</span>
</span><span id="L-764"><a href="#L-764"><span class="linenos"> 764</span></a>
</span><span id="L-765"><a href="#L-765"><span class="linenos"> 765</span></a><span class="sd">    Example Request Body (JSON):</span>
</span><span id="L-766"><a href="#L-766"><span class="linenos"> 766</span></a><span class="sd">        {</span>
</span><span id="L-767"><a href="#L-767"><span class="linenos"> 767</span></a><span class="sd">            &quot;teacher_id&quot;: 5</span>
</span><span id="L-768"><a href="#L-768"><span class="linenos"> 768</span></a><span class="sd">        }</span>
</span><span id="L-769"><a href="#L-769"><span class="linenos"> 769</span></a>
</span><span id="L-770"><a href="#L-770"><span class="linenos"> 770</span></a><span class="sd">    Example Response:</span>
</span><span id="L-771"><a href="#L-771"><span class="linenos"> 771</span></a><span class="sd">        {</span>
</span><span id="L-772"><a href="#L-772"><span class="linenos"> 772</span></a><span class="sd">            &quot;message&quot;: &quot;Teacher added to the team successfully&quot;</span>
</span><span id="L-773"><a href="#L-773"><span class="linenos"> 773</span></a><span class="sd">        }</span>
</span><span id="L-774"><a href="#L-774"><span class="linenos"> 774</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-775"><a href="#L-775"><span class="linenos"> 775</span></a>
</span><span id="L-776"><a href="#L-776"><span class="linenos"> 776</span></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="L-777"><a href="#L-777"><span class="linenos"> 777</span></a>        <span class="n">team</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">InspectionTeam</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">InspectionTeam</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">team_id</span><span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="L-778"><a href="#L-778"><span class="linenos"> 778</span></a>    <span class="k">except</span> <span class="n">NoResultFound</span><span class="p">:</span>
</span><span id="L-779"><a href="#L-779"><span class="linenos"> 779</span></a>        <span class="k">raise</span> <span class="n">HTTPException</span><span class="p">(</span><span class="n">status_code</span><span class="o">=</span><span class="mi">404</span><span class="p">,</span> <span class="n">detail</span><span class="o">=</span><span class="s2">&quot;Inspection Team not found&quot;</span><span class="p">)</span>
</span><span id="L-780"><a href="#L-780"><span class="linenos"> 780</span></a>
</span><span id="L-781"><a href="#L-781"><span class="linenos"> 781</span></a>    <span class="n">teacher</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">Teacher</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">Teacher</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">payload</span><span class="o">.</span><span class="n">teacher_id</span><span class="p">)</span><span class="o">.</span><span class="n">one_or_none</span><span class="p">()</span>
</span><span id="L-782"><a href="#L-782"><span class="linenos"> 782</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">teacher</span><span class="p">:</span>
</span><span id="L-783"><a href="#L-783"><span class="linenos"> 783</span></a>        <span class="k">raise</span> <span class="n">HTTPException</span><span class="p">(</span><span class="n">status_code</span><span class="o">=</span><span class="mi">404</span><span class="p">,</span> <span class="n">detail</span><span class="o">=</span><span class="s2">&quot;Teacher not found&quot;</span><span class="p">)</span>
</span><span id="L-784"><a href="#L-784"><span class="linenos"> 784</span></a>
</span><span id="L-785"><a href="#L-785"><span class="linenos"> 785</span></a>    <span class="n">existing_assignment</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-786"><a href="#L-786"><span class="linenos"> 786</span></a>        <span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">TeacherInspectionTeam</span><span class="p">)</span>
</span><span id="L-787"><a href="#L-787"><span class="linenos"> 787</span></a>        <span class="o">.</span><span class="n">filter</span><span class="p">(</span>
</span><span id="L-788"><a href="#L-788"><span class="linenos"> 788</span></a>            <span class="n">TeacherInspectionTeam</span><span class="o">.</span><span class="n">fk_teacher</span> <span class="o">==</span> <span class="n">payload</span><span class="o">.</span><span class="n">teacher_id</span><span class="p">,</span>
</span><span id="L-789"><a href="#L-789"><span class="linenos"> 789</span></a>            <span class="n">TeacherInspectionTeam</span><span class="o">.</span><span class="n">fk_inspectionTeam</span> <span class="o">==</span> <span class="n">team_id</span><span class="p">,</span>
</span><span id="L-790"><a href="#L-790"><span class="linenos"> 790</span></a>        <span class="p">)</span>
</span><span id="L-791"><a href="#L-791"><span class="linenos"> 791</span></a>        <span class="o">.</span><span class="n">one_or_none</span><span class="p">()</span>
</span><span id="L-792"><a href="#L-792"><span class="linenos"> 792</span></a>    <span class="p">)</span>
</span><span id="L-793"><a href="#L-793"><span class="linenos"> 793</span></a>
</span><span id="L-794"><a href="#L-794"><span class="linenos"> 794</span></a>    <span class="k">if</span> <span class="n">existing_assignment</span><span class="p">:</span>
</span><span id="L-795"><a href="#L-795"><span class="linenos"> 795</span></a>        <span class="k">raise</span> <span class="n">HTTPException</span><span class="p">(</span><span class="n">status_code</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> <span class="n">detail</span><span class="o">=</span><span class="s2">&quot;Teacher is already in the team&quot;</span><span class="p">)</span>
</span><span id="L-796"><a href="#L-796"><span class="linenos"> 796</span></a>
</span><span id="L-797"><a href="#L-797"><span class="linenos"> 797</span></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="L-798"><a href="#L-798"><span class="linenos"> 798</span></a>        <span class="n">assignment</span> <span class="o">=</span> <span class="n">TeacherInspectionTeam</span><span class="p">(</span>
</span><span id="L-799"><a href="#L-799"><span class="linenos"> 799</span></a>            <span class="n">fk_teacher</span><span class="o">=</span><span class="n">payload</span><span class="o">.</span><span class="n">teacher_id</span><span class="p">,</span> <span class="n">fk_inspectionTeam</span><span class="o">=</span><span class="n">team_id</span>
</span><span id="L-800"><a href="#L-800"><span class="linenos"> 800</span></a>        <span class="p">)</span>
</span><span id="L-801"><a href="#L-801"><span class="linenos"> 801</span></a>        <span class="n">db</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">assignment</span><span class="p">)</span>
</span><span id="L-802"><a href="#L-802"><span class="linenos"> 802</span></a>        <span class="n">db</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="L-803"><a href="#L-803"><span class="linenos"> 803</span></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="L-804"><a href="#L-804"><span class="linenos"> 804</span></a>        <span class="k">raise</span> <span class="n">HTTPException</span><span class="p">(</span>
</span><span id="L-805"><a href="#L-805"><span class="linenos"> 805</span></a>            <span class="n">status_code</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span>
</span><span id="L-806"><a href="#L-806"><span class="linenos"> 806</span></a>            <span class="n">detail</span><span class="o">=</span><span class="s2">&quot;Unable to add teacher ot the team, is the team full?&quot;</span><span class="p">,</span>
</span><span id="L-807"><a href="#L-807"><span class="linenos"> 807</span></a>        <span class="p">)</span>
</span><span id="L-808"><a href="#L-808"><span class="linenos"> 808</span></a>
</span><span id="L-809"><a href="#L-809"><span class="linenos"> 809</span></a>    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;Teacher added to the team successfully&quot;</span><span class="p">}</span>
</span><span id="L-810"><a href="#L-810"><span class="linenos"> 810</span></a>
</span><span id="L-811"><a href="#L-811"><span class="linenos"> 811</span></a>
</span><span id="L-812"><a href="#L-812"><span class="linenos"> 812</span></a><span class="nd">@app</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="s2">&quot;/inspection-teams/</span><span class="si">{team_id}</span><span class="s2">/remove-teacher/&quot;</span><span class="p">)</span>
</span><span id="L-813"><a href="#L-813"><span class="linenos"> 813</span></a><span class="k">def</span><span class="w"> </span><span class="nf">remove_teacher_from_team</span><span class="p">(</span>
</span><span id="L-814"><a href="#L-814"><span class="linenos"> 814</span></a>    <span class="n">team_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">payload</span><span class="p">:</span> <span class="n">RemoveTeacherFromTeam</span><span class="p">,</span> <span class="n">db</span><span class="p">:</span> <span class="n">sessionmaker</span> <span class="o">=</span> <span class="n">Depends</span><span class="p">(</span><span class="n">get_db</span><span class="p">)</span>
</span><span id="L-815"><a href="#L-815"><span class="linenos"> 815</span></a><span class="p">):</span>
</span><span id="L-816"><a href="#L-816"><span class="linenos"> 816</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-817"><a href="#L-817"><span class="linenos"> 817</span></a><span class="sd">    Remove a teacher from an inspection team.</span>
</span><span id="L-818"><a href="#L-818"><span class="linenos"> 818</span></a>
</span><span id="L-819"><a href="#L-819"><span class="linenos"> 819</span></a><span class="sd">    This endpoint removes a teacher from a specific inspection team. If the teacher is not assigned to the team,</span>
</span><span id="L-820"><a href="#L-820"><span class="linenos"> 820</span></a><span class="sd">    an error is raised. If the team or the teacher is not found, a corresponding error message is returned.</span>
</span><span id="L-821"><a href="#L-821"><span class="linenos"> 821</span></a>
</span><span id="L-822"><a href="#L-822"><span class="linenos"> 822</span></a><span class="sd">    Args:</span>
</span><span id="L-823"><a href="#L-823"><span class="linenos"> 823</span></a><span class="sd">        team_id (int): The unique identifier of the inspection team.</span>
</span><span id="L-824"><a href="#L-824"><span class="linenos"> 824</span></a><span class="sd">        payload (RemoveTeacherFromTeam): The data model containing the teacher&#39;s ID to be removed from the team.</span>
</span><span id="L-825"><a href="#L-825"><span class="linenos"> 825</span></a><span class="sd">        db (sessionmaker): The database session dependency injected by FastAPI.</span>
</span><span id="L-826"><a href="#L-826"><span class="linenos"> 826</span></a>
</span><span id="L-827"><a href="#L-827"><span class="linenos"> 827</span></a><span class="sd">    Raises:</span>
</span><span id="L-828"><a href="#L-828"><span class="linenos"> 828</span></a><span class="sd">        HTTPException: If the inspection team or teacher is not found, or if the teacher is not part of the team.</span>
</span><span id="L-829"><a href="#L-829"><span class="linenos"> 829</span></a>
</span><span id="L-830"><a href="#L-830"><span class="linenos"> 830</span></a><span class="sd">    Returns:</span>
</span><span id="L-831"><a href="#L-831"><span class="linenos"> 831</span></a><span class="sd">        dict: A success message indicating the teacher was removed from the team.</span>
</span><span id="L-832"><a href="#L-832"><span class="linenos"> 832</span></a>
</span><span id="L-833"><a href="#L-833"><span class="linenos"> 833</span></a><span class="sd">    Example Request Body (JSON):</span>
</span><span id="L-834"><a href="#L-834"><span class="linenos"> 834</span></a><span class="sd">        {</span>
</span><span id="L-835"><a href="#L-835"><span class="linenos"> 835</span></a><span class="sd">            &quot;teacher_id&quot;: 5</span>
</span><span id="L-836"><a href="#L-836"><span class="linenos"> 836</span></a><span class="sd">        }</span>
</span><span id="L-837"><a href="#L-837"><span class="linenos"> 837</span></a>
</span><span id="L-838"><a href="#L-838"><span class="linenos"> 838</span></a><span class="sd">    Example Response:</span>
</span><span id="L-839"><a href="#L-839"><span class="linenos"> 839</span></a><span class="sd">        {</span>
</span><span id="L-840"><a href="#L-840"><span class="linenos"> 840</span></a><span class="sd">            &quot;message&quot;: &quot;Teacher removed from the team successfully&quot;</span>
</span><span id="L-841"><a href="#L-841"><span class="linenos"> 841</span></a><span class="sd">        }</span>
</span><span id="L-842"><a href="#L-842"><span class="linenos"> 842</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-843"><a href="#L-843"><span class="linenos"> 843</span></a>
</span><span id="L-844"><a href="#L-844"><span class="linenos"> 844</span></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="L-845"><a href="#L-845"><span class="linenos"> 845</span></a>        <span class="n">team</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">InspectionTeam</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">InspectionTeam</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">team_id</span><span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="L-846"><a href="#L-846"><span class="linenos"> 846</span></a>    <span class="k">except</span> <span class="n">NoResultFound</span><span class="p">:</span>
</span><span id="L-847"><a href="#L-847"><span class="linenos"> 847</span></a>        <span class="k">raise</span> <span class="n">HTTPException</span><span class="p">(</span><span class="n">status_code</span><span class="o">=</span><span class="mi">404</span><span class="p">,</span> <span class="n">detail</span><span class="o">=</span><span class="s2">&quot;Inspection Team not found&quot;</span><span class="p">)</span>
</span><span id="L-848"><a href="#L-848"><span class="linenos"> 848</span></a>
</span><span id="L-849"><a href="#L-849"><span class="linenos"> 849</span></a>    <span class="n">assignment</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-850"><a href="#L-850"><span class="linenos"> 850</span></a>        <span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">TeacherInspectionTeam</span><span class="p">)</span>
</span><span id="L-851"><a href="#L-851"><span class="linenos"> 851</span></a>        <span class="o">.</span><span class="n">filter</span><span class="p">(</span>
</span><span id="L-852"><a href="#L-852"><span class="linenos"> 852</span></a>            <span class="n">TeacherInspectionTeam</span><span class="o">.</span><span class="n">fk_teacher</span> <span class="o">==</span> <span class="n">payload</span><span class="o">.</span><span class="n">teacher_id</span><span class="p">,</span>
</span><span id="L-853"><a href="#L-853"><span class="linenos"> 853</span></a>            <span class="n">TeacherInspectionTeam</span><span class="o">.</span><span class="n">fk_inspectionTeam</span> <span class="o">==</span> <span class="n">team_id</span><span class="p">,</span>
</span><span id="L-854"><a href="#L-854"><span class="linenos"> 854</span></a>        <span class="p">)</span>
</span><span id="L-855"><a href="#L-855"><span class="linenos"> 855</span></a>        <span class="o">.</span><span class="n">one_or_none</span><span class="p">()</span>
</span><span id="L-856"><a href="#L-856"><span class="linenos"> 856</span></a>    <span class="p">)</span>
</span><span id="L-857"><a href="#L-857"><span class="linenos"> 857</span></a>
</span><span id="L-858"><a href="#L-858"><span class="linenos"> 858</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">assignment</span><span class="p">:</span>
</span><span id="L-859"><a href="#L-859"><span class="linenos"> 859</span></a>        <span class="k">raise</span> <span class="n">HTTPException</span><span class="p">(</span><span class="n">status_code</span><span class="o">=</span><span class="mi">404</span><span class="p">,</span> <span class="n">detail</span><span class="o">=</span><span class="s2">&quot;Teacher is not in the team&quot;</span><span class="p">)</span>
</span><span id="L-860"><a href="#L-860"><span class="linenos"> 860</span></a>
</span><span id="L-861"><a href="#L-861"><span class="linenos"> 861</span></a>    <span class="n">db</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">assignment</span><span class="p">)</span>
</span><span id="L-862"><a href="#L-862"><span class="linenos"> 862</span></a>    <span class="n">db</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="L-863"><a href="#L-863"><span class="linenos"> 863</span></a>    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;Teacher removed from the team successfully&quot;</span><span class="p">}</span>
</span><span id="L-864"><a href="#L-864"><span class="linenos"> 864</span></a>
</span><span id="L-865"><a href="#L-865"><span class="linenos"> 865</span></a>
</span><span id="L-866"><a href="#L-866"><span class="linenos"> 866</span></a><span class="nd">@app</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;/inspection-teams/</span><span class="si">{teacher_id}</span><span class="s2">/</span><span class="si">{lesson_id}</span><span class="s2">/&quot;</span><span class="p">)</span>
</span><span id="L-867"><a href="#L-867"><span class="linenos"> 867</span></a><span class="k">def</span><span class="w"> </span><span class="nf">get_specified_inspection_teams</span><span class="p">(</span>
</span><span id="L-868"><a href="#L-868"><span class="linenos"> 868</span></a>    <span class="n">teacher_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">lesson_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">db</span><span class="p">:</span> <span class="n">sessionmaker</span> <span class="o">=</span> <span class="n">Depends</span><span class="p">(</span><span class="n">get_db</span><span class="p">)</span>
</span><span id="L-869"><a href="#L-869"><span class="linenos"> 869</span></a><span class="p">):</span>
</span><span id="L-870"><a href="#L-870"><span class="linenos"> 870</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-871"><a href="#L-871"><span class="linenos"> 871</span></a><span class="sd">    Get available inspection teams for a specified teacher and lesson.</span>
</span><span id="L-872"><a href="#L-872"><span class="linenos"> 872</span></a>
</span><span id="L-873"><a href="#L-873"><span class="linenos"> 873</span></a><span class="sd">    This endpoint retrieves inspection teams that are available to participate in an inspection for a specific</span>
</span><span id="L-874"><a href="#L-874"><span class="linenos"> 874</span></a><span class="sd">    lesson, excluding teams that already have scheduling conflicts or teams with more than one member from the</span>
</span><span id="L-875"><a href="#L-875"><span class="linenos"> 875</span></a><span class="sd">    teacher&#39;s department.</span>
</span><span id="L-876"><a href="#L-876"><span class="linenos"> 876</span></a>
</span><span id="L-877"><a href="#L-877"><span class="linenos"> 877</span></a><span class="sd">    Args:</span>
</span><span id="L-878"><a href="#L-878"><span class="linenos"> 878</span></a><span class="sd">        teacher_id (int): The unique identifier of the teacher who is being inspected.</span>
</span><span id="L-879"><a href="#L-879"><span class="linenos"> 879</span></a><span class="sd">        lesson_id (int): The unique identifier of the lesson being inspected.</span>
</span><span id="L-880"><a href="#L-880"><span class="linenos"> 880</span></a><span class="sd">        db (sessionmaker): The database session dependency injected by FastAPI.</span>
</span><span id="L-881"><a href="#L-881"><span class="linenos"> 881</span></a>
</span><span id="L-882"><a href="#L-882"><span class="linenos"> 882</span></a><span class="sd">    Raises:</span>
</span><span id="L-883"><a href="#L-883"><span class="linenos"> 883</span></a><span class="sd">        HTTPException: If the lesson or the inspected teacher is not found.</span>
</span><span id="L-884"><a href="#L-884"><span class="linenos"> 884</span></a>
</span><span id="L-885"><a href="#L-885"><span class="linenos"> 885</span></a><span class="sd">    Returns:</span>
</span><span id="L-886"><a href="#L-886"><span class="linenos"> 886</span></a><span class="sd">        list[dict]: A list of inspection teams that are available for the specified lesson, including the team name</span>
</span><span id="L-887"><a href="#L-887"><span class="linenos"> 887</span></a><span class="sd">            and members that do not have scheduling conflicts, with no more than one member from the inspected teacher&#39;s department.</span>
</span><span id="L-888"><a href="#L-888"><span class="linenos"> 888</span></a>
</span><span id="L-889"><a href="#L-889"><span class="linenos"> 889</span></a><span class="sd">    Example Response:</span>
</span><span id="L-890"><a href="#L-890"><span class="linenos"> 890</span></a><span class="sd">        [</span>
</span><span id="L-891"><a href="#L-891"><span class="linenos"> 891</span></a><span class="sd">            {</span>
</span><span id="L-892"><a href="#L-892"><span class="linenos"> 892</span></a><span class="sd">                &quot;inspection_team_id&quot;: 1,</span>
</span><span id="L-893"><a href="#L-893"><span class="linenos"> 893</span></a><span class="sd">                &quot;inspection_team_name&quot;: &quot;Team A&quot;,</span>
</span><span id="L-894"><a href="#L-894"><span class="linenos"> 894</span></a><span class="sd">                &quot;members&quot;: [</span>
</span><span id="L-895"><a href="#L-895"><span class="linenos"> 895</span></a><span class="sd">                    {</span>
</span><span id="L-896"><a href="#L-896"><span class="linenos"> 896</span></a><span class="sd">                        &quot;teacher_id&quot;: 3,</span>
</span><span id="L-897"><a href="#L-897"><span class="linenos"> 897</span></a><span class="sd">                        &quot;teacher_name&quot;: &quot;Alice&quot;,</span>
</span><span id="L-898"><a href="#L-898"><span class="linenos"> 898</span></a><span class="sd">                        &quot;teacher_surname&quot;: &quot;Johnson&quot;,</span>
</span><span id="L-899"><a href="#L-899"><span class="linenos"> 899</span></a><span class="sd">                        &quot;teacher_title&quot;: &quot;Dr.&quot;,</span>
</span><span id="L-900"><a href="#L-900"><span class="linenos"> 900</span></a><span class="sd">                        &quot;teacher_department&quot;: &quot;Math&quot;</span>
</span><span id="L-901"><a href="#L-901"><span class="linenos"> 901</span></a><span class="sd">                    },</span>
</span><span id="L-902"><a href="#L-902"><span class="linenos"> 902</span></a><span class="sd">                    {</span>
</span><span id="L-903"><a href="#L-903"><span class="linenos"> 903</span></a><span class="sd">                        &quot;teacher_id&quot;: 4,</span>
</span><span id="L-904"><a href="#L-904"><span class="linenos"> 904</span></a><span class="sd">                        &quot;teacher_name&quot;: &quot;Bob&quot;,</span>
</span><span id="L-905"><a href="#L-905"><span class="linenos"> 905</span></a><span class="sd">                        &quot;teacher_surname&quot;: &quot;Lee&quot;,</span>
</span><span id="L-906"><a href="#L-906"><span class="linenos"> 906</span></a><span class="sd">                        &quot;teacher_title&quot;: &quot;Prof.&quot;,</span>
</span><span id="L-907"><a href="#L-907"><span class="linenos"> 907</span></a><span class="sd">                        &quot;teacher_department&quot;: &quot;Physics&quot;</span>
</span><span id="L-908"><a href="#L-908"><span class="linenos"> 908</span></a><span class="sd">                    }</span>
</span><span id="L-909"><a href="#L-909"><span class="linenos"> 909</span></a><span class="sd">                ]</span>
</span><span id="L-910"><a href="#L-910"><span class="linenos"> 910</span></a><span class="sd">            }</span>
</span><span id="L-911"><a href="#L-911"><span class="linenos"> 911</span></a><span class="sd">        ]</span>
</span><span id="L-912"><a href="#L-912"><span class="linenos"> 912</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-913"><a href="#L-913"><span class="linenos"> 913</span></a>
</span><span id="L-914"><a href="#L-914"><span class="linenos"> 914</span></a>    <span class="n">lesson</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">Lesson</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">Lesson</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">lesson_id</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
</span><span id="L-915"><a href="#L-915"><span class="linenos"> 915</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">lesson</span><span class="p">:</span>
</span><span id="L-916"><a href="#L-916"><span class="linenos"> 916</span></a>        <span class="k">raise</span> <span class="n">HTTPException</span><span class="p">(</span><span class="n">status_code</span><span class="o">=</span><span class="mi">404</span><span class="p">,</span> <span class="n">detail</span><span class="o">=</span><span class="s2">&quot;Lesson not found.&quot;</span><span class="p">)</span>
</span><span id="L-917"><a href="#L-917"><span class="linenos"> 917</span></a>
</span><span id="L-918"><a href="#L-918"><span class="linenos"> 918</span></a>    <span class="n">inspected_teacher</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">Teacher</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">Teacher</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">teacher_id</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
</span><span id="L-919"><a href="#L-919"><span class="linenos"> 919</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">inspected_teacher</span><span class="p">:</span>
</span><span id="L-920"><a href="#L-920"><span class="linenos"> 920</span></a>        <span class="k">raise</span> <span class="n">HTTPException</span><span class="p">(</span><span class="n">status_code</span><span class="o">=</span><span class="mi">404</span><span class="p">,</span> <span class="n">detail</span><span class="o">=</span><span class="s2">&quot;Inspected teacher not found.&quot;</span><span class="p">)</span>
</span><span id="L-921"><a href="#L-921"><span class="linenos"> 921</span></a>
</span><span id="L-922"><a href="#L-922"><span class="linenos"> 922</span></a>    <span class="n">inspected_department</span> <span class="o">=</span> <span class="n">inspected_teacher</span><span class="o">.</span><span class="n">department</span>
</span><span id="L-923"><a href="#L-923"><span class="linenos"> 923</span></a>
</span><span id="L-924"><a href="#L-924"><span class="linenos"> 924</span></a>    <span class="n">subquery</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-925"><a href="#L-925"><span class="linenos"> 925</span></a>        <span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">TeacherInspectionTeam</span><span class="o">.</span><span class="n">fk_inspectionTeam</span><span class="p">)</span>
</span><span id="L-926"><a href="#L-926"><span class="linenos"> 926</span></a>        <span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">TeacherInspectionTeam</span><span class="o">.</span><span class="n">fk_teacher</span> <span class="o">==</span> <span class="n">teacher_id</span><span class="p">)</span>
</span><span id="L-927"><a href="#L-927"><span class="linenos"> 927</span></a>        <span class="o">.</span><span class="n">subquery</span><span class="p">()</span>
</span><span id="L-928"><a href="#L-928"><span class="linenos"> 928</span></a>    <span class="p">)</span>
</span><span id="L-929"><a href="#L-929"><span class="linenos"> 929</span></a>
</span><span id="L-930"><a href="#L-930"><span class="linenos"> 930</span></a>    <span class="n">inspection_teams</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-931"><a href="#L-931"><span class="linenos"> 931</span></a>        <span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">InspectionTeam</span><span class="p">)</span>
</span><span id="L-932"><a href="#L-932"><span class="linenos"> 932</span></a>        <span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="L-933"><a href="#L-933"><span class="linenos"> 933</span></a>            <span class="n">TeacherInspectionTeam</span><span class="p">,</span>
</span><span id="L-934"><a href="#L-934"><span class="linenos"> 934</span></a>            <span class="n">TeacherInspectionTeam</span><span class="o">.</span><span class="n">fk_inspectionTeam</span> <span class="o">==</span> <span class="n">InspectionTeam</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
</span><span id="L-935"><a href="#L-935"><span class="linenos"> 935</span></a>        <span class="p">)</span>
</span><span id="L-936"><a href="#L-936"><span class="linenos"> 936</span></a>        <span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">InspectionTeam</span><span class="o">.</span><span class="n">id</span><span class="o">.</span><span class="n">notin_</span><span class="p">(</span><span class="n">subquery</span><span class="o">.</span><span class="n">select</span><span class="p">()))</span>
</span><span id="L-937"><a href="#L-937"><span class="linenos"> 937</span></a>        <span class="o">.</span><span class="n">all</span><span class="p">()</span>
</span><span id="L-938"><a href="#L-938"><span class="linenos"> 938</span></a>    <span class="p">)</span>
</span><span id="L-939"><a href="#L-939"><span class="linenos"> 939</span></a>
</span><span id="L-940"><a href="#L-940"><span class="linenos"> 940</span></a>    <span class="n">available_teams</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-941"><a href="#L-941"><span class="linenos"> 941</span></a>
</span><span id="L-942"><a href="#L-942"><span class="linenos"> 942</span></a>    <span class="k">for</span> <span class="n">team</span> <span class="ow">in</span> <span class="n">inspection_teams</span><span class="p">:</span>
</span><span id="L-943"><a href="#L-943"><span class="linenos"> 943</span></a>        <span class="n">department_count</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-944"><a href="#L-944"><span class="linenos"> 944</span></a>        <span class="n">available_members</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-945"><a href="#L-945"><span class="linenos"> 945</span></a>
</span><span id="L-946"><a href="#L-946"><span class="linenos"> 946</span></a>        <span class="k">for</span> <span class="n">member</span> <span class="ow">in</span> <span class="n">team</span><span class="o">.</span><span class="n">teachers</span><span class="p">:</span>
</span><span id="L-947"><a href="#L-947"><span class="linenos"> 947</span></a>            <span class="n">member_lessons</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-948"><a href="#L-948"><span class="linenos"> 948</span></a>                <span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">Lesson</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">Lesson</span><span class="o">.</span><span class="n">fk_teacher</span> <span class="o">==</span> <span class="n">member</span><span class="o">.</span><span class="n">fk_teacher</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
</span><span id="L-949"><a href="#L-949"><span class="linenos"> 949</span></a>            <span class="p">)</span>
</span><span id="L-950"><a href="#L-950"><span class="linenos"> 950</span></a>            <span class="n">member_inspections</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-951"><a href="#L-951"><span class="linenos"> 951</span></a>                <span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">Lesson</span><span class="p">)</span>
</span><span id="L-952"><a href="#L-952"><span class="linenos"> 952</span></a>                <span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">Inspection</span><span class="p">,</span> <span class="n">Inspection</span><span class="o">.</span><span class="n">fk_lesson</span> <span class="o">==</span> <span class="n">Lesson</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
</span><span id="L-953"><a href="#L-953"><span class="linenos"> 953</span></a>                <span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="L-954"><a href="#L-954"><span class="linenos"> 954</span></a>                    <span class="n">TeacherInspectionTeam</span><span class="p">,</span>
</span><span id="L-955"><a href="#L-955"><span class="linenos"> 955</span></a>                    <span class="n">TeacherInspectionTeam</span><span class="o">.</span><span class="n">fk_inspectionTeam</span> <span class="o">==</span> <span class="n">Inspection</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
</span><span id="L-956"><a href="#L-956"><span class="linenos"> 956</span></a>                <span class="p">)</span>
</span><span id="L-957"><a href="#L-957"><span class="linenos"> 957</span></a>                <span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">TeacherInspectionTeam</span><span class="o">.</span><span class="n">fk_teacher</span> <span class="o">==</span> <span class="n">member</span><span class="o">.</span><span class="n">fk_teacher</span><span class="p">)</span>
</span><span id="L-958"><a href="#L-958"><span class="linenos"> 958</span></a>                <span class="o">.</span><span class="n">all</span><span class="p">()</span>
</span><span id="L-959"><a href="#L-959"><span class="linenos"> 959</span></a>            <span class="p">)</span>
</span><span id="L-960"><a href="#L-960"><span class="linenos"> 960</span></a>
</span><span id="L-961"><a href="#L-961"><span class="linenos"> 961</span></a>            <span class="n">conflict_found</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
</span><span id="L-962"><a href="#L-962"><span class="linenos"> 962</span></a>                <span class="n">lesson</span><span class="o">.</span><span class="n">time</span> <span class="o">==</span> <span class="n">scheduled_lesson</span><span class="o">.</span><span class="n">time</span>
</span><span id="L-963"><a href="#L-963"><span class="linenos"> 963</span></a>                <span class="k">for</span> <span class="n">scheduled_lesson</span> <span class="ow">in</span> <span class="n">member_lessons</span> <span class="o">+</span> <span class="n">member_inspections</span>
</span><span id="L-964"><a href="#L-964"><span class="linenos"> 964</span></a>            <span class="p">)</span>
</span><span id="L-965"><a href="#L-965"><span class="linenos"> 965</span></a>            <span class="k">if</span> <span class="n">conflict_found</span><span class="p">:</span>
</span><span id="L-966"><a href="#L-966"><span class="linenos"> 966</span></a>                <span class="k">continue</span>
</span><span id="L-967"><a href="#L-967"><span class="linenos"> 967</span></a>
</span><span id="L-968"><a href="#L-968"><span class="linenos"> 968</span></a>            <span class="k">if</span> <span class="n">member</span><span class="o">.</span><span class="n">teacher</span><span class="o">.</span><span class="n">department</span> <span class="o">==</span> <span class="n">inspected_department</span><span class="p">:</span>
</span><span id="L-969"><a href="#L-969"><span class="linenos"> 969</span></a>                <span class="n">department_count</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-970"><a href="#L-970"><span class="linenos"> 970</span></a>                <span class="k">if</span> <span class="n">department_count</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-971"><a href="#L-971"><span class="linenos"> 971</span></a>                    <span class="k">break</span>
</span><span id="L-972"><a href="#L-972"><span class="linenos"> 972</span></a>
</span><span id="L-973"><a href="#L-973"><span class="linenos"> 973</span></a>            <span class="n">available_members</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="L-974"><a href="#L-974"><span class="linenos"> 974</span></a>                <span class="p">{</span>
</span><span id="L-975"><a href="#L-975"><span class="linenos"> 975</span></a>                    <span class="s2">&quot;teacher_id&quot;</span><span class="p">:</span> <span class="n">member</span><span class="o">.</span><span class="n">teacher</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
</span><span id="L-976"><a href="#L-976"><span class="linenos"> 976</span></a>                    <span class="s2">&quot;teacher_name&quot;</span><span class="p">:</span> <span class="n">member</span><span class="o">.</span><span class="n">teacher</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="L-977"><a href="#L-977"><span class="linenos"> 977</span></a>                    <span class="s2">&quot;teacher_surname&quot;</span><span class="p">:</span> <span class="n">member</span><span class="o">.</span><span class="n">teacher</span><span class="o">.</span><span class="n">surname</span><span class="p">,</span>
</span><span id="L-978"><a href="#L-978"><span class="linenos"> 978</span></a>                    <span class="s2">&quot;teacher_title&quot;</span><span class="p">:</span> <span class="n">member</span><span class="o">.</span><span class="n">teacher</span><span class="o">.</span><span class="n">title</span><span class="p">,</span>
</span><span id="L-979"><a href="#L-979"><span class="linenos"> 979</span></a>                    <span class="s2">&quot;teacher_department&quot;</span><span class="p">:</span> <span class="n">member</span><span class="o">.</span><span class="n">teacher</span><span class="o">.</span><span class="n">department</span><span class="p">,</span>
</span><span id="L-980"><a href="#L-980"><span class="linenos"> 980</span></a>                <span class="p">}</span>
</span><span id="L-981"><a href="#L-981"><span class="linenos"> 981</span></a>            <span class="p">)</span>
</span><span id="L-982"><a href="#L-982"><span class="linenos"> 982</span></a>
</span><span id="L-983"><a href="#L-983"><span class="linenos"> 983</span></a>        <span class="k">if</span> <span class="n">available_members</span> <span class="ow">and</span> <span class="n">department_count</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-984"><a href="#L-984"><span class="linenos"> 984</span></a>            <span class="n">available_teams</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="L-985"><a href="#L-985"><span class="linenos"> 985</span></a>                <span class="p">{</span>
</span><span id="L-986"><a href="#L-986"><span class="linenos"> 986</span></a>                    <span class="s2">&quot;inspection_team_id&quot;</span><span class="p">:</span> <span class="n">team</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
</span><span id="L-987"><a href="#L-987"><span class="linenos"> 987</span></a>                    <span class="s2">&quot;inspection_team_name&quot;</span><span class="p">:</span> <span class="n">team</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="L-988"><a href="#L-988"><span class="linenos"> 988</span></a>                    <span class="s2">&quot;members&quot;</span><span class="p">:</span> <span class="n">available_members</span><span class="p">,</span>
</span><span id="L-989"><a href="#L-989"><span class="linenos"> 989</span></a>                <span class="p">}</span>
</span><span id="L-990"><a href="#L-990"><span class="linenos"> 990</span></a>            <span class="p">)</span>
</span><span id="L-991"><a href="#L-991"><span class="linenos"> 991</span></a>
</span><span id="L-992"><a href="#L-992"><span class="linenos"> 992</span></a>    <span class="k">return</span> <span class="n">available_teams</span> <span class="k">if</span> <span class="n">available_teams</span> <span class="k">else</span> <span class="p">[]</span>
</span><span id="L-993"><a href="#L-993"><span class="linenos"> 993</span></a>
</span><span id="L-994"><a href="#L-994"><span class="linenos"> 994</span></a>
</span><span id="L-995"><a href="#L-995"><span class="linenos"> 995</span></a><span class="nd">@app</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;/teachers/&quot;</span><span class="p">)</span>
</span><span id="L-996"><a href="#L-996"><span class="linenos"> 996</span></a><span class="k">def</span><span class="w"> </span><span class="nf">get_teachers</span><span class="p">(</span><span class="n">db</span><span class="p">:</span> <span class="n">sessionmaker</span> <span class="o">=</span> <span class="n">Depends</span><span class="p">(</span><span class="n">get_db</span><span class="p">)):</span>
</span><span id="L-997"><a href="#L-997"><span class="linenos"> 997</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-998"><a href="#L-998"><span class="linenos"> 998</span></a><span class="sd">    Fetch all teachers.</span>
</span><span id="L-999"><a href="#L-999"><span class="linenos"> 999</span></a>
</span><span id="L-1000"><a href="#L-1000"><span class="linenos">1000</span></a><span class="sd">    This endpoint retrieves a list of all teachers, including their ID, title, name, surname, and department.</span>
</span><span id="L-1001"><a href="#L-1001"><span class="linenos">1001</span></a>
</span><span id="L-1002"><a href="#L-1002"><span class="linenos">1002</span></a><span class="sd">    Args:</span>
</span><span id="L-1003"><a href="#L-1003"><span class="linenos">1003</span></a><span class="sd">        db (sessionmaker): The database session dependency injected by FastAPI.</span>
</span><span id="L-1004"><a href="#L-1004"><span class="linenos">1004</span></a>
</span><span id="L-1005"><a href="#L-1005"><span class="linenos">1005</span></a><span class="sd">    Returns:</span>
</span><span id="L-1006"><a href="#L-1006"><span class="linenos">1006</span></a><span class="sd">        list[dict]: A list of dictionaries containing the teacher details:</span>
</span><span id="L-1007"><a href="#L-1007"><span class="linenos">1007</span></a><span class="sd">            - id (int): The ID of the teacher.</span>
</span><span id="L-1008"><a href="#L-1008"><span class="linenos">1008</span></a><span class="sd">            - title (str): The title of the teacher.</span>
</span><span id="L-1009"><a href="#L-1009"><span class="linenos">1009</span></a><span class="sd">            - name (str): The first name of the teacher.</span>
</span><span id="L-1010"><a href="#L-1010"><span class="linenos">1010</span></a><span class="sd">            - surname (str): The surname of the teacher.</span>
</span><span id="L-1011"><a href="#L-1011"><span class="linenos">1011</span></a><span class="sd">            - department (str): The department of the teacher.</span>
</span><span id="L-1012"><a href="#L-1012"><span class="linenos">1012</span></a>
</span><span id="L-1013"><a href="#L-1013"><span class="linenos">1013</span></a><span class="sd">    Example Response:</span>
</span><span id="L-1014"><a href="#L-1014"><span class="linenos">1014</span></a><span class="sd">        [</span>
</span><span id="L-1015"><a href="#L-1015"><span class="linenos">1015</span></a><span class="sd">            {</span>
</span><span id="L-1016"><a href="#L-1016"><span class="linenos">1016</span></a><span class="sd">                &quot;id&quot;: 1,</span>
</span><span id="L-1017"><a href="#L-1017"><span class="linenos">1017</span></a><span class="sd">                &quot;title&quot;: &quot;Dr.&quot;,</span>
</span><span id="L-1018"><a href="#L-1018"><span class="linenos">1018</span></a><span class="sd">                &quot;name&quot;: &quot;John&quot;,</span>
</span><span id="L-1019"><a href="#L-1019"><span class="linenos">1019</span></a><span class="sd">                &quot;surname&quot;: &quot;Doe&quot;,</span>
</span><span id="L-1020"><a href="#L-1020"><span class="linenos">1020</span></a><span class="sd">                &quot;department&quot;: &quot;Mathematics&quot;</span>
</span><span id="L-1021"><a href="#L-1021"><span class="linenos">1021</span></a><span class="sd">            },</span>
</span><span id="L-1022"><a href="#L-1022"><span class="linenos">1022</span></a><span class="sd">            {</span>
</span><span id="L-1023"><a href="#L-1023"><span class="linenos">1023</span></a><span class="sd">                &quot;id&quot;: 2,</span>
</span><span id="L-1024"><a href="#L-1024"><span class="linenos">1024</span></a><span class="sd">                &quot;title&quot;: &quot;Prof.&quot;,</span>
</span><span id="L-1025"><a href="#L-1025"><span class="linenos">1025</span></a><span class="sd">                &quot;name&quot;: &quot;Jane&quot;,</span>
</span><span id="L-1026"><a href="#L-1026"><span class="linenos">1026</span></a><span class="sd">                &quot;surname&quot;: &quot;Smith&quot;,</span>
</span><span id="L-1027"><a href="#L-1027"><span class="linenos">1027</span></a><span class="sd">                &quot;department&quot;: &quot;Physics&quot;</span>
</span><span id="L-1028"><a href="#L-1028"><span class="linenos">1028</span></a><span class="sd">            }</span>
</span><span id="L-1029"><a href="#L-1029"><span class="linenos">1029</span></a><span class="sd">        ]</span>
</span><span id="L-1030"><a href="#L-1030"><span class="linenos">1030</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1031"><a href="#L-1031"><span class="linenos">1031</span></a>
</span><span id="L-1032"><a href="#L-1032"><span class="linenos">1032</span></a>    <span class="n">teachers</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">Teacher</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
</span><span id="L-1033"><a href="#L-1033"><span class="linenos">1033</span></a>    <span class="k">return</span> <span class="p">[</span>
</span><span id="L-1034"><a href="#L-1034"><span class="linenos">1034</span></a>        <span class="p">{</span>
</span><span id="L-1035"><a href="#L-1035"><span class="linenos">1035</span></a>            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="n">teacher</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
</span><span id="L-1036"><a href="#L-1036"><span class="linenos">1036</span></a>            <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="n">teacher</span><span class="o">.</span><span class="n">title</span><span class="p">,</span>
</span><span id="L-1037"><a href="#L-1037"><span class="linenos">1037</span></a>            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">teacher</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="L-1038"><a href="#L-1038"><span class="linenos">1038</span></a>            <span class="s2">&quot;surname&quot;</span><span class="p">:</span> <span class="n">teacher</span><span class="o">.</span><span class="n">surname</span><span class="p">,</span>
</span><span id="L-1039"><a href="#L-1039"><span class="linenos">1039</span></a>            <span class="s2">&quot;department&quot;</span><span class="p">:</span> <span class="n">teacher</span><span class="o">.</span><span class="n">department</span><span class="p">,</span>
</span><span id="L-1040"><a href="#L-1040"><span class="linenos">1040</span></a>        <span class="p">}</span>
</span><span id="L-1041"><a href="#L-1041"><span class="linenos">1041</span></a>        <span class="k">for</span> <span class="n">teacher</span> <span class="ow">in</span> <span class="n">teachers</span>
</span><span id="L-1042"><a href="#L-1042"><span class="linenos">1042</span></a>    <span class="p">]</span>
</span><span id="L-1043"><a href="#L-1043"><span class="linenos">1043</span></a>
</span><span id="L-1044"><a href="#L-1044"><span class="linenos">1044</span></a>
</span><span id="L-1045"><a href="#L-1045"><span class="linenos">1045</span></a><span class="nd">@app</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;/unique-subjects/</span><span class="si">{teacher_id}</span><span class="s2">/&quot;</span><span class="p">)</span>
</span><span id="L-1046"><a href="#L-1046"><span class="linenos">1046</span></a><span class="k">def</span><span class="w"> </span><span class="nf">get_subjects</span><span class="p">(</span><span class="n">teacher_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">db</span><span class="p">:</span> <span class="n">sessionmaker</span> <span class="o">=</span> <span class="n">Depends</span><span class="p">(</span><span class="n">get_db</span><span class="p">)):</span>
</span><span id="L-1047"><a href="#L-1047"><span class="linenos">1047</span></a>    <span class="n">subjects</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-1048"><a href="#L-1048"><span class="linenos">1048</span></a>        <span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">Subject</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">Subject</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">Subject</span><span class="o">.</span><span class="n">code</span><span class="p">,</span> <span class="n">Subject</span><span class="o">.</span><span class="n">type</span><span class="p">)</span>
</span><span id="L-1049"><a href="#L-1049"><span class="linenos">1049</span></a>        <span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">Lesson</span><span class="p">,</span> <span class="n">Lesson</span><span class="o">.</span><span class="n">fk_subject</span> <span class="o">==</span> <span class="n">Subject</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
</span><span id="L-1050"><a href="#L-1050"><span class="linenos">1050</span></a>        <span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">Teacher</span><span class="p">,</span> <span class="n">Teacher</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">Lesson</span><span class="o">.</span><span class="n">fk_teacher</span><span class="p">)</span>
</span><span id="L-1051"><a href="#L-1051"><span class="linenos">1051</span></a>        <span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">Teacher</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">teacher_id</span><span class="p">)</span>
</span><span id="L-1052"><a href="#L-1052"><span class="linenos">1052</span></a>        <span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">Lesson</span><span class="o">.</span><span class="n">time</span> <span class="o">&gt;=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">())</span>
</span><span id="L-1053"><a href="#L-1053"><span class="linenos">1053</span></a>        <span class="o">.</span><span class="n">all</span><span class="p">()</span>
</span><span id="L-1054"><a href="#L-1054"><span class="linenos">1054</span></a>    <span class="p">)</span>
</span><span id="L-1055"><a href="#L-1055"><span class="linenos">1055</span></a>    <span class="n">result</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-1056"><a href="#L-1056"><span class="linenos">1056</span></a>        <span class="p">{</span>
</span><span id="L-1057"><a href="#L-1057"><span class="linenos">1057</span></a>            <span class="s2">&quot;subject_id&quot;</span><span class="p">:</span> <span class="n">subject</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
</span><span id="L-1058"><a href="#L-1058"><span class="linenos">1058</span></a>            <span class="s2">&quot;subject_name&quot;</span><span class="p">:</span> <span class="n">subject</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="L-1059"><a href="#L-1059"><span class="linenos">1059</span></a>            <span class="s2">&quot;subject_code&quot;</span><span class="p">:</span> <span class="n">subject</span><span class="o">.</span><span class="n">code</span><span class="p">,</span>
</span><span id="L-1060"><a href="#L-1060"><span class="linenos">1060</span></a>            <span class="s2">&quot;subject_type&quot;</span><span class="p">:</span> <span class="n">subject</span><span class="o">.</span><span class="n">type</span><span class="p">,</span>
</span><span id="L-1061"><a href="#L-1061"><span class="linenos">1061</span></a>        <span class="p">}</span>
</span><span id="L-1062"><a href="#L-1062"><span class="linenos">1062</span></a>        <span class="k">for</span> <span class="n">subject</span> <span class="ow">in</span> <span class="n">subjects</span>
</span><span id="L-1063"><a href="#L-1063"><span class="linenos">1063</span></a>    <span class="p">]</span>
</span><span id="L-1064"><a href="#L-1064"><span class="linenos">1064</span></a>
</span><span id="L-1065"><a href="#L-1065"><span class="linenos">1065</span></a>    <span class="k">return</span> <span class="n">result</span>
</span><span id="L-1066"><a href="#L-1066"><span class="linenos">1066</span></a>
</span><span id="L-1067"><a href="#L-1067"><span class="linenos">1067</span></a>
</span><span id="L-1068"><a href="#L-1068"><span class="linenos">1068</span></a><span class="nd">@app</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;/lessons/&quot;</span><span class="p">,</span> <span class="n">response_model</span><span class="o">=</span><span class="nb">list</span><span class="p">[</span><span class="n">LessonBase</span><span class="p">])</span>
</span><span id="L-1069"><a href="#L-1069"><span class="linenos">1069</span></a><span class="k">def</span><span class="w"> </span><span class="nf">get_lessons</span><span class="p">(</span><span class="n">semester</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">db</span><span class="p">:</span> <span class="n">sessionmaker</span> <span class="o">=</span> <span class="n">Depends</span><span class="p">(</span><span class="n">get_db</span><span class="p">)):</span>
</span><span id="L-1070"><a href="#L-1070"><span class="linenos">1070</span></a>    <span class="n">lessons</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">Lesson</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">Lesson</span><span class="o">.</span><span class="n">semester</span> <span class="o">==</span> <span class="n">semester</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
</span><span id="L-1071"><a href="#L-1071"><span class="linenos">1071</span></a>
</span><span id="L-1072"><a href="#L-1072"><span class="linenos">1072</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">lessons</span><span class="p">:</span>
</span><span id="L-1073"><a href="#L-1073"><span class="linenos">1073</span></a>        <span class="k">raise</span> <span class="n">HTTPException</span><span class="p">(</span>
</span><span id="L-1074"><a href="#L-1074"><span class="linenos">1074</span></a>            <span class="n">status_code</span><span class="o">=</span><span class="mi">404</span><span class="p">,</span> <span class="n">detail</span><span class="o">=</span><span class="s2">&quot;No lessons found for the selected semester.&quot;</span>
</span><span id="L-1075"><a href="#L-1075"><span class="linenos">1075</span></a>        <span class="p">)</span>
</span><span id="L-1076"><a href="#L-1076"><span class="linenos">1076</span></a>
</span><span id="L-1077"><a href="#L-1077"><span class="linenos">1077</span></a>    <span class="k">return</span> <span class="n">lessons</span>
</span><span id="L-1078"><a href="#L-1078"><span class="linenos">1078</span></a>
</span><span id="L-1079"><a href="#L-1079"><span class="linenos">1079</span></a>
</span><span id="L-1080"><a href="#L-1080"><span class="linenos">1080</span></a><span class="nd">@app</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;/inspection-schedule/semesters/&quot;</span><span class="p">)</span>
</span><span id="L-1081"><a href="#L-1081"><span class="linenos">1081</span></a><span class="k">def</span><span class="w"> </span><span class="nf">get_available_semesters</span><span class="p">(</span><span class="n">db</span><span class="p">:</span> <span class="n">sessionmaker</span> <span class="o">=</span> <span class="n">Depends</span><span class="p">(</span><span class="n">get_db</span><span class="p">)):</span>
</span><span id="L-1082"><a href="#L-1082"><span class="linenos">1082</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1083"><a href="#L-1083"><span class="linenos">1083</span></a><span class="sd">    Get a list of available semesters for inspection schedules.</span>
</span><span id="L-1084"><a href="#L-1084"><span class="linenos">1084</span></a>
</span><span id="L-1085"><a href="#L-1085"><span class="linenos">1085</span></a><span class="sd">    This endpoint retrieves a list of distinct semesters from the inspection schedules available in the database.</span>
</span><span id="L-1086"><a href="#L-1086"><span class="linenos">1086</span></a>
</span><span id="L-1087"><a href="#L-1087"><span class="linenos">1087</span></a><span class="sd">    Args:</span>
</span><span id="L-1088"><a href="#L-1088"><span class="linenos">1088</span></a><span class="sd">        db (sessionmaker): The database session dependency injected by FastAPI.</span>
</span><span id="L-1089"><a href="#L-1089"><span class="linenos">1089</span></a>
</span><span id="L-1090"><a href="#L-1090"><span class="linenos">1090</span></a><span class="sd">    Returns:</span>
</span><span id="L-1091"><a href="#L-1091"><span class="linenos">1091</span></a><span class="sd">        list[str]: A list of distinct semesters (e.g., &quot;2021-Spring&quot;, &quot;2022-Fall&quot;).</span>
</span><span id="L-1092"><a href="#L-1092"><span class="linenos">1092</span></a>
</span><span id="L-1093"><a href="#L-1093"><span class="linenos">1093</span></a><span class="sd">    Example Response:</span>
</span><span id="L-1094"><a href="#L-1094"><span class="linenos">1094</span></a><span class="sd">        [&quot;2021-Spring&quot;, &quot;2022-Fall&quot;]</span>
</span><span id="L-1095"><a href="#L-1095"><span class="linenos">1095</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1096"><a href="#L-1096"><span class="linenos">1096</span></a>
</span><span id="L-1097"><a href="#L-1097"><span class="linenos">1097</span></a>    <span class="n">semesters</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">InspectionSchedule</span><span class="o">.</span><span class="n">year_semester</span><span class="p">)</span><span class="o">.</span><span class="n">distinct</span><span class="p">()</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
</span><span id="L-1098"><a href="#L-1098"><span class="linenos">1098</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">semesters</span><span class="p">:</span>
</span><span id="L-1099"><a href="#L-1099"><span class="linenos">1099</span></a>        <span class="k">return</span> <span class="p">[]</span>
</span><span id="L-1100"><a href="#L-1100"><span class="linenos">1100</span></a>    <span class="k">return</span> <span class="p">[</span><span class="n">semester</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">semester</span> <span class="ow">in</span> <span class="n">semesters</span><span class="p">]</span>
</span><span id="L-1101"><a href="#L-1101"><span class="linenos">1101</span></a>
</span><span id="L-1102"><a href="#L-1102"><span class="linenos">1102</span></a>
</span><span id="L-1103"><a href="#L-1103"><span class="linenos">1103</span></a><span class="nd">@app</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;/schedule/&quot;</span><span class="p">)</span>
</span><span id="L-1104"><a href="#L-1104"><span class="linenos">1104</span></a><span class="k">def</span><span class="w"> </span><span class="nf">get_schedule</span><span class="p">(</span><span class="n">semester</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">db</span><span class="p">:</span> <span class="n">sessionmaker</span> <span class="o">=</span> <span class="n">Depends</span><span class="p">(</span><span class="n">get_db</span><span class="p">)):</span>
</span><span id="L-1105"><a href="#L-1105"><span class="linenos">1105</span></a>    <span class="n">lessons</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-1106"><a href="#L-1106"><span class="linenos">1106</span></a>        <span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">Lesson</span><span class="p">)</span>
</span><span id="L-1107"><a href="#L-1107"><span class="linenos">1107</span></a>        <span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">Subject</span><span class="p">,</span> <span class="n">Lesson</span><span class="o">.</span><span class="n">fk_subject</span> <span class="o">==</span> <span class="n">Subject</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
</span><span id="L-1108"><a href="#L-1108"><span class="linenos">1108</span></a>        <span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">Teacher</span><span class="p">,</span> <span class="n">Lesson</span><span class="o">.</span><span class="n">fk_teacher</span> <span class="o">==</span> <span class="n">Teacher</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
</span><span id="L-1109"><a href="#L-1109"><span class="linenos">1109</span></a>        <span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">Inspection</span><span class="p">,</span> <span class="n">Inspection</span><span class="o">.</span><span class="n">fk_lesson</span> <span class="o">==</span> <span class="n">Lesson</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
</span><span id="L-1110"><a href="#L-1110"><span class="linenos">1110</span></a>        <span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="L-1111"><a href="#L-1111"><span class="linenos">1111</span></a>            <span class="n">InspectionSchedule</span><span class="p">,</span>
</span><span id="L-1112"><a href="#L-1112"><span class="linenos">1112</span></a>            <span class="n">InspectionSchedule</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">Inspection</span><span class="o">.</span><span class="n">fk_inspectionSchedule</span><span class="p">,</span>
</span><span id="L-1113"><a href="#L-1113"><span class="linenos">1113</span></a>        <span class="p">)</span>
</span><span id="L-1114"><a href="#L-1114"><span class="linenos">1114</span></a>        <span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">InspectionSchedule</span><span class="o">.</span><span class="n">year_semester</span> <span class="o">==</span> <span class="n">semester</span><span class="p">)</span>
</span><span id="L-1115"><a href="#L-1115"><span class="linenos">1115</span></a>        <span class="o">.</span><span class="n">all</span><span class="p">()</span>
</span><span id="L-1116"><a href="#L-1116"><span class="linenos">1116</span></a>    <span class="p">)</span>
</span><span id="L-1117"><a href="#L-1117"><span class="linenos">1117</span></a>
</span><span id="L-1118"><a href="#L-1118"><span class="linenos">1118</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">lessons</span><span class="p">:</span>
</span><span id="L-1119"><a href="#L-1119"><span class="linenos">1119</span></a>        <span class="k">return</span> <span class="p">[]</span>
</span><span id="L-1120"><a href="#L-1120"><span class="linenos">1120</span></a>
</span><span id="L-1121"><a href="#L-1121"><span class="linenos">1121</span></a>    <span class="n">schedule</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1122"><a href="#L-1122"><span class="linenos">1122</span></a>    <span class="k">for</span> <span class="n">lesson</span> <span class="ow">in</span> <span class="n">lessons</span><span class="p">:</span>
</span><span id="L-1123"><a href="#L-1123"><span class="linenos">1123</span></a>        <span class="n">inspection</span> <span class="o">=</span> <span class="n">lesson</span><span class="o">.</span><span class="n">inspections</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">lesson</span><span class="o">.</span><span class="n">inspections</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="L-1124"><a href="#L-1124"><span class="linenos">1124</span></a>        <span class="n">teachers_in_team</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1125"><a href="#L-1125"><span class="linenos">1125</span></a>
</span><span id="L-1126"><a href="#L-1126"><span class="linenos">1126</span></a>        <span class="k">if</span> <span class="n">inspection</span><span class="p">:</span>
</span><span id="L-1127"><a href="#L-1127"><span class="linenos">1127</span></a>            <span class="k">for</span> <span class="n">teacher_team</span> <span class="ow">in</span> <span class="n">inspection</span><span class="o">.</span><span class="n">inspection_team</span><span class="o">.</span><span class="n">teachers</span><span class="p">:</span>
</span><span id="L-1128"><a href="#L-1128"><span class="linenos">1128</span></a>                <span class="n">teachers_in_team</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="L-1129"><a href="#L-1129"><span class="linenos">1129</span></a>                    <span class="p">{</span>
</span><span id="L-1130"><a href="#L-1130"><span class="linenos">1130</span></a>                        <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="n">teacher_team</span><span class="o">.</span><span class="n">teacher</span><span class="o">.</span><span class="n">title</span><span class="p">,</span>
</span><span id="L-1131"><a href="#L-1131"><span class="linenos">1131</span></a>                        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">teacher_team</span><span class="o">.</span><span class="n">teacher</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="L-1132"><a href="#L-1132"><span class="linenos">1132</span></a>                        <span class="s2">&quot;surname&quot;</span><span class="p">:</span> <span class="n">teacher_team</span><span class="o">.</span><span class="n">teacher</span><span class="o">.</span><span class="n">surname</span><span class="p">,</span>
</span><span id="L-1133"><a href="#L-1133"><span class="linenos">1133</span></a>                    <span class="p">}</span>
</span><span id="L-1134"><a href="#L-1134"><span class="linenos">1134</span></a>                <span class="p">)</span>
</span><span id="L-1135"><a href="#L-1135"><span class="linenos">1135</span></a>
</span><span id="L-1136"><a href="#L-1136"><span class="linenos">1136</span></a>        <span class="n">schedule</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="L-1137"><a href="#L-1137"><span class="linenos">1137</span></a>            <span class="p">{</span>
</span><span id="L-1138"><a href="#L-1138"><span class="linenos">1138</span></a>                <span class="s2">&quot;lesson&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="L-1139"><a href="#L-1139"><span class="linenos">1139</span></a>                    <span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="n">lesson</span><span class="o">.</span><span class="n">time</span><span class="p">,</span>
</span><span id="L-1140"><a href="#L-1140"><span class="linenos">1140</span></a>                    <span class="s2">&quot;room&quot;</span><span class="p">:</span> <span class="n">lesson</span><span class="o">.</span><span class="n">room</span><span class="p">,</span>
</span><span id="L-1141"><a href="#L-1141"><span class="linenos">1141</span></a>                    <span class="s2">&quot;building&quot;</span><span class="p">:</span> <span class="n">lesson</span><span class="o">.</span><span class="n">building</span><span class="p">,</span>
</span><span id="L-1142"><a href="#L-1142"><span class="linenos">1142</span></a>                <span class="p">},</span>
</span><span id="L-1143"><a href="#L-1143"><span class="linenos">1143</span></a>                <span class="s2">&quot;subject&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="L-1144"><a href="#L-1144"><span class="linenos">1144</span></a>                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">lesson</span><span class="o">.</span><span class="n">subject</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="L-1145"><a href="#L-1145"><span class="linenos">1145</span></a>                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">lesson</span><span class="o">.</span><span class="n">subject</span><span class="o">.</span><span class="n">type</span><span class="p">,</span>
</span><span id="L-1146"><a href="#L-1146"><span class="linenos">1146</span></a>                <span class="p">},</span>
</span><span id="L-1147"><a href="#L-1147"><span class="linenos">1147</span></a>                <span class="s2">&quot;teacher&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="L-1148"><a href="#L-1148"><span class="linenos">1148</span></a>                    <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="n">lesson</span><span class="o">.</span><span class="n">teacher</span><span class="o">.</span><span class="n">title</span><span class="p">,</span>
</span><span id="L-1149"><a href="#L-1149"><span class="linenos">1149</span></a>                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">lesson</span><span class="o">.</span><span class="n">teacher</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="L-1150"><a href="#L-1150"><span class="linenos">1150</span></a>                    <span class="s2">&quot;surname&quot;</span><span class="p">:</span> <span class="n">lesson</span><span class="o">.</span><span class="n">teacher</span><span class="o">.</span><span class="n">surname</span><span class="p">,</span>
</span><span id="L-1151"><a href="#L-1151"><span class="linenos">1151</span></a>                <span class="p">},</span>
</span><span id="L-1152"><a href="#L-1152"><span class="linenos">1152</span></a>                <span class="s2">&quot;inspection_team&quot;</span><span class="p">:</span> <span class="n">teachers_in_team</span><span class="p">,</span>
</span><span id="L-1153"><a href="#L-1153"><span class="linenos">1153</span></a>            <span class="p">}</span>
</span><span id="L-1154"><a href="#L-1154"><span class="linenos">1154</span></a>        <span class="p">)</span>
</span><span id="L-1155"><a href="#L-1155"><span class="linenos">1155</span></a>
</span><span id="L-1156"><a href="#L-1156"><span class="linenos">1156</span></a>    <span class="k">return</span> <span class="n">schedule</span>
</span><span id="L-1157"><a href="#L-1157"><span class="linenos">1157</span></a>
</span><span id="L-1158"><a href="#L-1158"><span class="linenos">1158</span></a>
</span><span id="L-1159"><a href="#L-1159"><span class="linenos">1159</span></a><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span id="L-1160"><a href="#L-1160"><span class="linenos">1160</span></a>    <span class="n">uvicorn</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;model_database_API:app&quot;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">5000</span><span class="p">,</span> <span class="n">log_level</span><span class="o">=</span><span class="s2">&quot;info&quot;</span><span class="p">)</span>
</span></pre></div>


            </section>
                <section id="DATABASE_URL">
                    <div class="attr variable">
            <span class="name">DATABASE_URL</span>        =
<span class="default_value">&#39;postgresql://postgres:postgres@localhost/inspections&#39;</span>

        
    </div>
    <a class="headerlink" href="#DATABASE_URL"></a>
    
    

                </section>
                <section id="engine">
                    <div class="attr variable">
            <span class="name">engine</span>        =
<span class="default_value">Engine(postgresql://postgres:***@localhost/inspections)</span>

        
    </div>
    <a class="headerlink" href="#engine"></a>
    
    

                </section>
                <section id="SessionLocal">
                    <div class="attr variable">
            <span class="name">SessionLocal</span>        =
<input id="SessionLocal-view-value" class="view-value-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
            <label class="view-value-button pdoc-button" for="SessionLocal-view-value"></label><span class="default_value">sessionmaker(class_=&#39;Session&#39;, autocommit=False, bind=Engine(postgresql://postgres:***@localhost/inspections), autoflush=False, expire_on_commit=True)</span>

        
    </div>
    <a class="headerlink" href="#SessionLocal"></a>
    
    

                </section>
                <section id="Base">
                    <div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Base</span><wbr>(<span class="base">sqlalchemy.orm.decl_api._DynamicAttributesType</span>, <span class="base">sqlalchemy.inspection.Inspectable[sqlalchemy.orm.mapper.Mapper[typing.Any]]</span>):

        
    </div>
    <a class="headerlink" href="#Base"></a>
    
            <div class="docstring"><p>The base class of the class hierarchy.</p>

<p>When called, it accepts no arguments and returns a new featureless
instance that has no instance attributes and cannot be given any.</p>
</div>


                            <div id="Base.__init__" class="classattr">
                                        <input id="Base.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Base</span><span class="signature pdoc-code condensed">(<span class="param"><span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span></span>)</span>

                <label class="view-source-button" for="Base.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Base.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Base.__init__-2165"><a href="#Base.__init__-2165"><span class="linenos">2165</span></a><span class="k">def</span><span class="w"> </span><span class="nf">_declarative_constructor</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Base.__init__-2166"><a href="#Base.__init__-2166"><span class="linenos">2166</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;A simple constructor that allows initialization from kwargs.</span>
</span><span id="Base.__init__-2167"><a href="#Base.__init__-2167"><span class="linenos">2167</span></a>
</span><span id="Base.__init__-2168"><a href="#Base.__init__-2168"><span class="linenos">2168</span></a><span class="sd">    Sets attributes on the constructed instance using the names and</span>
</span><span id="Base.__init__-2169"><a href="#Base.__init__-2169"><span class="linenos">2169</span></a><span class="sd">    values in ``kwargs``.</span>
</span><span id="Base.__init__-2170"><a href="#Base.__init__-2170"><span class="linenos">2170</span></a>
</span><span id="Base.__init__-2171"><a href="#Base.__init__-2171"><span class="linenos">2171</span></a><span class="sd">    Only keys that are present as</span>
</span><span id="Base.__init__-2172"><a href="#Base.__init__-2172"><span class="linenos">2172</span></a><span class="sd">    attributes of the instance&#39;s class are allowed. These could be,</span>
</span><span id="Base.__init__-2173"><a href="#Base.__init__-2173"><span class="linenos">2173</span></a><span class="sd">    for example, any mapped columns or relationships.</span>
</span><span id="Base.__init__-2174"><a href="#Base.__init__-2174"><span class="linenos">2174</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Base.__init__-2175"><a href="#Base.__init__-2175"><span class="linenos">2175</span></a>    <span class="n">cls_</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="Base.__init__-2176"><a href="#Base.__init__-2176"><span class="linenos">2176</span></a>    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
</span><span id="Base.__init__-2177"><a href="#Base.__init__-2177"><span class="linenos">2177</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">cls_</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
</span><span id="Base.__init__-2178"><a href="#Base.__init__-2178"><span class="linenos">2178</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
</span><span id="Base.__init__-2179"><a href="#Base.__init__-2179"><span class="linenos">2179</span></a>                <span class="s2">&quot;</span><span class="si">%r</span><span class="s2"> is an invalid keyword argument for </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">cls_</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
</span><span id="Base.__init__-2180"><a href="#Base.__init__-2180"><span class="linenos">2180</span></a>            <span class="p">)</span>
</span><span id="Base.__init__-2181"><a href="#Base.__init__-2181"><span class="linenos">2181</span></a>        <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
</span></pre></div>


            <div class="docstring"><p>A simple constructor that allows initialization from kwargs.</p>

<p>Sets attributes on the constructed instance using the names and
values in <code>kwargs</code>.</p>

<p>Only keys that are present as
attributes of the instance's class are allowed. These could be,
for example, any mapped columns or relationships.</p>
</div>


                            </div>
                            <div id="Base.registry" class="classattr">
                                <div class="attr variable">
            <span class="name">registry</span><span class="annotation">: sqlalchemy.orm.decl_api.registry</span>        =
<span class="default_value">&lt;sqlalchemy.orm.decl_api.registry object&gt;</span>

        
    </div>
    <a class="headerlink" href="#Base.registry"></a>
    
    

                            </div>
                            <div id="Base.metadata" class="classattr">
                                <div class="attr variable">
            <span class="name">metadata</span><span class="annotation">: sqlalchemy.sql.schema.MetaData</span>        =
<span class="default_value">MetaData()</span>

        
    </div>
    <a class="headerlink" href="#Base.metadata"></a>
    
    

                            </div>
                </section>
                <section id="app">
                    <div class="attr variable">
            <span class="name">app</span>        =
<span class="default_value">&lt;fastapi.applications.FastAPI object&gt;</span>

        
    </div>
    <a class="headerlink" href="#app"></a>
    
    

                </section>
                <section id="get_db">
                            <input id="get_db-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_db</span><span class="signature pdoc-code condensed">(<span class="return-annotation">):</span></span>

                <label class="view-source-button" for="get_db-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#get_db"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="get_db-29"><a href="#get_db-29"><span class="linenos">29</span></a><span class="k">def</span><span class="w"> </span><span class="nf">get_db</span><span class="p">():</span>
</span><span id="get_db-30"><a href="#get_db-30"><span class="linenos">30</span></a>    <span class="n">db</span> <span class="o">=</span> <span class="n">SessionLocal</span><span class="p">()</span>
</span><span id="get_db-31"><a href="#get_db-31"><span class="linenos">31</span></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="get_db-32"><a href="#get_db-32"><span class="linenos">32</span></a>        <span class="k">yield</span> <span class="n">db</span>
</span><span id="get_db-33"><a href="#get_db-33"><span class="linenos">33</span></a>    <span class="k">finally</span><span class="p">:</span>
</span><span id="get_db-34"><a href="#get_db-34"><span class="linenos">34</span></a>        <span class="n">db</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></pre></div>


    

                </section>
                <section id="get_inspection_docs">
                            <input id="get_inspection_docs-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-app.get">@app.get(&#39;/inspection-docs/&#39;, response_model=list[dict])</div>

        <span class="def">def</span>
        <span class="name">get_inspection_docs</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">db</span><span class="p">:</span> <span class="n">sqlalchemy</span><span class="o">.</span><span class="n">orm</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">sessionmaker</span> <span class="o">=</span> <span class="n">Depends</span><span class="p">(</span><span class="n">get_db</span><span class="p">)</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="get_inspection_docs-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#get_inspection_docs"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="get_inspection_docs-37"><a href="#get_inspection_docs-37"><span class="linenos">37</span></a><span class="nd">@app</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;/inspection-docs/&quot;</span><span class="p">,</span> <span class="n">response_model</span><span class="o">=</span><span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">])</span>
</span><span id="get_inspection_docs-38"><a href="#get_inspection_docs-38"><span class="linenos">38</span></a><span class="k">def</span><span class="w"> </span><span class="nf">get_inspection_docs</span><span class="p">(</span><span class="n">db</span><span class="p">:</span> <span class="n">sessionmaker</span> <span class="o">=</span> <span class="n">Depends</span><span class="p">(</span><span class="n">get_db</span><span class="p">)):</span>
</span><span id="get_inspection_docs-39"><a href="#get_inspection_docs-39"><span class="linenos">39</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="get_inspection_docs-40"><a href="#get_inspection_docs-40"><span class="linenos">40</span></a><span class="sd">    Fetch inspection documents from the database.</span>
</span><span id="get_inspection_docs-41"><a href="#get_inspection_docs-41"><span class="linenos">41</span></a>
</span><span id="get_inspection_docs-42"><a href="#get_inspection_docs-42"><span class="linenos">42</span></a><span class="sd">    This endpoint retrieves a list of inspection documents, including details such as</span>
</span><span id="get_inspection_docs-43"><a href="#get_inspection_docs-43"><span class="linenos">43</span></a><span class="sd">    the inspection date, subject, and teacher information. Data is queried from the</span>
</span><span id="get_inspection_docs-44"><a href="#get_inspection_docs-44"><span class="linenos">44</span></a><span class="sd">    database using SQLAlchemy and structured into a response-friendly format.</span>
</span><span id="get_inspection_docs-45"><a href="#get_inspection_docs-45"><span class="linenos">45</span></a>
</span><span id="get_inspection_docs-46"><a href="#get_inspection_docs-46"><span class="linenos">46</span></a><span class="sd">    Args:</span>
</span><span id="get_inspection_docs-47"><a href="#get_inspection_docs-47"><span class="linenos">47</span></a><span class="sd">        db (sessionmaker): The database session dependency injected by FastAPI.</span>
</span><span id="get_inspection_docs-48"><a href="#get_inspection_docs-48"><span class="linenos">48</span></a>
</span><span id="get_inspection_docs-49"><a href="#get_inspection_docs-49"><span class="linenos">49</span></a><span class="sd">    Returns:</span>
</span><span id="get_inspection_docs-50"><a href="#get_inspection_docs-50"><span class="linenos">50</span></a><span class="sd">        list[dict]: A list of dictionaries containing the following keys:</span>
</span><span id="get_inspection_docs-51"><a href="#get_inspection_docs-51"><span class="linenos">51</span></a><span class="sd">            - id (int): The ID of the inspection document.</span>
</span><span id="get_inspection_docs-52"><a href="#get_inspection_docs-52"><span class="linenos">52</span></a><span class="sd">            - date (datetime): The date of the inspection.</span>
</span><span id="get_inspection_docs-53"><a href="#get_inspection_docs-53"><span class="linenos">53</span></a><span class="sd">            - subject (str): The name of the subject.</span>
</span><span id="get_inspection_docs-54"><a href="#get_inspection_docs-54"><span class="linenos">54</span></a><span class="sd">            - teacher (str): The full name of the teacher, including title, first name, and surname.</span>
</span><span id="get_inspection_docs-55"><a href="#get_inspection_docs-55"><span class="linenos">55</span></a>
</span><span id="get_inspection_docs-56"><a href="#get_inspection_docs-56"><span class="linenos">56</span></a><span class="sd">    Example Response:</span>
</span><span id="get_inspection_docs-57"><a href="#get_inspection_docs-57"><span class="linenos">57</span></a><span class="sd">        [</span>
</span><span id="get_inspection_docs-58"><a href="#get_inspection_docs-58"><span class="linenos">58</span></a><span class="sd">            {</span>
</span><span id="get_inspection_docs-59"><a href="#get_inspection_docs-59"><span class="linenos">59</span></a><span class="sd">                &quot;id&quot;: 1,</span>
</span><span id="get_inspection_docs-60"><a href="#get_inspection_docs-60"><span class="linenos">60</span></a><span class="sd">                &quot;date&quot;: &quot;2025-01-01T10:00:00&quot;,</span>
</span><span id="get_inspection_docs-61"><a href="#get_inspection_docs-61"><span class="linenos">61</span></a><span class="sd">                &quot;subject&quot;: &quot;Mathematics&quot;,</span>
</span><span id="get_inspection_docs-62"><a href="#get_inspection_docs-62"><span class="linenos">62</span></a><span class="sd">                &quot;teacher&quot;: &quot;Dr. John Doe&quot;</span>
</span><span id="get_inspection_docs-63"><a href="#get_inspection_docs-63"><span class="linenos">63</span></a><span class="sd">            },</span>
</span><span id="get_inspection_docs-64"><a href="#get_inspection_docs-64"><span class="linenos">64</span></a><span class="sd">            ...</span>
</span><span id="get_inspection_docs-65"><a href="#get_inspection_docs-65"><span class="linenos">65</span></a><span class="sd">        ]</span>
</span><span id="get_inspection_docs-66"><a href="#get_inspection_docs-66"><span class="linenos">66</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="get_inspection_docs-67"><a href="#get_inspection_docs-67"><span class="linenos">67</span></a>    <span class="n">inspection_docs</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="get_inspection_docs-68"><a href="#get_inspection_docs-68"><span class="linenos">68</span></a>        <span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span>
</span><span id="get_inspection_docs-69"><a href="#get_inspection_docs-69"><span class="linenos">69</span></a>            <span class="n">InspectionReport</span><span class="o">.</span><span class="n">id</span><span class="o">.</span><span class="n">label</span><span class="p">(</span><span class="s2">&quot;document_id&quot;</span><span class="p">),</span>
</span><span id="get_inspection_docs-70"><a href="#get_inspection_docs-70"><span class="linenos">70</span></a>            <span class="n">Lesson</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">label</span><span class="p">(</span><span class="s2">&quot;inspection_date&quot;</span><span class="p">),</span>
</span><span id="get_inspection_docs-71"><a href="#get_inspection_docs-71"><span class="linenos">71</span></a>            <span class="n">Subject</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">label</span><span class="p">(</span><span class="s2">&quot;subject_name&quot;</span><span class="p">),</span>
</span><span id="get_inspection_docs-72"><a href="#get_inspection_docs-72"><span class="linenos">72</span></a>            <span class="n">Subject</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">label</span><span class="p">(</span><span class="s2">&quot;subject_type&quot;</span><span class="p">),</span>
</span><span id="get_inspection_docs-73"><a href="#get_inspection_docs-73"><span class="linenos">73</span></a>            <span class="n">Teacher</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">label</span><span class="p">(</span><span class="s2">&quot;teacher_name&quot;</span><span class="p">),</span>
</span><span id="get_inspection_docs-74"><a href="#get_inspection_docs-74"><span class="linenos">74</span></a>            <span class="n">Teacher</span><span class="o">.</span><span class="n">surname</span><span class="o">.</span><span class="n">label</span><span class="p">(</span><span class="s2">&quot;teacher_surname&quot;</span><span class="p">),</span>
</span><span id="get_inspection_docs-75"><a href="#get_inspection_docs-75"><span class="linenos">75</span></a>            <span class="n">Teacher</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">label</span><span class="p">(</span><span class="s2">&quot;teacher_title&quot;</span><span class="p">),</span>
</span><span id="get_inspection_docs-76"><a href="#get_inspection_docs-76"><span class="linenos">76</span></a>        <span class="p">)</span>
</span><span id="get_inspection_docs-77"><a href="#get_inspection_docs-77"><span class="linenos">77</span></a>        <span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">Inspection</span><span class="p">,</span> <span class="n">Inspection</span><span class="o">.</span><span class="n">fk_inspectionReport</span> <span class="o">==</span> <span class="n">InspectionReport</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
</span><span id="get_inspection_docs-78"><a href="#get_inspection_docs-78"><span class="linenos">78</span></a>        <span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">Lesson</span><span class="p">,</span> <span class="n">Inspection</span><span class="o">.</span><span class="n">fk_lesson</span> <span class="o">==</span> <span class="n">Lesson</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
</span><span id="get_inspection_docs-79"><a href="#get_inspection_docs-79"><span class="linenos">79</span></a>        <span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">Subject</span><span class="p">,</span> <span class="n">Lesson</span><span class="o">.</span><span class="n">fk_subject</span> <span class="o">==</span> <span class="n">Subject</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
</span><span id="get_inspection_docs-80"><a href="#get_inspection_docs-80"><span class="linenos">80</span></a>        <span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">Teacher</span><span class="p">,</span> <span class="n">Lesson</span><span class="o">.</span><span class="n">fk_teacher</span> <span class="o">==</span> <span class="n">Teacher</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
</span><span id="get_inspection_docs-81"><a href="#get_inspection_docs-81"><span class="linenos">81</span></a>        <span class="o">.</span><span class="n">all</span><span class="p">()</span>
</span><span id="get_inspection_docs-82"><a href="#get_inspection_docs-82"><span class="linenos">82</span></a>    <span class="p">)</span>
</span><span id="get_inspection_docs-83"><a href="#get_inspection_docs-83"><span class="linenos">83</span></a>    <span class="n">result</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="get_inspection_docs-84"><a href="#get_inspection_docs-84"><span class="linenos">84</span></a>        <span class="p">{</span>
</span><span id="get_inspection_docs-85"><a href="#get_inspection_docs-85"><span class="linenos">85</span></a>            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="n">doc</span><span class="o">.</span><span class="n">document_id</span><span class="p">,</span>
</span><span id="get_inspection_docs-86"><a href="#get_inspection_docs-86"><span class="linenos">86</span></a>            <span class="s2">&quot;date&quot;</span><span class="p">:</span> <span class="n">doc</span><span class="o">.</span><span class="n">inspection_date</span><span class="p">,</span>
</span><span id="get_inspection_docs-87"><a href="#get_inspection_docs-87"><span class="linenos">87</span></a>            <span class="s2">&quot;subject&quot;</span><span class="p">:</span> <span class="n">doc</span><span class="o">.</span><span class="n">subject_name</span><span class="p">,</span>
</span><span id="get_inspection_docs-88"><a href="#get_inspection_docs-88"><span class="linenos">88</span></a>            <span class="s2">&quot;subject_type&quot;</span><span class="p">:</span> <span class="n">doc</span><span class="o">.</span><span class="n">subject_type</span><span class="p">,</span>
</span><span id="get_inspection_docs-89"><a href="#get_inspection_docs-89"><span class="linenos">89</span></a>            <span class="s2">&quot;teacher&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">doc</span><span class="o">.</span><span class="n">teacher_title</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">doc</span><span class="o">.</span><span class="n">teacher_name</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">doc</span><span class="o">.</span><span class="n">teacher_surname</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="get_inspection_docs-90"><a href="#get_inspection_docs-90"><span class="linenos">90</span></a>        <span class="p">}</span>
</span><span id="get_inspection_docs-91"><a href="#get_inspection_docs-91"><span class="linenos">91</span></a>        <span class="k">for</span> <span class="n">doc</span> <span class="ow">in</span> <span class="n">inspection_docs</span>
</span><span id="get_inspection_docs-92"><a href="#get_inspection_docs-92"><span class="linenos">92</span></a>    <span class="p">]</span>
</span><span id="get_inspection_docs-93"><a href="#get_inspection_docs-93"><span class="linenos">93</span></a>    <span class="k">return</span> <span class="n">result</span>
</span></pre></div>


            <div class="docstring"><p>Fetch inspection documents from the database.</p>

<p>This endpoint retrieves a list of inspection documents, including details such as
the inspection date, subject, and teacher information. Data is queried from the
database using SQLAlchemy and structured into a response-friendly format.</p>

<p>Args:
    db (sessionmaker): The database session dependency injected by FastAPI.</p>

<p>Returns:
    list[dict]: A list of dictionaries containing the following keys:
        - id (int): The ID of the inspection document.
        - date (datetime): The date of the inspection.
        - subject (str): The name of the subject.
        - teacher (str): The full name of the teacher, including title, first name, and surname.</p>

<p>Example Response:
    [
        {
            "id": 1,
            "date": "2025-01-01T10:00:00",
            "subject": "Mathematics",
            "teacher": "Dr. John Doe"
        },
        ...
    ]</p>
</div>


                </section>
                <section id="get_inspection_doc">
                            <input id="get_inspection_doc-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-app.get">@app.get(&#39;/inspection-docs/{docs_id}/&#39;, response_model=dict)</div>

        <span class="def">def</span>
        <span class="name">get_inspection_doc</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">docs_id</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">db</span><span class="p">:</span> <span class="n">sqlalchemy</span><span class="o">.</span><span class="n">orm</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">sessionmaker</span> <span class="o">=</span> <span class="n">Depends</span><span class="p">(</span><span class="n">get_db</span><span class="p">)</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="get_inspection_doc-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#get_inspection_doc"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="get_inspection_doc-96"><a href="#get_inspection_doc-96"><span class="linenos"> 96</span></a><span class="nd">@app</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;/inspection-docs/</span><span class="si">{docs_id}</span><span class="s2">/&quot;</span><span class="p">,</span> <span class="n">response_model</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
</span><span id="get_inspection_doc-97"><a href="#get_inspection_doc-97"><span class="linenos"> 97</span></a><span class="k">def</span><span class="w"> </span><span class="nf">get_inspection_doc</span><span class="p">(</span><span class="n">docs_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">db</span><span class="p">:</span> <span class="n">sessionmaker</span> <span class="o">=</span> <span class="n">Depends</span><span class="p">(</span><span class="n">get_db</span><span class="p">)):</span>
</span><span id="get_inspection_doc-98"><a href="#get_inspection_doc-98"><span class="linenos"> 98</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="get_inspection_doc-99"><a href="#get_inspection_doc-99"><span class="linenos"> 99</span></a><span class="sd">    Fetch a specific inspection document by its ID.</span>
</span><span id="get_inspection_doc-100"><a href="#get_inspection_doc-100"><span class="linenos">100</span></a>
</span><span id="get_inspection_doc-101"><a href="#get_inspection_doc-101"><span class="linenos">101</span></a><span class="sd">    This endpoint retrieves detailed information about a specific inspection document,</span>
</span><span id="get_inspection_doc-102"><a href="#get_inspection_doc-102"><span class="linenos">102</span></a><span class="sd">    including teacher, subject, inspection team, and report ratings.</span>
</span><span id="get_inspection_doc-103"><a href="#get_inspection_doc-103"><span class="linenos">103</span></a>
</span><span id="get_inspection_doc-104"><a href="#get_inspection_doc-104"><span class="linenos">104</span></a><span class="sd">    Args:</span>
</span><span id="get_inspection_doc-105"><a href="#get_inspection_doc-105"><span class="linenos">105</span></a><span class="sd">        docs_id (int): The unique identifier of the inspection document.</span>
</span><span id="get_inspection_doc-106"><a href="#get_inspection_doc-106"><span class="linenos">106</span></a><span class="sd">        db (sessionmaker): The database session dependency injected by FastAPI.</span>
</span><span id="get_inspection_doc-107"><a href="#get_inspection_doc-107"><span class="linenos">107</span></a>
</span><span id="get_inspection_doc-108"><a href="#get_inspection_doc-108"><span class="linenos">108</span></a><span class="sd">    Raises:</span>
</span><span id="get_inspection_doc-109"><a href="#get_inspection_doc-109"><span class="linenos">109</span></a><span class="sd">        HTTPException: If the inspection document with the given ID is not found.</span>
</span><span id="get_inspection_doc-110"><a href="#get_inspection_doc-110"><span class="linenos">110</span></a>
</span><span id="get_inspection_doc-111"><a href="#get_inspection_doc-111"><span class="linenos">111</span></a><span class="sd">    Returns:</span>
</span><span id="get_inspection_doc-112"><a href="#get_inspection_doc-112"><span class="linenos">112</span></a><span class="sd">        dict: A dictionary containing the inspection document details:</span>
</span><span id="get_inspection_doc-113"><a href="#get_inspection_doc-113"><span class="linenos">113</span></a><span class="sd">            - inspected_name (str): Full name (with title) of the inspected teacher.</span>
</span><span id="get_inspection_doc-114"><a href="#get_inspection_doc-114"><span class="linenos">114</span></a><span class="sd">            - department_name (str): Department of the inspected teacher.</span>
</span><span id="get_inspection_doc-115"><a href="#get_inspection_doc-115"><span class="linenos">115</span></a><span class="sd">            - date_of_inspection (datetime): Date and time of the inspection.</span>
</span><span id="get_inspection_doc-116"><a href="#get_inspection_doc-116"><span class="linenos">116</span></a><span class="sd">            - subject_name (str): Name of the subject inspected.</span>
</span><span id="get_inspection_doc-117"><a href="#get_inspection_doc-117"><span class="linenos">117</span></a><span class="sd">            - subject_code (int): Code/ID of the subject inspected.</span>
</span><span id="get_inspection_doc-118"><a href="#get_inspection_doc-118"><span class="linenos">118</span></a><span class="sd">            - inspectors (list[dict]): List of inspectors, with:</span>
</span><span id="get_inspection_doc-119"><a href="#get_inspection_doc-119"><span class="linenos">119</span></a><span class="sd">                - name (str): Inspector&#39;s name.</span>
</span><span id="get_inspection_doc-120"><a href="#get_inspection_doc-120"><span class="linenos">120</span></a><span class="sd">                - surname (str): Inspector&#39;s surname.</span>
</span><span id="get_inspection_doc-121"><a href="#get_inspection_doc-121"><span class="linenos">121</span></a><span class="sd">                - title (str): Inspector&#39;s title.</span>
</span><span id="get_inspection_doc-122"><a href="#get_inspection_doc-122"><span class="linenos">122</span></a><span class="sd">            - lateness_minutes (int): Lateness duration in minutes, if any.</span>
</span><span id="get_inspection_doc-123"><a href="#get_inspection_doc-123"><span class="linenos">123</span></a><span class="sd">            - student_attendance (int): Number of students present during inspection.</span>
</span><span id="get_inspection_doc-124"><a href="#get_inspection_doc-124"><span class="linenos">124</span></a><span class="sd">            - room_adaptation (bool): Whether the room was adapted for the lesson.</span>
</span><span id="get_inspection_doc-125"><a href="#get_inspection_doc-125"><span class="linenos">125</span></a><span class="sd">            - content_compatibility (bool): Whether content was compatible with objectives.</span>
</span><span id="get_inspection_doc-126"><a href="#get_inspection_doc-126"><span class="linenos">126</span></a><span class="sd">            - substantive_rating (float): Rating for the substantive content.</span>
</span><span id="get_inspection_doc-127"><a href="#get_inspection_doc-127"><span class="linenos">127</span></a><span class="sd">            - final_rating (float): Final rating of the inspection.</span>
</span><span id="get_inspection_doc-128"><a href="#get_inspection_doc-128"><span class="linenos">128</span></a><span class="sd">            - objection (str | None): Any objections noted in the report.</span>
</span><span id="get_inspection_doc-129"><a href="#get_inspection_doc-129"><span class="linenos">129</span></a>
</span><span id="get_inspection_doc-130"><a href="#get_inspection_doc-130"><span class="linenos">130</span></a><span class="sd">    Example Response:</span>
</span><span id="get_inspection_doc-131"><a href="#get_inspection_doc-131"><span class="linenos">131</span></a><span class="sd">        {</span>
</span><span id="get_inspection_doc-132"><a href="#get_inspection_doc-132"><span class="linenos">132</span></a><span class="sd">            &quot;inspected_name&quot;: &quot;Dr. Jane Doe&quot;,</span>
</span><span id="get_inspection_doc-133"><a href="#get_inspection_doc-133"><span class="linenos">133</span></a><span class="sd">            &quot;department_name&quot;: &quot;Mathematics&quot;,</span>
</span><span id="get_inspection_doc-134"><a href="#get_inspection_doc-134"><span class="linenos">134</span></a><span class="sd">            &quot;date_of_inspection&quot;: &quot;2025-01-01T10:00:00&quot;,</span>
</span><span id="get_inspection_doc-135"><a href="#get_inspection_doc-135"><span class="linenos">135</span></a><span class="sd">            &quot;subject_name&quot;: &quot;Calculus&quot;,</span>
</span><span id="get_inspection_doc-136"><a href="#get_inspection_doc-136"><span class="linenos">136</span></a><span class="sd">            &quot;subject_code&quot;: 101,</span>
</span><span id="get_inspection_doc-137"><a href="#get_inspection_doc-137"><span class="linenos">137</span></a><span class="sd">            &quot;inspectors&quot;: [</span>
</span><span id="get_inspection_doc-138"><a href="#get_inspection_doc-138"><span class="linenos">138</span></a><span class="sd">                {&quot;name&quot;: &quot;John&quot;, &quot;surname&quot;:&quot;Smith&quot; , &quot;title&quot;: &quot;SeniorMr.&quot;}</span>
</span><span id="get_inspection_doc-139"><a href="#get_inspection_doc-139"><span class="linenos">139</span></a><span class="sd">            ],</span>
</span><span id="get_inspection_doc-140"><a href="#get_inspection_doc-140"><span class="linenos">140</span></a><span class="sd">            &quot;lateness_minutes&quot;: 0,</span>
</span><span id="get_inspection_doc-141"><a href="#get_inspection_doc-141"><span class="linenos">141</span></a><span class="sd">            &quot;student_attendance&quot;: 25,</span>
</span><span id="get_inspection_doc-142"><a href="#get_inspection_doc-142"><span class="linenos">142</span></a><span class="sd">            &quot;room_adaptation&quot;: true,</span>
</span><span id="get_inspection_doc-143"><a href="#get_inspection_doc-143"><span class="linenos">143</span></a><span class="sd">            &quot;content_compatibility&quot;: true,</span>
</span><span id="get_inspection_doc-144"><a href="#get_inspection_doc-144"><span class="linenos">144</span></a><span class="sd">            &quot;substantive_rating&quot;: 4.5,</span>
</span><span id="get_inspection_doc-145"><a href="#get_inspection_doc-145"><span class="linenos">145</span></a><span class="sd">            &quot;final_rating&quot;: 4.8,</span>
</span><span id="get_inspection_doc-146"><a href="#get_inspection_doc-146"><span class="linenos">146</span></a><span class="sd">            &quot;objection&quot;: None</span>
</span><span id="get_inspection_doc-147"><a href="#get_inspection_doc-147"><span class="linenos">147</span></a><span class="sd">        }</span>
</span><span id="get_inspection_doc-148"><a href="#get_inspection_doc-148"><span class="linenos">148</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="get_inspection_doc-149"><a href="#get_inspection_doc-149"><span class="linenos">149</span></a>
</span><span id="get_inspection_doc-150"><a href="#get_inspection_doc-150"><span class="linenos">150</span></a>    <span class="n">teacher_alias_1</span> <span class="o">=</span> <span class="n">aliased</span><span class="p">(</span><span class="n">Teacher</span><span class="p">)</span>
</span><span id="get_inspection_doc-151"><a href="#get_inspection_doc-151"><span class="linenos">151</span></a>    <span class="n">teacher_alias_2</span> <span class="o">=</span> <span class="n">aliased</span><span class="p">(</span><span class="n">Teacher</span><span class="p">)</span>
</span><span id="get_inspection_doc-152"><a href="#get_inspection_doc-152"><span class="linenos">152</span></a>    <span class="n">inspection</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="get_inspection_doc-153"><a href="#get_inspection_doc-153"><span class="linenos">153</span></a>        <span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">Inspection</span><span class="p">)</span>
</span><span id="get_inspection_doc-154"><a href="#get_inspection_doc-154"><span class="linenos">154</span></a>        <span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">Lesson</span><span class="p">,</span> <span class="n">Lesson</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">Inspection</span><span class="o">.</span><span class="n">fk_lesson</span><span class="p">)</span>
</span><span id="get_inspection_doc-155"><a href="#get_inspection_doc-155"><span class="linenos">155</span></a>        <span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">Subject</span><span class="p">,</span> <span class="n">Subject</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">Lesson</span><span class="o">.</span><span class="n">fk_subject</span><span class="p">)</span>
</span><span id="get_inspection_doc-156"><a href="#get_inspection_doc-156"><span class="linenos">156</span></a>        <span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">teacher_alias_1</span><span class="p">,</span> <span class="n">teacher_alias_1</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">Lesson</span><span class="o">.</span><span class="n">fk_teacher</span><span class="p">)</span>
</span><span id="get_inspection_doc-157"><a href="#get_inspection_doc-157"><span class="linenos">157</span></a>        <span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">InspectionReport</span><span class="p">,</span> <span class="n">InspectionReport</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">Inspection</span><span class="o">.</span><span class="n">fk_inspectionReport</span><span class="p">)</span>
</span><span id="get_inspection_doc-158"><a href="#get_inspection_doc-158"><span class="linenos">158</span></a>        <span class="o">.</span><span class="n">outerjoin</span><span class="p">(</span><span class="n">InspectionTeam</span><span class="p">,</span> <span class="n">InspectionTeam</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">Inspection</span><span class="o">.</span><span class="n">fk_inspectionTeam</span><span class="p">)</span>
</span><span id="get_inspection_doc-159"><a href="#get_inspection_doc-159"><span class="linenos">159</span></a>        <span class="o">.</span><span class="n">outerjoin</span><span class="p">(</span>
</span><span id="get_inspection_doc-160"><a href="#get_inspection_doc-160"><span class="linenos">160</span></a>            <span class="n">TeacherInspectionTeam</span><span class="p">,</span>
</span><span id="get_inspection_doc-161"><a href="#get_inspection_doc-161"><span class="linenos">161</span></a>            <span class="n">TeacherInspectionTeam</span><span class="o">.</span><span class="n">fk_inspectionTeam</span> <span class="o">==</span> <span class="n">InspectionTeam</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
</span><span id="get_inspection_doc-162"><a href="#get_inspection_doc-162"><span class="linenos">162</span></a>        <span class="p">)</span>
</span><span id="get_inspection_doc-163"><a href="#get_inspection_doc-163"><span class="linenos">163</span></a>        <span class="o">.</span><span class="n">outerjoin</span><span class="p">(</span>
</span><span id="get_inspection_doc-164"><a href="#get_inspection_doc-164"><span class="linenos">164</span></a>            <span class="n">teacher_alias_2</span><span class="p">,</span> <span class="n">teacher_alias_2</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">TeacherInspectionTeam</span><span class="o">.</span><span class="n">fk_teacher</span>
</span><span id="get_inspection_doc-165"><a href="#get_inspection_doc-165"><span class="linenos">165</span></a>        <span class="p">)</span>
</span><span id="get_inspection_doc-166"><a href="#get_inspection_doc-166"><span class="linenos">166</span></a>        <span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">Inspection</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">docs_id</span><span class="p">)</span>
</span><span id="get_inspection_doc-167"><a href="#get_inspection_doc-167"><span class="linenos">167</span></a>        <span class="o">.</span><span class="n">first</span><span class="p">()</span>
</span><span id="get_inspection_doc-168"><a href="#get_inspection_doc-168"><span class="linenos">168</span></a>    <span class="p">)</span>
</span><span id="get_inspection_doc-169"><a href="#get_inspection_doc-169"><span class="linenos">169</span></a>
</span><span id="get_inspection_doc-170"><a href="#get_inspection_doc-170"><span class="linenos">170</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">inspection</span><span class="p">:</span>
</span><span id="get_inspection_doc-171"><a href="#get_inspection_doc-171"><span class="linenos">171</span></a>        <span class="k">raise</span> <span class="n">HTTPException</span><span class="p">(</span><span class="n">status_code</span><span class="o">=</span><span class="mi">404</span><span class="p">,</span> <span class="n">detail</span><span class="o">=</span><span class="s2">&quot;Inspection document not found&quot;</span><span class="p">)</span>
</span><span id="get_inspection_doc-172"><a href="#get_inspection_doc-172"><span class="linenos">172</span></a>
</span><span id="get_inspection_doc-173"><a href="#get_inspection_doc-173"><span class="linenos">173</span></a>    <span class="n">inspection_details</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="get_inspection_doc-174"><a href="#get_inspection_doc-174"><span class="linenos">174</span></a>        <span class="s2">&quot;inspected_name&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">inspection</span><span class="o">.</span><span class="n">lesson</span><span class="o">.</span><span class="n">teacher</span><span class="o">.</span><span class="n">title</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">inspection</span><span class="o">.</span><span class="n">lesson</span><span class="o">.</span><span class="n">teacher</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="get_inspection_doc-175"><a href="#get_inspection_doc-175"><span class="linenos">175</span></a>        <span class="s2">&quot;department_name&quot;</span><span class="p">:</span> <span class="n">inspection</span><span class="o">.</span><span class="n">lesson</span><span class="o">.</span><span class="n">teacher</span><span class="o">.</span><span class="n">department</span><span class="p">,</span>
</span><span id="get_inspection_doc-176"><a href="#get_inspection_doc-176"><span class="linenos">176</span></a>        <span class="s2">&quot;date_of_inspection&quot;</span><span class="p">:</span> <span class="n">inspection</span><span class="o">.</span><span class="n">lesson</span><span class="o">.</span><span class="n">time</span><span class="p">,</span>
</span><span id="get_inspection_doc-177"><a href="#get_inspection_doc-177"><span class="linenos">177</span></a>        <span class="s2">&quot;subject_name&quot;</span><span class="p">:</span> <span class="n">inspection</span><span class="o">.</span><span class="n">lesson</span><span class="o">.</span><span class="n">subject</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="get_inspection_doc-178"><a href="#get_inspection_doc-178"><span class="linenos">178</span></a>        <span class="s2">&quot;subject_code&quot;</span><span class="p">:</span> <span class="n">inspection</span><span class="o">.</span><span class="n">lesson</span><span class="o">.</span><span class="n">subject</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
</span><span id="get_inspection_doc-179"><a href="#get_inspection_doc-179"><span class="linenos">179</span></a>        <span class="s2">&quot;inspectors&quot;</span><span class="p">:</span> <span class="p">(</span>
</span><span id="get_inspection_doc-180"><a href="#get_inspection_doc-180"><span class="linenos">180</span></a>            <span class="p">[</span>
</span><span id="get_inspection_doc-181"><a href="#get_inspection_doc-181"><span class="linenos">181</span></a>                <span class="p">{</span>
</span><span id="get_inspection_doc-182"><a href="#get_inspection_doc-182"><span class="linenos">182</span></a>                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">inspector</span><span class="o">.</span><span class="n">teacher</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="get_inspection_doc-183"><a href="#get_inspection_doc-183"><span class="linenos">183</span></a>                    <span class="s2">&quot;surname&quot;</span><span class="p">:</span> <span class="n">inspector</span><span class="o">.</span><span class="n">teacher</span><span class="o">.</span><span class="n">surname</span><span class="p">,</span>
</span><span id="get_inspection_doc-184"><a href="#get_inspection_doc-184"><span class="linenos">184</span></a>                    <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="n">inspector</span><span class="o">.</span><span class="n">teacher</span><span class="o">.</span><span class="n">title</span><span class="p">,</span>
</span><span id="get_inspection_doc-185"><a href="#get_inspection_doc-185"><span class="linenos">185</span></a>                <span class="p">}</span>
</span><span id="get_inspection_doc-186"><a href="#get_inspection_doc-186"><span class="linenos">186</span></a>                <span class="k">for</span> <span class="n">inspector</span> <span class="ow">in</span> <span class="n">inspection</span><span class="o">.</span><span class="n">inspection_team</span><span class="o">.</span><span class="n">teachers</span>
</span><span id="get_inspection_doc-187"><a href="#get_inspection_doc-187"><span class="linenos">187</span></a>                <span class="k">if</span> <span class="n">inspector</span><span class="o">.</span><span class="n">teacher</span>
</span><span id="get_inspection_doc-188"><a href="#get_inspection_doc-188"><span class="linenos">188</span></a>            <span class="p">]</span>
</span><span id="get_inspection_doc-189"><a href="#get_inspection_doc-189"><span class="linenos">189</span></a>            <span class="k">if</span> <span class="n">inspection</span><span class="o">.</span><span class="n">inspection_team</span>
</span><span id="get_inspection_doc-190"><a href="#get_inspection_doc-190"><span class="linenos">190</span></a>            <span class="k">else</span> <span class="p">[]</span>
</span><span id="get_inspection_doc-191"><a href="#get_inspection_doc-191"><span class="linenos">191</span></a>        <span class="p">),</span>
</span><span id="get_inspection_doc-192"><a href="#get_inspection_doc-192"><span class="linenos">192</span></a>        <span class="s2">&quot;lateness_minutes&quot;</span><span class="p">:</span> <span class="p">(</span>
</span><span id="get_inspection_doc-193"><a href="#get_inspection_doc-193"><span class="linenos">193</span></a>            <span class="n">inspection</span><span class="o">.</span><span class="n">inspection_report</span><span class="o">.</span><span class="n">lateness_minutes</span>
</span><span id="get_inspection_doc-194"><a href="#get_inspection_doc-194"><span class="linenos">194</span></a>            <span class="k">if</span> <span class="n">inspection</span><span class="o">.</span><span class="n">inspection_report</span><span class="o">.</span><span class="n">lateness_minutes</span>
</span><span id="get_inspection_doc-195"><a href="#get_inspection_doc-195"><span class="linenos">195</span></a>            <span class="k">else</span> <span class="mi">0</span>
</span><span id="get_inspection_doc-196"><a href="#get_inspection_doc-196"><span class="linenos">196</span></a>        <span class="p">),</span>
</span><span id="get_inspection_doc-197"><a href="#get_inspection_doc-197"><span class="linenos">197</span></a>        <span class="s2">&quot;student_attendance&quot;</span><span class="p">:</span> <span class="n">inspection</span><span class="o">.</span><span class="n">inspection_report</span><span class="o">.</span><span class="n">students_attendance</span><span class="p">,</span>
</span><span id="get_inspection_doc-198"><a href="#get_inspection_doc-198"><span class="linenos">198</span></a>        <span class="s2">&quot;room_adaptation&quot;</span><span class="p">:</span> <span class="n">inspection</span><span class="o">.</span><span class="n">inspection_report</span><span class="o">.</span><span class="n">room_adaptation</span><span class="p">,</span>
</span><span id="get_inspection_doc-199"><a href="#get_inspection_doc-199"><span class="linenos">199</span></a>        <span class="s2">&quot;content_compatibility&quot;</span><span class="p">:</span> <span class="n">inspection</span><span class="o">.</span><span class="n">inspection_report</span><span class="o">.</span><span class="n">content_compatibility</span><span class="p">,</span>
</span><span id="get_inspection_doc-200"><a href="#get_inspection_doc-200"><span class="linenos">200</span></a>        <span class="s2">&quot;substantive_rating&quot;</span><span class="p">:</span> <span class="n">inspection</span><span class="o">.</span><span class="n">inspection_report</span><span class="o">.</span><span class="n">substantive_rating</span><span class="p">,</span>
</span><span id="get_inspection_doc-201"><a href="#get_inspection_doc-201"><span class="linenos">201</span></a>        <span class="s2">&quot;final_rating&quot;</span><span class="p">:</span> <span class="n">inspection</span><span class="o">.</span><span class="n">inspection_report</span><span class="o">.</span><span class="n">final_rating</span><span class="p">,</span>
</span><span id="get_inspection_doc-202"><a href="#get_inspection_doc-202"><span class="linenos">202</span></a>        <span class="s2">&quot;objection&quot;</span><span class="p">:</span> <span class="n">inspection</span><span class="o">.</span><span class="n">inspection_report</span><span class="o">.</span><span class="n">objection</span><span class="p">,</span>
</span><span id="get_inspection_doc-203"><a href="#get_inspection_doc-203"><span class="linenos">203</span></a>    <span class="p">}</span>
</span><span id="get_inspection_doc-204"><a href="#get_inspection_doc-204"><span class="linenos">204</span></a>
</span><span id="get_inspection_doc-205"><a href="#get_inspection_doc-205"><span class="linenos">205</span></a>    <span class="k">return</span> <span class="n">inspection_details</span>
</span></pre></div>


            <div class="docstring"><p>Fetch a specific inspection document by its ID.</p>

<p>This endpoint retrieves detailed information about a specific inspection document,
including teacher, subject, inspection team, and report ratings.</p>

<p>Args:
    docs_id (int): The unique identifier of the inspection document.
    db (sessionmaker): The database session dependency injected by FastAPI.</p>

<p>Raises:
    HTTPException: If the inspection document with the given ID is not found.</p>

<p>Returns:
    dict: A dictionary containing the inspection document details:
        - inspected_name (str): Full name (with title) of the inspected teacher.
        - department_name (str): Department of the inspected teacher.
        - date_of_inspection (datetime): Date and time of the inspection.
        - subject_name (str): Name of the subject inspected.
        - subject_code (int): Code/ID of the subject inspected.
        - inspectors (list[dict]): List of inspectors, with:
            - name (str): Inspector's name.
            - surname (str): Inspector's surname.
            - title (str): Inspector's title.
        - lateness_minutes (int): Lateness duration in minutes, if any.
        - student_attendance (int): Number of students present during inspection.
        - room_adaptation (bool): Whether the room was adapted for the lesson.
        - content_compatibility (bool): Whether content was compatible with objectives.
        - substantive_rating (float): Rating for the substantive content.
        - final_rating (float): Final rating of the inspection.
        - objection (str | None): Any objections noted in the report.</p>

<p>Example Response:
    {
        "inspected_name": "Dr. Jane Doe",
        "department_name": "Mathematics",
        "date_of_inspection": "2025-01-01T10:00:00",
        "subject_name": "Calculus",
        "subject_code": 101,
        "inspectors": [
            {"name": "John", "surname":"Smith" , "title": "SeniorMr."}
        ],
        "lateness_minutes": 0,
        "student_attendance": 25,
        "room_adaptation": true,
        "content_compatibility": true,
        "substantive_rating": 4.5,
        "final_rating": 4.8,
        "objection": None
    }</p>
</div>


                </section>
                <section id="edit_inspection_report">
                            <input id="edit_inspection_report-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-app.post">@app.post(&#39;/inspection-docs/{docs_id}/edit/&#39;)</div>

        <span class="def">def</span>
        <span class="name">edit_inspection_report</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">docs_id</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">updated_data</span><span class="p">:</span> <span class="n"><a href="models_pydantic.html#EditInspectionReport">Model.models_pydantic.EditInspectionReport</a></span>,</span><span class="param">	<span class="n">db</span><span class="p">:</span> <span class="n">sqlalchemy</span><span class="o">.</span><span class="n">orm</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">sessionmaker</span> <span class="o">=</span> <span class="n">Depends</span><span class="p">(</span><span class="n">get_db</span><span class="p">)</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="edit_inspection_report-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#edit_inspection_report"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="edit_inspection_report-208"><a href="#edit_inspection_report-208"><span class="linenos">208</span></a><span class="nd">@app</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="s2">&quot;/inspection-docs/</span><span class="si">{docs_id}</span><span class="s2">/edit/&quot;</span><span class="p">)</span>
</span><span id="edit_inspection_report-209"><a href="#edit_inspection_report-209"><span class="linenos">209</span></a><span class="k">def</span><span class="w"> </span><span class="nf">edit_inspection_report</span><span class="p">(</span>
</span><span id="edit_inspection_report-210"><a href="#edit_inspection_report-210"><span class="linenos">210</span></a>    <span class="n">docs_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">updated_data</span><span class="p">:</span> <span class="n">EditInspectionReport</span><span class="p">,</span> <span class="n">db</span><span class="p">:</span> <span class="n">sessionmaker</span> <span class="o">=</span> <span class="n">Depends</span><span class="p">(</span><span class="n">get_db</span><span class="p">)</span>
</span><span id="edit_inspection_report-211"><a href="#edit_inspection_report-211"><span class="linenos">211</span></a><span class="p">):</span>
</span><span id="edit_inspection_report-212"><a href="#edit_inspection_report-212"><span class="linenos">212</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="edit_inspection_report-213"><a href="#edit_inspection_report-213"><span class="linenos">213</span></a><span class="sd">    Edit an existing inspection report.</span>
</span><span id="edit_inspection_report-214"><a href="#edit_inspection_report-214"><span class="linenos">214</span></a>
</span><span id="edit_inspection_report-215"><a href="#edit_inspection_report-215"><span class="linenos">215</span></a><span class="sd">    This endpoint allows updating specific fields of an inspection report identified by its ID.</span>
</span><span id="edit_inspection_report-216"><a href="#edit_inspection_report-216"><span class="linenos">216</span></a><span class="sd">    Partial updates are supported, and only the provided fields in the request body will be updated.</span>
</span><span id="edit_inspection_report-217"><a href="#edit_inspection_report-217"><span class="linenos">217</span></a>
</span><span id="edit_inspection_report-218"><a href="#edit_inspection_report-218"><span class="linenos">218</span></a><span class="sd">    Args:</span>
</span><span id="edit_inspection_report-219"><a href="#edit_inspection_report-219"><span class="linenos">219</span></a><span class="sd">        docs_id (int): The unique identifier of the inspection document.</span>
</span><span id="edit_inspection_report-220"><a href="#edit_inspection_report-220"><span class="linenos">220</span></a><span class="sd">        updated_data (EditInspectionReport): Data model containing the fields to update.</span>
</span><span id="edit_inspection_report-221"><a href="#edit_inspection_report-221"><span class="linenos">221</span></a><span class="sd">        db (sessionmaker): The database session dependency injected by FastAPI.</span>
</span><span id="edit_inspection_report-222"><a href="#edit_inspection_report-222"><span class="linenos">222</span></a>
</span><span id="edit_inspection_report-223"><a href="#edit_inspection_report-223"><span class="linenos">223</span></a><span class="sd">    Raises:</span>
</span><span id="edit_inspection_report-224"><a href="#edit_inspection_report-224"><span class="linenos">224</span></a><span class="sd">        HTTPException: If the inspection or its associated report is not found.</span>
</span><span id="edit_inspection_report-225"><a href="#edit_inspection_report-225"><span class="linenos">225</span></a>
</span><span id="edit_inspection_report-226"><a href="#edit_inspection_report-226"><span class="linenos">226</span></a><span class="sd">    Returns:</span>
</span><span id="edit_inspection_report-227"><a href="#edit_inspection_report-227"><span class="linenos">227</span></a><span class="sd">        dict: A success message indicating the report was updated.</span>
</span><span id="edit_inspection_report-228"><a href="#edit_inspection_report-228"><span class="linenos">228</span></a>
</span><span id="edit_inspection_report-229"><a href="#edit_inspection_report-229"><span class="linenos">229</span></a><span class="sd">    Example Request Body (JSON):</span>
</span><span id="edit_inspection_report-230"><a href="#edit_inspection_report-230"><span class="linenos">230</span></a><span class="sd">        {</span>
</span><span id="edit_inspection_report-231"><a href="#edit_inspection_report-231"><span class="linenos">231</span></a><span class="sd">            &quot;lateness_minutes&quot;: 5,</span>
</span><span id="edit_inspection_report-232"><a href="#edit_inspection_report-232"><span class="linenos">232</span></a><span class="sd">            &quot;student_attendance&quot;: 20,</span>
</span><span id="edit_inspection_report-233"><a href="#edit_inspection_report-233"><span class="linenos">233</span></a><span class="sd">            &quot;final_rating&quot;: 4.7</span>
</span><span id="edit_inspection_report-234"><a href="#edit_inspection_report-234"><span class="linenos">234</span></a><span class="sd">        }</span>
</span><span id="edit_inspection_report-235"><a href="#edit_inspection_report-235"><span class="linenos">235</span></a>
</span><span id="edit_inspection_report-236"><a href="#edit_inspection_report-236"><span class="linenos">236</span></a><span class="sd">    Example Response:</span>
</span><span id="edit_inspection_report-237"><a href="#edit_inspection_report-237"><span class="linenos">237</span></a><span class="sd">        {</span>
</span><span id="edit_inspection_report-238"><a href="#edit_inspection_report-238"><span class="linenos">238</span></a><span class="sd">            &quot;message&quot;: &quot;Inspection report updated successfully&quot;</span>
</span><span id="edit_inspection_report-239"><a href="#edit_inspection_report-239"><span class="linenos">239</span></a><span class="sd">        }</span>
</span><span id="edit_inspection_report-240"><a href="#edit_inspection_report-240"><span class="linenos">240</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="edit_inspection_report-241"><a href="#edit_inspection_report-241"><span class="linenos">241</span></a>
</span><span id="edit_inspection_report-242"><a href="#edit_inspection_report-242"><span class="linenos">242</span></a>    <span class="n">inspection</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="edit_inspection_report-243"><a href="#edit_inspection_report-243"><span class="linenos">243</span></a>        <span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">Inspection</span><span class="p">)</span>
</span><span id="edit_inspection_report-244"><a href="#edit_inspection_report-244"><span class="linenos">244</span></a>        <span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">InspectionReport</span><span class="p">,</span> <span class="n">InspectionReport</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">Inspection</span><span class="o">.</span><span class="n">fk_inspectionReport</span><span class="p">)</span>
</span><span id="edit_inspection_report-245"><a href="#edit_inspection_report-245"><span class="linenos">245</span></a>        <span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">Inspection</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">docs_id</span><span class="p">)</span>
</span><span id="edit_inspection_report-246"><a href="#edit_inspection_report-246"><span class="linenos">246</span></a>        <span class="o">.</span><span class="n">first</span><span class="p">()</span>
</span><span id="edit_inspection_report-247"><a href="#edit_inspection_report-247"><span class="linenos">247</span></a>    <span class="p">)</span>
</span><span id="edit_inspection_report-248"><a href="#edit_inspection_report-248"><span class="linenos">248</span></a>
</span><span id="edit_inspection_report-249"><a href="#edit_inspection_report-249"><span class="linenos">249</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">inspection</span><span class="p">:</span>
</span><span id="edit_inspection_report-250"><a href="#edit_inspection_report-250"><span class="linenos">250</span></a>        <span class="k">raise</span> <span class="n">HTTPException</span><span class="p">(</span><span class="n">status_code</span><span class="o">=</span><span class="mi">404</span><span class="p">,</span> <span class="n">detail</span><span class="o">=</span><span class="s2">&quot;Inspection report not found&quot;</span><span class="p">)</span>
</span><span id="edit_inspection_report-251"><a href="#edit_inspection_report-251"><span class="linenos">251</span></a>
</span><span id="edit_inspection_report-252"><a href="#edit_inspection_report-252"><span class="linenos">252</span></a>    <span class="n">inspection_report</span> <span class="o">=</span> <span class="n">inspection</span><span class="o">.</span><span class="n">inspection_report</span>
</span><span id="edit_inspection_report-253"><a href="#edit_inspection_report-253"><span class="linenos">253</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">inspection_report</span><span class="p">:</span>
</span><span id="edit_inspection_report-254"><a href="#edit_inspection_report-254"><span class="linenos">254</span></a>        <span class="k">raise</span> <span class="n">HTTPException</span><span class="p">(</span><span class="n">status_code</span><span class="o">=</span><span class="mi">404</span><span class="p">,</span> <span class="n">detail</span><span class="o">=</span><span class="s2">&quot;Inspection report not found&quot;</span><span class="p">)</span>
</span><span id="edit_inspection_report-255"><a href="#edit_inspection_report-255"><span class="linenos">255</span></a>
</span><span id="edit_inspection_report-256"><a href="#edit_inspection_report-256"><span class="linenos">256</span></a>    <span class="n">update_fields</span> <span class="o">=</span> <span class="n">updated_data</span><span class="o">.</span><span class="n">dict</span><span class="p">(</span><span class="n">exclude_unset</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="edit_inspection_report-257"><a href="#edit_inspection_report-257"><span class="linenos">257</span></a>    <span class="k">for</span> <span class="n">field</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">update_fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="edit_inspection_report-258"><a href="#edit_inspection_report-258"><span class="linenos">258</span></a>        <span class="nb">setattr</span><span class="p">(</span><span class="n">inspection_report</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</span><span id="edit_inspection_report-259"><a href="#edit_inspection_report-259"><span class="linenos">259</span></a>
</span><span id="edit_inspection_report-260"><a href="#edit_inspection_report-260"><span class="linenos">260</span></a>    <span class="n">db</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="edit_inspection_report-261"><a href="#edit_inspection_report-261"><span class="linenos">261</span></a>
</span><span id="edit_inspection_report-262"><a href="#edit_inspection_report-262"><span class="linenos">262</span></a>    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;Inspection report updated successfully&quot;</span><span class="p">}</span>
</span></pre></div>


            <div class="docstring"><p>Edit an existing inspection report.</p>

<p>This endpoint allows updating specific fields of an inspection report identified by its ID.
Partial updates are supported, and only the provided fields in the request body will be updated.</p>

<p>Args:
    docs_id (int): The unique identifier of the inspection document.
    updated_data (EditInspectionReport): Data model containing the fields to update.
    db (sessionmaker): The database session dependency injected by FastAPI.</p>

<p>Raises:
    HTTPException: If the inspection or its associated report is not found.</p>

<p>Returns:
    dict: A success message indicating the report was updated.</p>

<p>Example Request Body (JSON):
    {
        "lateness_minutes": 5,
        "student_attendance": 20,
        "final_rating": 4.7
    }</p>

<p>Example Response:
    {
        "message": "Inspection report updated successfully"
    }</p>
</div>


                </section>
                <section id="get_inspection_term">
                            <input id="get_inspection_term-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-app.get">@app.get(&#39;/inspection-term/{term_id}/&#39;)</div>

        <span class="def">def</span>
        <span class="name">get_inspection_term</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">term_id</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">db</span><span class="p">:</span> <span class="n">sqlalchemy</span><span class="o">.</span><span class="n">orm</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">sessionmaker</span> <span class="o">=</span> <span class="n">Depends</span><span class="p">(</span><span class="n">get_db</span><span class="p">)</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="get_inspection_term-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#get_inspection_term"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="get_inspection_term-265"><a href="#get_inspection_term-265"><span class="linenos">265</span></a><span class="nd">@app</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;/inspection-term/</span><span class="si">{term_id}</span><span class="s2">/&quot;</span><span class="p">)</span>
</span><span id="get_inspection_term-266"><a href="#get_inspection_term-266"><span class="linenos">266</span></a><span class="k">def</span><span class="w"> </span><span class="nf">get_inspection_term</span><span class="p">(</span><span class="n">term_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">db</span><span class="p">:</span> <span class="n">sessionmaker</span> <span class="o">=</span> <span class="n">Depends</span><span class="p">(</span><span class="n">get_db</span><span class="p">)):</span>
</span><span id="get_inspection_term-267"><a href="#get_inspection_term-267"><span class="linenos">267</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="get_inspection_term-268"><a href="#get_inspection_term-268"><span class="linenos">268</span></a><span class="sd">    Fetch details of an inspection term by its ID.</span>
</span><span id="get_inspection_term-269"><a href="#get_inspection_term-269"><span class="linenos">269</span></a>
</span><span id="get_inspection_term-270"><a href="#get_inspection_term-270"><span class="linenos">270</span></a><span class="sd">    This endpoint retrieves information about a specific inspection term, including details</span>
</span><span id="get_inspection_term-271"><a href="#get_inspection_term-271"><span class="linenos">271</span></a><span class="sd">    about the lesson, subject, and teacher.</span>
</span><span id="get_inspection_term-272"><a href="#get_inspection_term-272"><span class="linenos">272</span></a>
</span><span id="get_inspection_term-273"><a href="#get_inspection_term-273"><span class="linenos">273</span></a><span class="sd">    Args:</span>
</span><span id="get_inspection_term-274"><a href="#get_inspection_term-274"><span class="linenos">274</span></a><span class="sd">        term_id (int): The unique identifier of the inspection term.</span>
</span><span id="get_inspection_term-275"><a href="#get_inspection_term-275"><span class="linenos">275</span></a><span class="sd">        db (sessionmaker): The database session dependency injected by FastAPI.</span>
</span><span id="get_inspection_term-276"><a href="#get_inspection_term-276"><span class="linenos">276</span></a>
</span><span id="get_inspection_term-277"><a href="#get_inspection_term-277"><span class="linenos">277</span></a><span class="sd">    Raises:</span>
</span><span id="get_inspection_term-278"><a href="#get_inspection_term-278"><span class="linenos">278</span></a><span class="sd">        HTTPException: If the inspection term is not found.</span>
</span><span id="get_inspection_term-279"><a href="#get_inspection_term-279"><span class="linenos">279</span></a>
</span><span id="get_inspection_term-280"><a href="#get_inspection_term-280"><span class="linenos">280</span></a><span class="sd">    Returns:</span>
</span><span id="get_inspection_term-281"><a href="#get_inspection_term-281"><span class="linenos">281</span></a><span class="sd">        dict: A dictionary containing the inspection term details:</span>
</span><span id="get_inspection_term-282"><a href="#get_inspection_term-282"><span class="linenos">282</span></a><span class="sd">            - lesson_id (int): ID of the lesson.</span>
</span><span id="get_inspection_term-283"><a href="#get_inspection_term-283"><span class="linenos">283</span></a><span class="sd">            - subject_id (int): ID of the subject.</span>
</span><span id="get_inspection_term-284"><a href="#get_inspection_term-284"><span class="linenos">284</span></a><span class="sd">            - subject_code (str): Code of the subject.</span>
</span><span id="get_inspection_term-285"><a href="#get_inspection_term-285"><span class="linenos">285</span></a><span class="sd">            - subject_name (str): Name of the subject.</span>
</span><span id="get_inspection_term-286"><a href="#get_inspection_term-286"><span class="linenos">286</span></a><span class="sd">            - subject_type (str): Type/category of the subject.</span>
</span><span id="get_inspection_term-287"><a href="#get_inspection_term-287"><span class="linenos">287</span></a><span class="sd">            - teacher_id (int): ID of the teacher.</span>
</span><span id="get_inspection_term-288"><a href="#get_inspection_term-288"><span class="linenos">288</span></a><span class="sd">            - teacher_name (str): First name of the teacher.</span>
</span><span id="get_inspection_term-289"><a href="#get_inspection_term-289"><span class="linenos">289</span></a><span class="sd">            - teacher_surname (str): Surname of the teacher.</span>
</span><span id="get_inspection_term-290"><a href="#get_inspection_term-290"><span class="linenos">290</span></a><span class="sd">            - teacher_title (str): Title of the teacher (e.g., Dr., Mr.).</span>
</span><span id="get_inspection_term-291"><a href="#get_inspection_term-291"><span class="linenos">291</span></a><span class="sd">            - department (str): Department the teacher belongs to.</span>
</span><span id="get_inspection_term-292"><a href="#get_inspection_term-292"><span class="linenos">292</span></a><span class="sd">            - time (datetime): Date and time of the lesson.</span>
</span><span id="get_inspection_term-293"><a href="#get_inspection_term-293"><span class="linenos">293</span></a><span class="sd">            - room (str): Room where the lesson took place.</span>
</span><span id="get_inspection_term-294"><a href="#get_inspection_term-294"><span class="linenos">294</span></a><span class="sd">            - building (str): Building where the lesson took place.</span>
</span><span id="get_inspection_term-295"><a href="#get_inspection_term-295"><span class="linenos">295</span></a>
</span><span id="get_inspection_term-296"><a href="#get_inspection_term-296"><span class="linenos">296</span></a><span class="sd">    Example Response:</span>
</span><span id="get_inspection_term-297"><a href="#get_inspection_term-297"><span class="linenos">297</span></a><span class="sd">        {</span>
</span><span id="get_inspection_term-298"><a href="#get_inspection_term-298"><span class="linenos">298</span></a><span class="sd">            &quot;lesson_id&quot;: 1,</span>
</span><span id="get_inspection_term-299"><a href="#get_inspection_term-299"><span class="linenos">299</span></a><span class="sd">            &quot;subject_id&quot;: 101,</span>
</span><span id="get_inspection_term-300"><a href="#get_inspection_term-300"><span class="linenos">300</span></a><span class="sd">            &quot;subject_code&quot;: &quot;MATH101&quot;,</span>
</span><span id="get_inspection_term-301"><a href="#get_inspection_term-301"><span class="linenos">301</span></a><span class="sd">            &quot;subject_name&quot;: &quot;Calculus&quot;,</span>
</span><span id="get_inspection_term-302"><a href="#get_inspection_term-302"><span class="linenos">302</span></a><span class="sd">            &quot;subject_type&quot;: &quot;Core&quot;,</span>
</span><span id="get_inspection_term-303"><a href="#get_inspection_term-303"><span class="linenos">303</span></a><span class="sd">            &quot;teacher_id&quot;: 10,</span>
</span><span id="get_inspection_term-304"><a href="#get_inspection_term-304"><span class="linenos">304</span></a><span class="sd">            &quot;teacher_name&quot;: &quot;Jane&quot;,</span>
</span><span id="get_inspection_term-305"><a href="#get_inspection_term-305"><span class="linenos">305</span></a><span class="sd">            &quot;teacher_surname&quot;: &quot;Doe&quot;,</span>
</span><span id="get_inspection_term-306"><a href="#get_inspection_term-306"><span class="linenos">306</span></a><span class="sd">            &quot;teacher_title&quot;: &quot;Dr.&quot;,</span>
</span><span id="get_inspection_term-307"><a href="#get_inspection_term-307"><span class="linenos">307</span></a><span class="sd">            &quot;department&quot;: &quot;Mathematics&quot;,</span>
</span><span id="get_inspection_term-308"><a href="#get_inspection_term-308"><span class="linenos">308</span></a><span class="sd">            &quot;time&quot;: &quot;2025-01-01T10:00:00&quot;,</span>
</span><span id="get_inspection_term-309"><a href="#get_inspection_term-309"><span class="linenos">309</span></a><span class="sd">            &quot;room&quot;: &quot;101&quot;,</span>
</span><span id="get_inspection_term-310"><a href="#get_inspection_term-310"><span class="linenos">310</span></a><span class="sd">            &quot;building&quot;: &quot;Science Block&quot;</span>
</span><span id="get_inspection_term-311"><a href="#get_inspection_term-311"><span class="linenos">311</span></a><span class="sd">        }</span>
</span><span id="get_inspection_term-312"><a href="#get_inspection_term-312"><span class="linenos">312</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="get_inspection_term-313"><a href="#get_inspection_term-313"><span class="linenos">313</span></a>
</span><span id="get_inspection_term-314"><a href="#get_inspection_term-314"><span class="linenos">314</span></a>    <span class="n">data</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="get_inspection_term-315"><a href="#get_inspection_term-315"><span class="linenos">315</span></a>        <span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">Inspection</span><span class="p">)</span>
</span><span id="get_inspection_term-316"><a href="#get_inspection_term-316"><span class="linenos">316</span></a>        <span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">Lesson</span><span class="p">,</span> <span class="n">Lesson</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">Inspection</span><span class="o">.</span><span class="n">fk_lesson</span><span class="p">)</span>
</span><span id="get_inspection_term-317"><a href="#get_inspection_term-317"><span class="linenos">317</span></a>        <span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">Subject</span><span class="p">,</span> <span class="n">Subject</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">Lesson</span><span class="o">.</span><span class="n">fk_subject</span><span class="p">)</span>
</span><span id="get_inspection_term-318"><a href="#get_inspection_term-318"><span class="linenos">318</span></a>        <span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">Teacher</span><span class="p">,</span> <span class="n">Teacher</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">Lesson</span><span class="o">.</span><span class="n">fk_teacher</span><span class="p">)</span>
</span><span id="get_inspection_term-319"><a href="#get_inspection_term-319"><span class="linenos">319</span></a>        <span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">Lesson</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">term_id</span><span class="p">)</span>
</span><span id="get_inspection_term-320"><a href="#get_inspection_term-320"><span class="linenos">320</span></a>        <span class="o">.</span><span class="n">first</span><span class="p">()</span>
</span><span id="get_inspection_term-321"><a href="#get_inspection_term-321"><span class="linenos">321</span></a>    <span class="p">)</span>
</span><span id="get_inspection_term-322"><a href="#get_inspection_term-322"><span class="linenos">322</span></a>
</span><span id="get_inspection_term-323"><a href="#get_inspection_term-323"><span class="linenos">323</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">data</span><span class="p">:</span>
</span><span id="get_inspection_term-324"><a href="#get_inspection_term-324"><span class="linenos">324</span></a>        <span class="k">raise</span> <span class="n">HTTPException</span><span class="p">(</span><span class="n">status_code</span><span class="o">=</span><span class="mi">404</span><span class="p">,</span> <span class="n">detail</span><span class="o">=</span><span class="s2">&quot;Inspection term not found&quot;</span><span class="p">)</span>
</span><span id="get_inspection_term-325"><a href="#get_inspection_term-325"><span class="linenos">325</span></a>
</span><span id="get_inspection_term-326"><a href="#get_inspection_term-326"><span class="linenos">326</span></a>    <span class="k">return</span> <span class="p">{</span>
</span><span id="get_inspection_term-327"><a href="#get_inspection_term-327"><span class="linenos">327</span></a>        <span class="s2">&quot;lesson_id&quot;</span><span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">lesson</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
</span><span id="get_inspection_term-328"><a href="#get_inspection_term-328"><span class="linenos">328</span></a>        <span class="s2">&quot;subject_id&quot;</span><span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">lesson</span><span class="o">.</span><span class="n">subject</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
</span><span id="get_inspection_term-329"><a href="#get_inspection_term-329"><span class="linenos">329</span></a>        <span class="s2">&quot;subject_code&quot;</span><span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">lesson</span><span class="o">.</span><span class="n">subject</span><span class="o">.</span><span class="n">code</span><span class="p">,</span>
</span><span id="get_inspection_term-330"><a href="#get_inspection_term-330"><span class="linenos">330</span></a>        <span class="s2">&quot;subject_name&quot;</span><span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">lesson</span><span class="o">.</span><span class="n">subject</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="get_inspection_term-331"><a href="#get_inspection_term-331"><span class="linenos">331</span></a>        <span class="s2">&quot;subject_type&quot;</span><span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">lesson</span><span class="o">.</span><span class="n">subject</span><span class="o">.</span><span class="n">type</span><span class="p">,</span>
</span><span id="get_inspection_term-332"><a href="#get_inspection_term-332"><span class="linenos">332</span></a>        <span class="s2">&quot;teacher_id&quot;</span><span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">lesson</span><span class="o">.</span><span class="n">teacher</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
</span><span id="get_inspection_term-333"><a href="#get_inspection_term-333"><span class="linenos">333</span></a>        <span class="s2">&quot;teacher_name&quot;</span><span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">lesson</span><span class="o">.</span><span class="n">teacher</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="get_inspection_term-334"><a href="#get_inspection_term-334"><span class="linenos">334</span></a>        <span class="s2">&quot;teacher_surname&quot;</span><span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">lesson</span><span class="o">.</span><span class="n">teacher</span><span class="o">.</span><span class="n">surname</span><span class="p">,</span>
</span><span id="get_inspection_term-335"><a href="#get_inspection_term-335"><span class="linenos">335</span></a>        <span class="s2">&quot;teacher_title&quot;</span><span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">lesson</span><span class="o">.</span><span class="n">teacher</span><span class="o">.</span><span class="n">title</span><span class="p">,</span>
</span><span id="get_inspection_term-336"><a href="#get_inspection_term-336"><span class="linenos">336</span></a>        <span class="s2">&quot;department&quot;</span><span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">lesson</span><span class="o">.</span><span class="n">teacher</span><span class="o">.</span><span class="n">department</span><span class="p">,</span>
</span><span id="get_inspection_term-337"><a href="#get_inspection_term-337"><span class="linenos">337</span></a>        <span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">lesson</span><span class="o">.</span><span class="n">time</span><span class="p">,</span>
</span><span id="get_inspection_term-338"><a href="#get_inspection_term-338"><span class="linenos">338</span></a>        <span class="s2">&quot;room&quot;</span><span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">lesson</span><span class="o">.</span><span class="n">room</span><span class="p">,</span>
</span><span id="get_inspection_term-339"><a href="#get_inspection_term-339"><span class="linenos">339</span></a>        <span class="s2">&quot;building&quot;</span><span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">lesson</span><span class="o">.</span><span class="n">building</span><span class="p">,</span>
</span><span id="get_inspection_term-340"><a href="#get_inspection_term-340"><span class="linenos">340</span></a>    <span class="p">}</span>
</span></pre></div>


            <div class="docstring"><p>Fetch details of an inspection term by its ID.</p>

<p>This endpoint retrieves information about a specific inspection term, including details
about the lesson, subject, and teacher.</p>

<p>Args:
    term_id (int): The unique identifier of the inspection term.
    db (sessionmaker): The database session dependency injected by FastAPI.</p>

<p>Raises:
    HTTPException: If the inspection term is not found.</p>

<p>Returns:
    dict: A dictionary containing the inspection term details:
        - lesson_id (int): ID of the lesson.
        - subject_id (int): ID of the subject.
        - subject_code (str): Code of the subject.
        - subject_name (str): Name of the subject.
        - subject_type (str): Type/category of the subject.
        - teacher_id (int): ID of the teacher.
        - teacher_name (str): First name of the teacher.
        - teacher_surname (str): Surname of the teacher.
        - teacher_title (str): Title of the teacher (e.g., Dr., Mr.).
        - department (str): Department the teacher belongs to.
        - time (datetime): Date and time of the lesson.
        - room (str): Room where the lesson took place.
        - building (str): Building where the lesson took place.</p>

<p>Example Response:
    {
        "lesson_id": 1,
        "subject_id": 101,
        "subject_code": "MATH101",
        "subject_name": "Calculus",
        "subject_type": "Core",
        "teacher_id": 10,
        "teacher_name": "Jane",
        "teacher_surname": "Doe",
        "teacher_title": "Dr.",
        "department": "Mathematics",
        "time": "2025-01-01T10:00:00",
        "room": "101",
        "building": "Science Block"
    }</p>
</div>


                </section>
                <section id="edit_inspection_team">
                            <input id="edit_inspection_team-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-app.post">@app.post(&#39;/inspection-term/edit/{term_id}/&#39;)</div>

        <span class="def">def</span>
        <span class="name">edit_inspection_team</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">term_id</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">updated_data</span><span class="p">:</span> <span class="n"><a href="models_pydantic.html#CreateInspection">Model.models_pydantic.CreateInspection</a></span>,</span><span class="param">	<span class="n">db</span><span class="p">:</span> <span class="n">sqlalchemy</span><span class="o">.</span><span class="n">orm</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">sessionmaker</span> <span class="o">=</span> <span class="n">Depends</span><span class="p">(</span><span class="n">get_db</span><span class="p">)</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="edit_inspection_team-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#edit_inspection_team"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="edit_inspection_team-343"><a href="#edit_inspection_team-343"><span class="linenos">343</span></a><span class="nd">@app</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="s2">&quot;/inspection-term/edit/</span><span class="si">{term_id}</span><span class="s2">/&quot;</span><span class="p">)</span>
</span><span id="edit_inspection_team-344"><a href="#edit_inspection_team-344"><span class="linenos">344</span></a><span class="k">def</span><span class="w"> </span><span class="nf">edit_inspection_team</span><span class="p">(</span>
</span><span id="edit_inspection_team-345"><a href="#edit_inspection_team-345"><span class="linenos">345</span></a>    <span class="n">term_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">updated_data</span><span class="p">:</span> <span class="n">CreateInspection</span><span class="p">,</span> <span class="n">db</span><span class="p">:</span> <span class="n">sessionmaker</span> <span class="o">=</span> <span class="n">Depends</span><span class="p">(</span><span class="n">get_db</span><span class="p">)</span>
</span><span id="edit_inspection_team-346"><a href="#edit_inspection_team-346"><span class="linenos">346</span></a><span class="p">):</span>
</span><span id="edit_inspection_team-347"><a href="#edit_inspection_team-347"><span class="linenos">347</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="edit_inspection_team-348"><a href="#edit_inspection_team-348"><span class="linenos">348</span></a><span class="sd">    Edit an existing inspection term.</span>
</span><span id="edit_inspection_team-349"><a href="#edit_inspection_team-349"><span class="linenos">349</span></a>
</span><span id="edit_inspection_team-350"><a href="#edit_inspection_team-350"><span class="linenos">350</span></a><span class="sd">    This endpoint updates the details of an inspection term identified by its ID. Partial updates</span>
</span><span id="edit_inspection_team-351"><a href="#edit_inspection_team-351"><span class="linenos">351</span></a><span class="sd">    are supported, and only the fields provided in the request body will be updated.</span>
</span><span id="edit_inspection_team-352"><a href="#edit_inspection_team-352"><span class="linenos">352</span></a>
</span><span id="edit_inspection_team-353"><a href="#edit_inspection_team-353"><span class="linenos">353</span></a><span class="sd">    Args:</span>
</span><span id="edit_inspection_team-354"><a href="#edit_inspection_team-354"><span class="linenos">354</span></a><span class="sd">        term_id (int): The unique identifier of the inspection term.</span>
</span><span id="edit_inspection_team-355"><a href="#edit_inspection_team-355"><span class="linenos">355</span></a><span class="sd">        updated_data (CreateInspection): Data model containing the fields to update.</span>
</span><span id="edit_inspection_team-356"><a href="#edit_inspection_team-356"><span class="linenos">356</span></a><span class="sd">        db (sessionmaker): The database session dependency injected by FastAPI.</span>
</span><span id="edit_inspection_team-357"><a href="#edit_inspection_team-357"><span class="linenos">357</span></a>
</span><span id="edit_inspection_team-358"><a href="#edit_inspection_team-358"><span class="linenos">358</span></a><span class="sd">    Raises:</span>
</span><span id="edit_inspection_team-359"><a href="#edit_inspection_team-359"><span class="linenos">359</span></a><span class="sd">        HTTPException: If the inspection term with the given ID is not found.</span>
</span><span id="edit_inspection_team-360"><a href="#edit_inspection_team-360"><span class="linenos">360</span></a>
</span><span id="edit_inspection_team-361"><a href="#edit_inspection_team-361"><span class="linenos">361</span></a><span class="sd">    Returns:</span>
</span><span id="edit_inspection_team-362"><a href="#edit_inspection_team-362"><span class="linenos">362</span></a><span class="sd">        dict: A success message indicating the inspection term was updated.</span>
</span><span id="edit_inspection_team-363"><a href="#edit_inspection_team-363"><span class="linenos">363</span></a>
</span><span id="edit_inspection_team-364"><a href="#edit_inspection_team-364"><span class="linenos">364</span></a><span class="sd">    Example Request Body (JSON):</span>
</span><span id="edit_inspection_team-365"><a href="#edit_inspection_team-365"><span class="linenos">365</span></a><span class="sd">        {</span>
</span><span id="edit_inspection_team-366"><a href="#edit_inspection_team-366"><span class="linenos">366</span></a><span class="sd">            &quot;fk_lesson&quot;: 5,</span>
</span><span id="edit_inspection_team-367"><a href="#edit_inspection_team-367"><span class="linenos">367</span></a><span class="sd">            &quot;fk_inspectionReport&quot;: 3,</span>
</span><span id="edit_inspection_team-368"><a href="#edit_inspection_team-368"><span class="linenos">368</span></a><span class="sd">            &quot;fk_inspectionTeam&quot;: 2</span>
</span><span id="edit_inspection_team-369"><a href="#edit_inspection_team-369"><span class="linenos">369</span></a><span class="sd">        }</span>
</span><span id="edit_inspection_team-370"><a href="#edit_inspection_team-370"><span class="linenos">370</span></a>
</span><span id="edit_inspection_team-371"><a href="#edit_inspection_team-371"><span class="linenos">371</span></a><span class="sd">    Example Response:</span>
</span><span id="edit_inspection_team-372"><a href="#edit_inspection_team-372"><span class="linenos">372</span></a><span class="sd">        {</span>
</span><span id="edit_inspection_team-373"><a href="#edit_inspection_team-373"><span class="linenos">373</span></a><span class="sd">            &quot;message&quot;: &quot;Inspection term updated successfully&quot;</span>
</span><span id="edit_inspection_team-374"><a href="#edit_inspection_team-374"><span class="linenos">374</span></a><span class="sd">        }</span>
</span><span id="edit_inspection_team-375"><a href="#edit_inspection_team-375"><span class="linenos">375</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="edit_inspection_team-376"><a href="#edit_inspection_team-376"><span class="linenos">376</span></a>
</span><span id="edit_inspection_team-377"><a href="#edit_inspection_team-377"><span class="linenos">377</span></a>    <span class="n">inspection</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">Inspection</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">Inspection</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">term_id</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
</span><span id="edit_inspection_team-378"><a href="#edit_inspection_team-378"><span class="linenos">378</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">inspection</span><span class="p">:</span>
</span><span id="edit_inspection_team-379"><a href="#edit_inspection_team-379"><span class="linenos">379</span></a>        <span class="k">raise</span> <span class="n">HTTPException</span><span class="p">(</span><span class="n">status_code</span><span class="o">=</span><span class="mi">404</span><span class="p">,</span> <span class="n">detail</span><span class="o">=</span><span class="s2">&quot;Inspection term not found&quot;</span><span class="p">)</span>
</span><span id="edit_inspection_team-380"><a href="#edit_inspection_team-380"><span class="linenos">380</span></a>
</span><span id="edit_inspection_team-381"><a href="#edit_inspection_team-381"><span class="linenos">381</span></a>    <span class="n">update_fields</span> <span class="o">=</span> <span class="n">updated_data</span><span class="o">.</span><span class="n">dict</span><span class="p">(</span><span class="n">exclude_unset</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="edit_inspection_team-382"><a href="#edit_inspection_team-382"><span class="linenos">382</span></a>    <span class="k">for</span> <span class="n">field</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">update_fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="edit_inspection_team-383"><a href="#edit_inspection_team-383"><span class="linenos">383</span></a>        <span class="nb">setattr</span><span class="p">(</span><span class="n">inspection</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</span><span id="edit_inspection_team-384"><a href="#edit_inspection_team-384"><span class="linenos">384</span></a>
</span><span id="edit_inspection_team-385"><a href="#edit_inspection_team-385"><span class="linenos">385</span></a>    <span class="n">db</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="edit_inspection_team-386"><a href="#edit_inspection_team-386"><span class="linenos">386</span></a>
</span><span id="edit_inspection_team-387"><a href="#edit_inspection_team-387"><span class="linenos">387</span></a>    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;Inspection term updated successfully&quot;</span><span class="p">}</span>
</span></pre></div>


            <div class="docstring"><p>Edit an existing inspection term.</p>

<p>This endpoint updates the details of an inspection term identified by its ID. Partial updates
are supported, and only the fields provided in the request body will be updated.</p>

<p>Args:
    term_id (int): The unique identifier of the inspection term.
    updated_data (CreateInspection): Data model containing the fields to update.
    db (sessionmaker): The database session dependency injected by FastAPI.</p>

<p>Raises:
    HTTPException: If the inspection term with the given ID is not found.</p>

<p>Returns:
    dict: A success message indicating the inspection term was updated.</p>

<p>Example Request Body (JSON):
    {
        "fk_lesson": 5,
        "fk_inspectionReport": 3,
        "fk_inspectionTeam": 2
    }</p>

<p>Example Response:
    {
        "message": "Inspection term updated successfully"
    }</p>
</div>


                </section>
                <section id="get_inspection_terms">
                            <input id="get_inspection_terms-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-app.post">@app.post(&#39;/inspection-terms/&#39;)</div>

        <span class="def">def</span>
        <span class="name">get_inspection_terms</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">term</span><span class="p">:</span> <span class="n"><a href="models_pydantic.html#CreateInspection">Model.models_pydantic.CreateInspection</a></span>,</span><span class="param">	<span class="n">db</span><span class="p">:</span> <span class="n">sqlalchemy</span><span class="o">.</span><span class="n">orm</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">sessionmaker</span> <span class="o">=</span> <span class="n">Depends</span><span class="p">(</span><span class="n">get_db</span><span class="p">)</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="get_inspection_terms-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#get_inspection_terms"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="get_inspection_terms-460"><a href="#get_inspection_terms-460"><span class="linenos">460</span></a><span class="nd">@app</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="s2">&quot;/inspection-terms/&quot;</span><span class="p">)</span>
</span><span id="get_inspection_terms-461"><a href="#get_inspection_terms-461"><span class="linenos">461</span></a><span class="k">def</span><span class="w"> </span><span class="nf">get_inspection_terms</span><span class="p">(</span><span class="n">term</span><span class="p">:</span> <span class="n">CreateInspection</span><span class="p">,</span> <span class="n">db</span><span class="p">:</span> <span class="n">sessionmaker</span> <span class="o">=</span> <span class="n">Depends</span><span class="p">(</span><span class="n">get_db</span><span class="p">)):</span>
</span><span id="get_inspection_terms-462"><a href="#get_inspection_terms-462"><span class="linenos">462</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="get_inspection_terms-463"><a href="#get_inspection_terms-463"><span class="linenos">463</span></a><span class="sd">    Create a new inspection term.</span>
</span><span id="get_inspection_terms-464"><a href="#get_inspection_terms-464"><span class="linenos">464</span></a>
</span><span id="get_inspection_terms-465"><a href="#get_inspection_terms-465"><span class="linenos">465</span></a><span class="sd">    This endpoint adds a new inspection term to the database, associating it with an inspection schedule,</span>
</span><span id="get_inspection_terms-466"><a href="#get_inspection_terms-466"><span class="linenos">466</span></a><span class="sd">    team, and lesson.</span>
</span><span id="get_inspection_terms-467"><a href="#get_inspection_terms-467"><span class="linenos">467</span></a>
</span><span id="get_inspection_terms-468"><a href="#get_inspection_terms-468"><span class="linenos">468</span></a><span class="sd">    Args:</span>
</span><span id="get_inspection_terms-469"><a href="#get_inspection_terms-469"><span class="linenos">469</span></a><span class="sd">        term (CreateInspection): The data model containing inspection term details.</span>
</span><span id="get_inspection_terms-470"><a href="#get_inspection_terms-470"><span class="linenos">470</span></a><span class="sd">            - team_id (int): ID of the inspection team.</span>
</span><span id="get_inspection_terms-471"><a href="#get_inspection_terms-471"><span class="linenos">471</span></a><span class="sd">            - lesson_id (int): ID of the lesson.</span>
</span><span id="get_inspection_terms-472"><a href="#get_inspection_terms-472"><span class="linenos">472</span></a><span class="sd">        db (sessionmaker): The database session dependency injected by FastAPI.</span>
</span><span id="get_inspection_terms-473"><a href="#get_inspection_terms-473"><span class="linenos">473</span></a>
</span><span id="get_inspection_terms-474"><a href="#get_inspection_terms-474"><span class="linenos">474</span></a><span class="sd">    Raises:</span>
</span><span id="get_inspection_terms-475"><a href="#get_inspection_terms-475"><span class="linenos">475</span></a><span class="sd">        HTTPException: If no inspection schedule is found or if an error occurs during creation.</span>
</span><span id="get_inspection_terms-476"><a href="#get_inspection_terms-476"><span class="linenos">476</span></a>
</span><span id="get_inspection_terms-477"><a href="#get_inspection_terms-477"><span class="linenos">477</span></a><span class="sd">    Returns:</span>
</span><span id="get_inspection_terms-478"><a href="#get_inspection_terms-478"><span class="linenos">478</span></a><span class="sd">        dict: A success message indicating the inspection term was created successfully.</span>
</span><span id="get_inspection_terms-479"><a href="#get_inspection_terms-479"><span class="linenos">479</span></a>
</span><span id="get_inspection_terms-480"><a href="#get_inspection_terms-480"><span class="linenos">480</span></a><span class="sd">    Example Request Body (JSON):</span>
</span><span id="get_inspection_terms-481"><a href="#get_inspection_terms-481"><span class="linenos">481</span></a><span class="sd">        {</span>
</span><span id="get_inspection_terms-482"><a href="#get_inspection_terms-482"><span class="linenos">482</span></a><span class="sd">            &quot;team_id&quot;: 2,</span>
</span><span id="get_inspection_terms-483"><a href="#get_inspection_terms-483"><span class="linenos">483</span></a><span class="sd">            &quot;lesson_id&quot;: 5</span>
</span><span id="get_inspection_terms-484"><a href="#get_inspection_terms-484"><span class="linenos">484</span></a><span class="sd">        }</span>
</span><span id="get_inspection_terms-485"><a href="#get_inspection_terms-485"><span class="linenos">485</span></a>
</span><span id="get_inspection_terms-486"><a href="#get_inspection_terms-486"><span class="linenos">486</span></a><span class="sd">    Example Response:</span>
</span><span id="get_inspection_terms-487"><a href="#get_inspection_terms-487"><span class="linenos">487</span></a><span class="sd">        {</span>
</span><span id="get_inspection_terms-488"><a href="#get_inspection_terms-488"><span class="linenos">488</span></a><span class="sd">            &quot;message&quot;: &quot;Inspection report updated successfully&quot;</span>
</span><span id="get_inspection_terms-489"><a href="#get_inspection_terms-489"><span class="linenos">489</span></a><span class="sd">        }</span>
</span><span id="get_inspection_terms-490"><a href="#get_inspection_terms-490"><span class="linenos">490</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="get_inspection_terms-491"><a href="#get_inspection_terms-491"><span class="linenos">491</span></a>    <span class="n">schedule</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">InspectionSchedule</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span><span class="o">.</span><span class="n">id</span>
</span><span id="get_inspection_terms-492"><a href="#get_inspection_terms-492"><span class="linenos">492</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">schedule</span><span class="p">:</span>
</span><span id="get_inspection_terms-493"><a href="#get_inspection_terms-493"><span class="linenos">493</span></a>        <span class="k">raise</span> <span class="n">HTTPException</span><span class="p">(</span><span class="n">status_code</span><span class="o">=</span><span class="mi">404</span><span class="p">,</span> <span class="n">detail</span><span class="o">=</span><span class="s2">&quot;No inspection schedule found.&quot;</span><span class="p">)</span>
</span><span id="get_inspection_terms-494"><a href="#get_inspection_terms-494"><span class="linenos">494</span></a>
</span><span id="get_inspection_terms-495"><a href="#get_inspection_terms-495"><span class="linenos">495</span></a>    <span class="n">all_inspection</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="get_inspection_terms-496"><a href="#get_inspection_terms-496"><span class="linenos">496</span></a>        <span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">Inspection</span><span class="p">)</span>
</span><span id="get_inspection_terms-497"><a href="#get_inspection_terms-497"><span class="linenos">497</span></a>        <span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">Inspection</span><span class="o">.</span><span class="n">fk_inspectionSchedule</span> <span class="o">==</span> <span class="n">schedule</span><span class="p">)</span>
</span><span id="get_inspection_terms-498"><a href="#get_inspection_terms-498"><span class="linenos">498</span></a>        <span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">Lesson</span><span class="p">,</span> <span class="n">Inspection</span><span class="o">.</span><span class="n">fk_lesson</span> <span class="o">==</span> <span class="n">Lesson</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
</span><span id="get_inspection_terms-499"><a href="#get_inspection_terms-499"><span class="linenos">499</span></a>        <span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">Lesson</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">term</span><span class="o">.</span><span class="n">fk_lesson</span><span class="p">)</span>
</span><span id="get_inspection_terms-500"><a href="#get_inspection_terms-500"><span class="linenos">500</span></a>        <span class="o">.</span><span class="n">first</span><span class="p">()</span>
</span><span id="get_inspection_terms-501"><a href="#get_inspection_terms-501"><span class="linenos">501</span></a>    <span class="p">)</span>
</span><span id="get_inspection_terms-502"><a href="#get_inspection_terms-502"><span class="linenos">502</span></a>
</span><span id="get_inspection_terms-503"><a href="#get_inspection_terms-503"><span class="linenos">503</span></a>    <span class="k">if</span> <span class="n">all_inspection</span><span class="p">:</span>
</span><span id="get_inspection_terms-504"><a href="#get_inspection_terms-504"><span class="linenos">504</span></a>        <span class="k">raise</span> <span class="n">HTTPException</span><span class="p">(</span>
</span><span id="get_inspection_terms-505"><a href="#get_inspection_terms-505"><span class="linenos">505</span></a>            <span class="n">status_code</span><span class="o">=</span><span class="mi">409</span><span class="p">,</span> <span class="n">detail</span><span class="o">=</span><span class="s2">&quot;Lesson already has an inspection scheduled.&quot;</span>
</span><span id="get_inspection_terms-506"><a href="#get_inspection_terms-506"><span class="linenos">506</span></a>        <span class="p">)</span>
</span><span id="get_inspection_terms-507"><a href="#get_inspection_terms-507"><span class="linenos">507</span></a>
</span><span id="get_inspection_terms-508"><a href="#get_inspection_terms-508"><span class="linenos">508</span></a>    <span class="n">inspection</span> <span class="o">=</span> <span class="n">Inspection</span><span class="p">(</span>
</span><span id="get_inspection_terms-509"><a href="#get_inspection_terms-509"><span class="linenos">509</span></a>        <span class="n">fk_inspectionSchedule</span><span class="o">=</span><span class="n">schedule</span><span class="p">,</span>
</span><span id="get_inspection_terms-510"><a href="#get_inspection_terms-510"><span class="linenos">510</span></a>        <span class="n">fk_inspectionTeam</span><span class="o">=</span><span class="n">term</span><span class="o">.</span><span class="n">fk_inspectionTeam</span><span class="p">,</span>
</span><span id="get_inspection_terms-511"><a href="#get_inspection_terms-511"><span class="linenos">511</span></a>        <span class="n">fk_lesson</span><span class="o">=</span><span class="n">term</span><span class="o">.</span><span class="n">fk_lesson</span><span class="p">,</span>
</span><span id="get_inspection_terms-512"><a href="#get_inspection_terms-512"><span class="linenos">512</span></a>    <span class="p">)</span>
</span><span id="get_inspection_terms-513"><a href="#get_inspection_terms-513"><span class="linenos">513</span></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="get_inspection_terms-514"><a href="#get_inspection_terms-514"><span class="linenos">514</span></a>        <span class="n">db</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">inspection</span><span class="p">)</span>
</span><span id="get_inspection_terms-515"><a href="#get_inspection_terms-515"><span class="linenos">515</span></a>        <span class="n">db</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="get_inspection_terms-516"><a href="#get_inspection_terms-516"><span class="linenos">516</span></a>        <span class="n">db</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">inspection</span><span class="p">)</span>
</span><span id="get_inspection_terms-517"><a href="#get_inspection_terms-517"><span class="linenos">517</span></a>        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;Inspection report updated successfully&quot;</span><span class="p">}</span>
</span><span id="get_inspection_terms-518"><a href="#get_inspection_terms-518"><span class="linenos">518</span></a>
</span><span id="get_inspection_terms-519"><a href="#get_inspection_terms-519"><span class="linenos">519</span></a>    <span class="k">except</span> <span class="n">IntegrityError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="get_inspection_terms-520"><a href="#get_inspection_terms-520"><span class="linenos">520</span></a>        <span class="n">db</span><span class="o">.</span><span class="n">rollback</span><span class="p">()</span>
</span><span id="get_inspection_terms-521"><a href="#get_inspection_terms-521"><span class="linenos">521</span></a>        <span class="k">raise</span> <span class="n">HTTPException</span><span class="p">(</span>
</span><span id="get_inspection_terms-522"><a href="#get_inspection_terms-522"><span class="linenos">522</span></a>            <span class="n">status_code</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>
</span><span id="get_inspection_terms-523"><a href="#get_inspection_terms-523"><span class="linenos">523</span></a>            <span class="n">detail</span><span class="o">=</span><span class="s2">&quot;An error occurred while creating the inspection term.&quot;</span><span class="p">,</span>
</span><span id="get_inspection_terms-524"><a href="#get_inspection_terms-524"><span class="linenos">524</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create a new inspection term.</p>

<p>This endpoint adds a new inspection term to the database, associating it with an inspection schedule,
team, and lesson.</p>

<p>Args:
    term (CreateInspection): The data model containing inspection term details.
        - team_id (int): ID of the inspection team.
        - lesson_id (int): ID of the lesson.
    db (sessionmaker): The database session dependency injected by FastAPI.</p>

<p>Raises:
    HTTPException: If no inspection schedule is found or if an error occurs during creation.</p>

<p>Returns:
    dict: A success message indicating the inspection term was created successfully.</p>

<p>Example Request Body (JSON):
    {
        "team_id": 2,
        "lesson_id": 5
    }</p>

<p>Example Response:
    {
        "message": "Inspection report updated successfully"
    }</p>
</div>


                </section>
                <section id="remove_teacher_from_team">
                            <input id="remove_teacher_from_team-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-app.delete">@app.delete(&#39;/inspection-teams/{team_id}/remove-teacher/&#39;)</div>

        <span class="def">def</span>
        <span class="name">remove_teacher_from_team</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">team_id</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">payload</span><span class="p">:</span> <span class="n"><a href="models_pydantic.html#RemoveTeacherFromTeam">Model.models_pydantic.RemoveTeacherFromTeam</a></span>,</span><span class="param">	<span class="n">db</span><span class="p">:</span> <span class="n">sqlalchemy</span><span class="o">.</span><span class="n">orm</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">sessionmaker</span> <span class="o">=</span> <span class="n">Depends</span><span class="p">(</span><span class="n">get_db</span><span class="p">)</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="remove_teacher_from_team-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#remove_teacher_from_team"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="remove_teacher_from_team-813"><a href="#remove_teacher_from_team-813"><span class="linenos">813</span></a><span class="nd">@app</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="s2">&quot;/inspection-teams/</span><span class="si">{team_id}</span><span class="s2">/remove-teacher/&quot;</span><span class="p">)</span>
</span><span id="remove_teacher_from_team-814"><a href="#remove_teacher_from_team-814"><span class="linenos">814</span></a><span class="k">def</span><span class="w"> </span><span class="nf">remove_teacher_from_team</span><span class="p">(</span>
</span><span id="remove_teacher_from_team-815"><a href="#remove_teacher_from_team-815"><span class="linenos">815</span></a>    <span class="n">team_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">payload</span><span class="p">:</span> <span class="n">RemoveTeacherFromTeam</span><span class="p">,</span> <span class="n">db</span><span class="p">:</span> <span class="n">sessionmaker</span> <span class="o">=</span> <span class="n">Depends</span><span class="p">(</span><span class="n">get_db</span><span class="p">)</span>
</span><span id="remove_teacher_from_team-816"><a href="#remove_teacher_from_team-816"><span class="linenos">816</span></a><span class="p">):</span>
</span><span id="remove_teacher_from_team-817"><a href="#remove_teacher_from_team-817"><span class="linenos">817</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="remove_teacher_from_team-818"><a href="#remove_teacher_from_team-818"><span class="linenos">818</span></a><span class="sd">    Remove a teacher from an inspection team.</span>
</span><span id="remove_teacher_from_team-819"><a href="#remove_teacher_from_team-819"><span class="linenos">819</span></a>
</span><span id="remove_teacher_from_team-820"><a href="#remove_teacher_from_team-820"><span class="linenos">820</span></a><span class="sd">    This endpoint removes a teacher from a specific inspection team. If the teacher is not assigned to the team,</span>
</span><span id="remove_teacher_from_team-821"><a href="#remove_teacher_from_team-821"><span class="linenos">821</span></a><span class="sd">    an error is raised. If the team or the teacher is not found, a corresponding error message is returned.</span>
</span><span id="remove_teacher_from_team-822"><a href="#remove_teacher_from_team-822"><span class="linenos">822</span></a>
</span><span id="remove_teacher_from_team-823"><a href="#remove_teacher_from_team-823"><span class="linenos">823</span></a><span class="sd">    Args:</span>
</span><span id="remove_teacher_from_team-824"><a href="#remove_teacher_from_team-824"><span class="linenos">824</span></a><span class="sd">        team_id (int): The unique identifier of the inspection team.</span>
</span><span id="remove_teacher_from_team-825"><a href="#remove_teacher_from_team-825"><span class="linenos">825</span></a><span class="sd">        payload (RemoveTeacherFromTeam): The data model containing the teacher&#39;s ID to be removed from the team.</span>
</span><span id="remove_teacher_from_team-826"><a href="#remove_teacher_from_team-826"><span class="linenos">826</span></a><span class="sd">        db (sessionmaker): The database session dependency injected by FastAPI.</span>
</span><span id="remove_teacher_from_team-827"><a href="#remove_teacher_from_team-827"><span class="linenos">827</span></a>
</span><span id="remove_teacher_from_team-828"><a href="#remove_teacher_from_team-828"><span class="linenos">828</span></a><span class="sd">    Raises:</span>
</span><span id="remove_teacher_from_team-829"><a href="#remove_teacher_from_team-829"><span class="linenos">829</span></a><span class="sd">        HTTPException: If the inspection team or teacher is not found, or if the teacher is not part of the team.</span>
</span><span id="remove_teacher_from_team-830"><a href="#remove_teacher_from_team-830"><span class="linenos">830</span></a>
</span><span id="remove_teacher_from_team-831"><a href="#remove_teacher_from_team-831"><span class="linenos">831</span></a><span class="sd">    Returns:</span>
</span><span id="remove_teacher_from_team-832"><a href="#remove_teacher_from_team-832"><span class="linenos">832</span></a><span class="sd">        dict: A success message indicating the teacher was removed from the team.</span>
</span><span id="remove_teacher_from_team-833"><a href="#remove_teacher_from_team-833"><span class="linenos">833</span></a>
</span><span id="remove_teacher_from_team-834"><a href="#remove_teacher_from_team-834"><span class="linenos">834</span></a><span class="sd">    Example Request Body (JSON):</span>
</span><span id="remove_teacher_from_team-835"><a href="#remove_teacher_from_team-835"><span class="linenos">835</span></a><span class="sd">        {</span>
</span><span id="remove_teacher_from_team-836"><a href="#remove_teacher_from_team-836"><span class="linenos">836</span></a><span class="sd">            &quot;teacher_id&quot;: 5</span>
</span><span id="remove_teacher_from_team-837"><a href="#remove_teacher_from_team-837"><span class="linenos">837</span></a><span class="sd">        }</span>
</span><span id="remove_teacher_from_team-838"><a href="#remove_teacher_from_team-838"><span class="linenos">838</span></a>
</span><span id="remove_teacher_from_team-839"><a href="#remove_teacher_from_team-839"><span class="linenos">839</span></a><span class="sd">    Example Response:</span>
</span><span id="remove_teacher_from_team-840"><a href="#remove_teacher_from_team-840"><span class="linenos">840</span></a><span class="sd">        {</span>
</span><span id="remove_teacher_from_team-841"><a href="#remove_teacher_from_team-841"><span class="linenos">841</span></a><span class="sd">            &quot;message&quot;: &quot;Teacher removed from the team successfully&quot;</span>
</span><span id="remove_teacher_from_team-842"><a href="#remove_teacher_from_team-842"><span class="linenos">842</span></a><span class="sd">        }</span>
</span><span id="remove_teacher_from_team-843"><a href="#remove_teacher_from_team-843"><span class="linenos">843</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="remove_teacher_from_team-844"><a href="#remove_teacher_from_team-844"><span class="linenos">844</span></a>
</span><span id="remove_teacher_from_team-845"><a href="#remove_teacher_from_team-845"><span class="linenos">845</span></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="remove_teacher_from_team-846"><a href="#remove_teacher_from_team-846"><span class="linenos">846</span></a>        <span class="n">team</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">InspectionTeam</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">InspectionTeam</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">team_id</span><span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="remove_teacher_from_team-847"><a href="#remove_teacher_from_team-847"><span class="linenos">847</span></a>    <span class="k">except</span> <span class="n">NoResultFound</span><span class="p">:</span>
</span><span id="remove_teacher_from_team-848"><a href="#remove_teacher_from_team-848"><span class="linenos">848</span></a>        <span class="k">raise</span> <span class="n">HTTPException</span><span class="p">(</span><span class="n">status_code</span><span class="o">=</span><span class="mi">404</span><span class="p">,</span> <span class="n">detail</span><span class="o">=</span><span class="s2">&quot;Inspection Team not found&quot;</span><span class="p">)</span>
</span><span id="remove_teacher_from_team-849"><a href="#remove_teacher_from_team-849"><span class="linenos">849</span></a>
</span><span id="remove_teacher_from_team-850"><a href="#remove_teacher_from_team-850"><span class="linenos">850</span></a>    <span class="n">assignment</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="remove_teacher_from_team-851"><a href="#remove_teacher_from_team-851"><span class="linenos">851</span></a>        <span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">TeacherInspectionTeam</span><span class="p">)</span>
</span><span id="remove_teacher_from_team-852"><a href="#remove_teacher_from_team-852"><span class="linenos">852</span></a>        <span class="o">.</span><span class="n">filter</span><span class="p">(</span>
</span><span id="remove_teacher_from_team-853"><a href="#remove_teacher_from_team-853"><span class="linenos">853</span></a>            <span class="n">TeacherInspectionTeam</span><span class="o">.</span><span class="n">fk_teacher</span> <span class="o">==</span> <span class="n">payload</span><span class="o">.</span><span class="n">teacher_id</span><span class="p">,</span>
</span><span id="remove_teacher_from_team-854"><a href="#remove_teacher_from_team-854"><span class="linenos">854</span></a>            <span class="n">TeacherInspectionTeam</span><span class="o">.</span><span class="n">fk_inspectionTeam</span> <span class="o">==</span> <span class="n">team_id</span><span class="p">,</span>
</span><span id="remove_teacher_from_team-855"><a href="#remove_teacher_from_team-855"><span class="linenos">855</span></a>        <span class="p">)</span>
</span><span id="remove_teacher_from_team-856"><a href="#remove_teacher_from_team-856"><span class="linenos">856</span></a>        <span class="o">.</span><span class="n">one_or_none</span><span class="p">()</span>
</span><span id="remove_teacher_from_team-857"><a href="#remove_teacher_from_team-857"><span class="linenos">857</span></a>    <span class="p">)</span>
</span><span id="remove_teacher_from_team-858"><a href="#remove_teacher_from_team-858"><span class="linenos">858</span></a>
</span><span id="remove_teacher_from_team-859"><a href="#remove_teacher_from_team-859"><span class="linenos">859</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">assignment</span><span class="p">:</span>
</span><span id="remove_teacher_from_team-860"><a href="#remove_teacher_from_team-860"><span class="linenos">860</span></a>        <span class="k">raise</span> <span class="n">HTTPException</span><span class="p">(</span><span class="n">status_code</span><span class="o">=</span><span class="mi">404</span><span class="p">,</span> <span class="n">detail</span><span class="o">=</span><span class="s2">&quot;Teacher is not in the team&quot;</span><span class="p">)</span>
</span><span id="remove_teacher_from_team-861"><a href="#remove_teacher_from_team-861"><span class="linenos">861</span></a>
</span><span id="remove_teacher_from_team-862"><a href="#remove_teacher_from_team-862"><span class="linenos">862</span></a>    <span class="n">db</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">assignment</span><span class="p">)</span>
</span><span id="remove_teacher_from_team-863"><a href="#remove_teacher_from_team-863"><span class="linenos">863</span></a>    <span class="n">db</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="remove_teacher_from_team-864"><a href="#remove_teacher_from_team-864"><span class="linenos">864</span></a>    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;Teacher removed from the team successfully&quot;</span><span class="p">}</span>
</span></pre></div>


            <div class="docstring"><p>Remove a teacher from an inspection team.</p>

<p>This endpoint removes a teacher from a specific inspection team. If the teacher is not assigned to the team,
an error is raised. If the team or the teacher is not found, a corresponding error message is returned.</p>

<p>Args:
    team_id (int): The unique identifier of the inspection team.
    payload (RemoveTeacherFromTeam): The data model containing the teacher's ID to be removed from the team.
    db (sessionmaker): The database session dependency injected by FastAPI.</p>

<p>Raises:
    HTTPException: If the inspection team or teacher is not found, or if the teacher is not part of the team.</p>

<p>Returns:
    dict: A success message indicating the teacher was removed from the team.</p>

<p>Example Request Body (JSON):
    {
        "teacher_id": 5
    }</p>

<p>Example Response:
    {
        "message": "Teacher removed from the team successfully"
    }</p>
</div>


                </section>
                <section id="get_lesson_with_dates">
                            <input id="get_lesson_with_dates-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-app.get">@app.get(&#39;/lesson_with_dates/{teacher_id}/{subject_id}/&#39;)</div>

        <span class="def">def</span>
        <span class="name">get_lesson_with_dates</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">teacher_id</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">subject_id</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">db</span><span class="p">:</span> <span class="n">sqlalchemy</span><span class="o">.</span><span class="n">orm</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">sessionmaker</span> <span class="o">=</span> <span class="n">Depends</span><span class="p">(</span><span class="n">get_db</span><span class="p">)</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="get_lesson_with_dates-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#get_lesson_with_dates"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="get_lesson_with_dates-559"><a href="#get_lesson_with_dates-559"><span class="linenos">559</span></a><span class="nd">@app</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;/lesson_with_dates/</span><span class="si">{teacher_id}</span><span class="s2">/</span><span class="si">{subject_id}</span><span class="s2">/&quot;</span><span class="p">)</span>
</span><span id="get_lesson_with_dates-560"><a href="#get_lesson_with_dates-560"><span class="linenos">560</span></a><span class="k">def</span><span class="w"> </span><span class="nf">get_lesson_with_dates</span><span class="p">(</span>
</span><span id="get_lesson_with_dates-561"><a href="#get_lesson_with_dates-561"><span class="linenos">561</span></a>    <span class="n">teacher_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">subject_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">db</span><span class="p">:</span> <span class="n">sessionmaker</span> <span class="o">=</span> <span class="n">Depends</span><span class="p">(</span><span class="n">get_db</span><span class="p">)</span>
</span><span id="get_lesson_with_dates-562"><a href="#get_lesson_with_dates-562"><span class="linenos">562</span></a><span class="p">):</span>
</span><span id="get_lesson_with_dates-563"><a href="#get_lesson_with_dates-563"><span class="linenos">563</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="get_lesson_with_dates-564"><a href="#get_lesson_with_dates-564"><span class="linenos">564</span></a><span class="sd">    Fetch lessons for a specific teacher and subject.</span>
</span><span id="get_lesson_with_dates-565"><a href="#get_lesson_with_dates-565"><span class="linenos">565</span></a>
</span><span id="get_lesson_with_dates-566"><a href="#get_lesson_with_dates-566"><span class="linenos">566</span></a><span class="sd">    This endpoint retrieves all lessons for a given teacher and subject, including the relevant details.</span>
</span><span id="get_lesson_with_dates-567"><a href="#get_lesson_with_dates-567"><span class="linenos">567</span></a>
</span><span id="get_lesson_with_dates-568"><a href="#get_lesson_with_dates-568"><span class="linenos">568</span></a><span class="sd">    Args:</span>
</span><span id="get_lesson_with_dates-569"><a href="#get_lesson_with_dates-569"><span class="linenos">569</span></a><span class="sd">        teacher_id (int): The unique identifier of the teacher.</span>
</span><span id="get_lesson_with_dates-570"><a href="#get_lesson_with_dates-570"><span class="linenos">570</span></a><span class="sd">        subject_id (int): The unique identifier of the subject.</span>
</span><span id="get_lesson_with_dates-571"><a href="#get_lesson_with_dates-571"><span class="linenos">571</span></a><span class="sd">        db (sessionmaker): The database session dependency injected by FastAPI.</span>
</span><span id="get_lesson_with_dates-572"><a href="#get_lesson_with_dates-572"><span class="linenos">572</span></a>
</span><span id="get_lesson_with_dates-573"><a href="#get_lesson_with_dates-573"><span class="linenos">573</span></a><span class="sd">    Returns:</span>
</span><span id="get_lesson_with_dates-574"><a href="#get_lesson_with_dates-574"><span class="linenos">574</span></a><span class="sd">        list[dict]: A list of lesson details, or an empty list if no lessons are found.</span>
</span><span id="get_lesson_with_dates-575"><a href="#get_lesson_with_dates-575"><span class="linenos">575</span></a>
</span><span id="get_lesson_with_dates-576"><a href="#get_lesson_with_dates-576"><span class="linenos">576</span></a><span class="sd">    Example Response:</span>
</span><span id="get_lesson_with_dates-577"><a href="#get_lesson_with_dates-577"><span class="linenos">577</span></a><span class="sd">        [</span>
</span><span id="get_lesson_with_dates-578"><a href="#get_lesson_with_dates-578"><span class="linenos">578</span></a><span class="sd">            {</span>
</span><span id="get_lesson_with_dates-579"><a href="#get_lesson_with_dates-579"><span class="linenos">579</span></a><span class="sd">                &quot;id&quot;: 1,</span>
</span><span id="get_lesson_with_dates-580"><a href="#get_lesson_with_dates-580"><span class="linenos">580</span></a><span class="sd">                &quot;teacher_id&quot;: 10,</span>
</span><span id="get_lesson_with_dates-581"><a href="#get_lesson_with_dates-581"><span class="linenos">581</span></a><span class="sd">                &quot;subject_id&quot;: 101,</span>
</span><span id="get_lesson_with_dates-582"><a href="#get_lesson_with_dates-582"><span class="linenos">582</span></a><span class="sd">                &quot;time&quot;: &quot;2025-01-01T10:00:00&quot;,</span>
</span><span id="get_lesson_with_dates-583"><a href="#get_lesson_with_dates-583"><span class="linenos">583</span></a><span class="sd">                &quot;room&quot;: &quot;101&quot;,</span>
</span><span id="get_lesson_with_dates-584"><a href="#get_lesson_with_dates-584"><span class="linenos">584</span></a><span class="sd">                &quot;building&quot;: &quot;Science Block&quot;</span>
</span><span id="get_lesson_with_dates-585"><a href="#get_lesson_with_dates-585"><span class="linenos">585</span></a><span class="sd">            },</span>
</span><span id="get_lesson_with_dates-586"><a href="#get_lesson_with_dates-586"><span class="linenos">586</span></a><span class="sd">            ...</span>
</span><span id="get_lesson_with_dates-587"><a href="#get_lesson_with_dates-587"><span class="linenos">587</span></a><span class="sd">        ]</span>
</span><span id="get_lesson_with_dates-588"><a href="#get_lesson_with_dates-588"><span class="linenos">588</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="get_lesson_with_dates-589"><a href="#get_lesson_with_dates-589"><span class="linenos">589</span></a>
</span><span id="get_lesson_with_dates-590"><a href="#get_lesson_with_dates-590"><span class="linenos">590</span></a>    <span class="n">lessons</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="get_lesson_with_dates-591"><a href="#get_lesson_with_dates-591"><span class="linenos">591</span></a>        <span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">Lesson</span><span class="p">)</span>
</span><span id="get_lesson_with_dates-592"><a href="#get_lesson_with_dates-592"><span class="linenos">592</span></a>        <span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">Teacher</span><span class="p">,</span> <span class="n">Lesson</span><span class="o">.</span><span class="n">fk_teacher</span> <span class="o">==</span> <span class="n">Teacher</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
</span><span id="get_lesson_with_dates-593"><a href="#get_lesson_with_dates-593"><span class="linenos">593</span></a>        <span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">Subject</span><span class="p">,</span> <span class="n">Lesson</span><span class="o">.</span><span class="n">fk_subject</span> <span class="o">==</span> <span class="n">Subject</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
</span><span id="get_lesson_with_dates-594"><a href="#get_lesson_with_dates-594"><span class="linenos">594</span></a>        <span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">Teacher</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">teacher_id</span><span class="p">,</span> <span class="n">Subject</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">subject_id</span><span class="p">)</span>
</span><span id="get_lesson_with_dates-595"><a href="#get_lesson_with_dates-595"><span class="linenos">595</span></a>        <span class="c1"># .filter(Lesson.time &gt;= datetime.now()) TODO!!</span>
</span><span id="get_lesson_with_dates-596"><a href="#get_lesson_with_dates-596"><span class="linenos">596</span></a>        <span class="o">.</span><span class="n">all</span><span class="p">()</span>
</span><span id="get_lesson_with_dates-597"><a href="#get_lesson_with_dates-597"><span class="linenos">597</span></a>    <span class="p">)</span>
</span><span id="get_lesson_with_dates-598"><a href="#get_lesson_with_dates-598"><span class="linenos">598</span></a>
</span><span id="get_lesson_with_dates-599"><a href="#get_lesson_with_dates-599"><span class="linenos">599</span></a>    <span class="k">return</span> <span class="n">lessons</span> <span class="k">if</span> <span class="n">lessons</span> <span class="k">else</span> <span class="p">[]</span>
</span></pre></div>


            <div class="docstring"><p>Fetch lessons for a specific teacher and subject.</p>

<p>This endpoint retrieves all lessons for a given teacher and subject, including the relevant details.</p>

<p>Args:
    teacher_id (int): The unique identifier of the teacher.
    subject_id (int): The unique identifier of the subject.
    db (sessionmaker): The database session dependency injected by FastAPI.</p>

<p>Returns:
    list[dict]: A list of lesson details, or an empty list if no lessons are found.</p>

<p>Example Response:
    [
        {
            "id": 1,
            "teacher_id": 10,
            "subject_id": 101,
            "time": "2025-01-01T10:00:00",
            "room": "101",
            "building": "Science Block"
        },
        ...
    ]</p>
</div>


                </section>
                <section id="get_inspection_teams">
                            <input id="get_inspection_teams-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-app.get">@app.get(&#39;/inspection-teams/&#39;)</div>

        <span class="def">def</span>
        <span class="name">get_inspection_teams</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">db</span><span class="p">:</span> <span class="n">sqlalchemy</span><span class="o">.</span><span class="n">orm</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">sessionmaker</span> <span class="o">=</span> <span class="n">Depends</span><span class="p">(</span><span class="n">get_db</span><span class="p">)</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="get_inspection_teams-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#get_inspection_teams"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="get_inspection_teams-602"><a href="#get_inspection_teams-602"><span class="linenos">602</span></a><span class="nd">@app</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;/inspection-teams/&quot;</span><span class="p">)</span>
</span><span id="get_inspection_teams-603"><a href="#get_inspection_teams-603"><span class="linenos">603</span></a><span class="k">def</span><span class="w"> </span><span class="nf">get_inspection_teams</span><span class="p">(</span><span class="n">db</span><span class="p">:</span> <span class="n">sessionmaker</span> <span class="o">=</span> <span class="n">Depends</span><span class="p">(</span><span class="n">get_db</span><span class="p">)):</span>
</span><span id="get_inspection_teams-604"><a href="#get_inspection_teams-604"><span class="linenos">604</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="get_inspection_teams-605"><a href="#get_inspection_teams-605"><span class="linenos">605</span></a><span class="sd">    Fetch all inspection teams.</span>
</span><span id="get_inspection_teams-606"><a href="#get_inspection_teams-606"><span class="linenos">606</span></a>
</span><span id="get_inspection_teams-607"><a href="#get_inspection_teams-607"><span class="linenos">607</span></a><span class="sd">    This endpoint retrieves a list of all inspection teams, including their ID and name.</span>
</span><span id="get_inspection_teams-608"><a href="#get_inspection_teams-608"><span class="linenos">608</span></a>
</span><span id="get_inspection_teams-609"><a href="#get_inspection_teams-609"><span class="linenos">609</span></a><span class="sd">    Args:</span>
</span><span id="get_inspection_teams-610"><a href="#get_inspection_teams-610"><span class="linenos">610</span></a><span class="sd">        db (sessionmaker): The database session dependency injected by FastAPI.</span>
</span><span id="get_inspection_teams-611"><a href="#get_inspection_teams-611"><span class="linenos">611</span></a>
</span><span id="get_inspection_teams-612"><a href="#get_inspection_teams-612"><span class="linenos">612</span></a><span class="sd">    Returns:</span>
</span><span id="get_inspection_teams-613"><a href="#get_inspection_teams-613"><span class="linenos">613</span></a><span class="sd">        list[dict]: A list of dictionaries containing the inspection team details:</span>
</span><span id="get_inspection_teams-614"><a href="#get_inspection_teams-614"><span class="linenos">614</span></a><span class="sd">            - id (int): ID of the inspection team.</span>
</span><span id="get_inspection_teams-615"><a href="#get_inspection_teams-615"><span class="linenos">615</span></a><span class="sd">            - name (str): Name of the inspection team.</span>
</span><span id="get_inspection_teams-616"><a href="#get_inspection_teams-616"><span class="linenos">616</span></a>
</span><span id="get_inspection_teams-617"><a href="#get_inspection_teams-617"><span class="linenos">617</span></a><span class="sd">    Example Response:</span>
</span><span id="get_inspection_teams-618"><a href="#get_inspection_teams-618"><span class="linenos">618</span></a><span class="sd">        [</span>
</span><span id="get_inspection_teams-619"><a href="#get_inspection_teams-619"><span class="linenos">619</span></a><span class="sd">            {</span>
</span><span id="get_inspection_teams-620"><a href="#get_inspection_teams-620"><span class="linenos">620</span></a><span class="sd">                &quot;id&quot;: 1,</span>
</span><span id="get_inspection_teams-621"><a href="#get_inspection_teams-621"><span class="linenos">621</span></a><span class="sd">                &quot;name&quot;: &quot;Team A&quot;</span>
</span><span id="get_inspection_teams-622"><a href="#get_inspection_teams-622"><span class="linenos">622</span></a><span class="sd">            },</span>
</span><span id="get_inspection_teams-623"><a href="#get_inspection_teams-623"><span class="linenos">623</span></a><span class="sd">            {</span>
</span><span id="get_inspection_teams-624"><a href="#get_inspection_teams-624"><span class="linenos">624</span></a><span class="sd">                &quot;id&quot;: 2,</span>
</span><span id="get_inspection_teams-625"><a href="#get_inspection_teams-625"><span class="linenos">625</span></a><span class="sd">                &quot;name&quot;: &quot;Team B&quot;</span>
</span><span id="get_inspection_teams-626"><a href="#get_inspection_teams-626"><span class="linenos">626</span></a><span class="sd">            }</span>
</span><span id="get_inspection_teams-627"><a href="#get_inspection_teams-627"><span class="linenos">627</span></a><span class="sd">        ]</span>
</span><span id="get_inspection_teams-628"><a href="#get_inspection_teams-628"><span class="linenos">628</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="get_inspection_teams-629"><a href="#get_inspection_teams-629"><span class="linenos">629</span></a>
</span><span id="get_inspection_teams-630"><a href="#get_inspection_teams-630"><span class="linenos">630</span></a>    <span class="n">teams</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">InspectionTeam</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
</span><span id="get_inspection_teams-631"><a href="#get_inspection_teams-631"><span class="linenos">631</span></a>    <span class="k">return</span> <span class="p">[{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="n">team</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">team</span><span class="o">.</span><span class="n">name</span><span class="p">}</span> <span class="k">for</span> <span class="n">team</span> <span class="ow">in</span> <span class="n">teams</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Fetch all inspection teams.</p>

<p>This endpoint retrieves a list of all inspection teams, including their ID and name.</p>

<p>Args:
    db (sessionmaker): The database session dependency injected by FastAPI.</p>

<p>Returns:
    list[dict]: A list of dictionaries containing the inspection team details:
        - id (int): ID of the inspection team.
        - name (str): Name of the inspection team.</p>

<p>Example Response:
    [
        {
            "id": 1,
            "name": "Team A"
        },
        {
            "id": 2,
            "name": "Team B"
        }
    ]</p>
</div>


                </section>
                <section id="create_inspection_team">
                            <input id="create_inspection_team-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-app.post">@app.post(&#39;/inspection-teams/&#39;, response_model=InspectionTeamBase)</div>

        <span class="def">def</span>
        <span class="name">create_inspection_team</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">team</span><span class="p">:</span> <span class="n"><a href="models_pydantic.html#CreateInspectionTeam">Model.models_pydantic.CreateInspectionTeam</a></span>,</span><span class="param">	<span class="n">db</span><span class="p">:</span> <span class="n">sqlalchemy</span><span class="o">.</span><span class="n">orm</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">sessionmaker</span> <span class="o">=</span> <span class="n">Depends</span><span class="p">(</span><span class="n">get_db</span><span class="p">)</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="create_inspection_team-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#create_inspection_team"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="create_inspection_team-634"><a href="#create_inspection_team-634"><span class="linenos">634</span></a><span class="nd">@app</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="s2">&quot;/inspection-teams/&quot;</span><span class="p">,</span> <span class="n">response_model</span><span class="o">=</span><span class="n">InspectionTeamBase</span><span class="p">)</span>
</span><span id="create_inspection_team-635"><a href="#create_inspection_team-635"><span class="linenos">635</span></a><span class="k">def</span><span class="w"> </span><span class="nf">create_inspection_team</span><span class="p">(</span>
</span><span id="create_inspection_team-636"><a href="#create_inspection_team-636"><span class="linenos">636</span></a>    <span class="n">team</span><span class="p">:</span> <span class="n">CreateInspectionTeam</span><span class="p">,</span> <span class="n">db</span><span class="p">:</span> <span class="n">sessionmaker</span> <span class="o">=</span> <span class="n">Depends</span><span class="p">(</span><span class="n">get_db</span><span class="p">)</span>
</span><span id="create_inspection_team-637"><a href="#create_inspection_team-637"><span class="linenos">637</span></a><span class="p">):</span>
</span><span id="create_inspection_team-638"><a href="#create_inspection_team-638"><span class="linenos">638</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="create_inspection_team-639"><a href="#create_inspection_team-639"><span class="linenos">639</span></a><span class="sd">    Create a new inspection team.</span>
</span><span id="create_inspection_team-640"><a href="#create_inspection_team-640"><span class="linenos">640</span></a>
</span><span id="create_inspection_team-641"><a href="#create_inspection_team-641"><span class="linenos">641</span></a><span class="sd">    This endpoint allows for the creation of a new inspection team by providing its name.</span>
</span><span id="create_inspection_team-642"><a href="#create_inspection_team-642"><span class="linenos">642</span></a><span class="sd">    If the team name already exists, an error is raised.</span>
</span><span id="create_inspection_team-643"><a href="#create_inspection_team-643"><span class="linenos">643</span></a>
</span><span id="create_inspection_team-644"><a href="#create_inspection_team-644"><span class="linenos">644</span></a><span class="sd">    Args:</span>
</span><span id="create_inspection_team-645"><a href="#create_inspection_team-645"><span class="linenos">645</span></a><span class="sd">        team (CreateInspectionTeam): The data model containing the name of the inspection team.</span>
</span><span id="create_inspection_team-646"><a href="#create_inspection_team-646"><span class="linenos">646</span></a><span class="sd">        db (sessionmaker): The database session dependency injected by FastAPI.</span>
</span><span id="create_inspection_team-647"><a href="#create_inspection_team-647"><span class="linenos">647</span></a>
</span><span id="create_inspection_team-648"><a href="#create_inspection_team-648"><span class="linenos">648</span></a><span class="sd">    Raises:</span>
</span><span id="create_inspection_team-649"><a href="#create_inspection_team-649"><span class="linenos">649</span></a><span class="sd">        HTTPException: If the team name already exists or an error occurs during team creation.</span>
</span><span id="create_inspection_team-650"><a href="#create_inspection_team-650"><span class="linenos">650</span></a>
</span><span id="create_inspection_team-651"><a href="#create_inspection_team-651"><span class="linenos">651</span></a><span class="sd">    Returns:</span>
</span><span id="create_inspection_team-652"><a href="#create_inspection_team-652"><span class="linenos">652</span></a><span class="sd">        InspectionTeamBase: The newly created inspection team details.</span>
</span><span id="create_inspection_team-653"><a href="#create_inspection_team-653"><span class="linenos">653</span></a>
</span><span id="create_inspection_team-654"><a href="#create_inspection_team-654"><span class="linenos">654</span></a><span class="sd">    Example Request Body (JSON):</span>
</span><span id="create_inspection_team-655"><a href="#create_inspection_team-655"><span class="linenos">655</span></a><span class="sd">        {</span>
</span><span id="create_inspection_team-656"><a href="#create_inspection_team-656"><span class="linenos">656</span></a><span class="sd">            &quot;name&quot;: &quot;Team C&quot;</span>
</span><span id="create_inspection_team-657"><a href="#create_inspection_team-657"><span class="linenos">657</span></a><span class="sd">        }</span>
</span><span id="create_inspection_team-658"><a href="#create_inspection_team-658"><span class="linenos">658</span></a>
</span><span id="create_inspection_team-659"><a href="#create_inspection_team-659"><span class="linenos">659</span></a><span class="sd">    Example Response:</span>
</span><span id="create_inspection_team-660"><a href="#create_inspection_team-660"><span class="linenos">660</span></a><span class="sd">        {</span>
</span><span id="create_inspection_team-661"><a href="#create_inspection_team-661"><span class="linenos">661</span></a><span class="sd">            &quot;id&quot;: 3,</span>
</span><span id="create_inspection_team-662"><a href="#create_inspection_team-662"><span class="linenos">662</span></a><span class="sd">            &quot;name&quot;: &quot;Team C&quot;</span>
</span><span id="create_inspection_team-663"><a href="#create_inspection_team-663"><span class="linenos">663</span></a><span class="sd">        }</span>
</span><span id="create_inspection_team-664"><a href="#create_inspection_team-664"><span class="linenos">664</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="create_inspection_team-665"><a href="#create_inspection_team-665"><span class="linenos">665</span></a>
</span><span id="create_inspection_team-666"><a href="#create_inspection_team-666"><span class="linenos">666</span></a>    <span class="n">new_team</span> <span class="o">=</span> <span class="n">InspectionTeam</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">team</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="create_inspection_team-667"><a href="#create_inspection_team-667"><span class="linenos">667</span></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="create_inspection_team-668"><a href="#create_inspection_team-668"><span class="linenos">668</span></a>        <span class="n">db</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">new_team</span><span class="p">)</span>
</span><span id="create_inspection_team-669"><a href="#create_inspection_team-669"><span class="linenos">669</span></a>        <span class="n">db</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="create_inspection_team-670"><a href="#create_inspection_team-670"><span class="linenos">670</span></a>        <span class="n">db</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">new_team</span><span class="p">)</span>
</span><span id="create_inspection_team-671"><a href="#create_inspection_team-671"><span class="linenos">671</span></a>        <span class="k">return</span> <span class="n">new_team</span>
</span><span id="create_inspection_team-672"><a href="#create_inspection_team-672"><span class="linenos">672</span></a>    <span class="k">except</span> <span class="n">IntegrityError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="create_inspection_team-673"><a href="#create_inspection_team-673"><span class="linenos">673</span></a>        <span class="n">db</span><span class="o">.</span><span class="n">rollback</span><span class="p">()</span>
</span><span id="create_inspection_team-674"><a href="#create_inspection_team-674"><span class="linenos">674</span></a>        <span class="k">if</span> <span class="s2">&quot;inspectionteam_name_unique&quot;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">orig</span><span class="p">):</span>
</span><span id="create_inspection_team-675"><a href="#create_inspection_team-675"><span class="linenos">675</span></a>            <span class="k">raise</span> <span class="n">HTTPException</span><span class="p">(</span><span class="n">status_code</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> <span class="n">detail</span><span class="o">=</span><span class="s2">&quot;Team name already exists.&quot;</span><span class="p">)</span>
</span><span id="create_inspection_team-676"><a href="#create_inspection_team-676"><span class="linenos">676</span></a>        <span class="k">raise</span> <span class="n">HTTPException</span><span class="p">(</span>
</span><span id="create_inspection_team-677"><a href="#create_inspection_team-677"><span class="linenos">677</span></a>            <span class="n">status_code</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">detail</span><span class="o">=</span><span class="s2">&quot;An error occurred while creating the team.&quot;</span>
</span><span id="create_inspection_team-678"><a href="#create_inspection_team-678"><span class="linenos">678</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create a new inspection team.</p>

<p>This endpoint allows for the creation of a new inspection team by providing its name.
If the team name already exists, an error is raised.</p>

<p>Args:
    team (CreateInspectionTeam): The data model containing the name of the inspection team.
    db (sessionmaker): The database session dependency injected by FastAPI.</p>

<p>Raises:
    HTTPException: If the team name already exists or an error occurs during team creation.</p>

<p>Returns:
    InspectionTeamBase: The newly created inspection team details.</p>

<p>Example Request Body (JSON):
    {
        "name": "Team C"
    }</p>

<p>Example Response:
    {
        "id": 3,
        "name": "Team C"
    }</p>
</div>


                </section>
                <section id="view_inspection_team">
                            <input id="view_inspection_team-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-app.get">@app.get(&#39;/inspection-teams/{team_id}/&#39;, response_model=InspectionTeamBase)</div>

        <span class="def">def</span>
        <span class="name">view_inspection_team</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">team_id</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">db</span><span class="p">:</span> <span class="n">sqlalchemy</span><span class="o">.</span><span class="n">orm</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">sessionmaker</span> <span class="o">=</span> <span class="n">Depends</span><span class="p">(</span><span class="n">get_db</span><span class="p">)</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="view_inspection_team-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#view_inspection_team"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="view_inspection_team-681"><a href="#view_inspection_team-681"><span class="linenos">681</span></a><span class="nd">@app</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;/inspection-teams/</span><span class="si">{team_id}</span><span class="s2">/&quot;</span><span class="p">,</span> <span class="n">response_model</span><span class="o">=</span><span class="n">InspectionTeamBase</span><span class="p">)</span>
</span><span id="view_inspection_team-682"><a href="#view_inspection_team-682"><span class="linenos">682</span></a><span class="k">def</span><span class="w"> </span><span class="nf">view_inspection_team</span><span class="p">(</span><span class="n">team_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">db</span><span class="p">:</span> <span class="n">sessionmaker</span> <span class="o">=</span> <span class="n">Depends</span><span class="p">(</span><span class="n">get_db</span><span class="p">)):</span>
</span><span id="view_inspection_team-683"><a href="#view_inspection_team-683"><span class="linenos">683</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="view_inspection_team-684"><a href="#view_inspection_team-684"><span class="linenos">684</span></a><span class="sd">    View details of a specific inspection team.</span>
</span><span id="view_inspection_team-685"><a href="#view_inspection_team-685"><span class="linenos">685</span></a>
</span><span id="view_inspection_team-686"><a href="#view_inspection_team-686"><span class="linenos">686</span></a><span class="sd">    This endpoint retrieves the details of an inspection team, including its name and a list of teachers</span>
</span><span id="view_inspection_team-687"><a href="#view_inspection_team-687"><span class="linenos">687</span></a><span class="sd">    associated with the team.</span>
</span><span id="view_inspection_team-688"><a href="#view_inspection_team-688"><span class="linenos">688</span></a>
</span><span id="view_inspection_team-689"><a href="#view_inspection_team-689"><span class="linenos">689</span></a><span class="sd">    Args:</span>
</span><span id="view_inspection_team-690"><a href="#view_inspection_team-690"><span class="linenos">690</span></a><span class="sd">        team_id (int): The unique identifier of the inspection team.</span>
</span><span id="view_inspection_team-691"><a href="#view_inspection_team-691"><span class="linenos">691</span></a><span class="sd">        db (sessionmaker): The database session dependency injected by FastAPI.</span>
</span><span id="view_inspection_team-692"><a href="#view_inspection_team-692"><span class="linenos">692</span></a>
</span><span id="view_inspection_team-693"><a href="#view_inspection_team-693"><span class="linenos">693</span></a><span class="sd">    Raises:</span>
</span><span id="view_inspection_team-694"><a href="#view_inspection_team-694"><span class="linenos">694</span></a><span class="sd">        HTTPException: If the inspection team with the given ID is not found.</span>
</span><span id="view_inspection_team-695"><a href="#view_inspection_team-695"><span class="linenos">695</span></a>
</span><span id="view_inspection_team-696"><a href="#view_inspection_team-696"><span class="linenos">696</span></a><span class="sd">    Returns:</span>
</span><span id="view_inspection_team-697"><a href="#view_inspection_team-697"><span class="linenos">697</span></a><span class="sd">        InspectionTeamBase: The inspection team details along with a list of teachers:</span>
</span><span id="view_inspection_team-698"><a href="#view_inspection_team-698"><span class="linenos">698</span></a><span class="sd">            - id (int): The ID of the inspection team.</span>
</span><span id="view_inspection_team-699"><a href="#view_inspection_team-699"><span class="linenos">699</span></a><span class="sd">            - name (str): The name of the inspection team.</span>
</span><span id="view_inspection_team-700"><a href="#view_inspection_team-700"><span class="linenos">700</span></a><span class="sd">            - teachers (list[TeacherBase]): A list of teachers associated with the team, where each teacher</span>
</span><span id="view_inspection_team-701"><a href="#view_inspection_team-701"><span class="linenos">701</span></a><span class="sd">              includes their ID, name, surname, and title.</span>
</span><span id="view_inspection_team-702"><a href="#view_inspection_team-702"><span class="linenos">702</span></a>
</span><span id="view_inspection_team-703"><a href="#view_inspection_team-703"><span class="linenos">703</span></a><span class="sd">    Example Response:</span>
</span><span id="view_inspection_team-704"><a href="#view_inspection_team-704"><span class="linenos">704</span></a><span class="sd">        {</span>
</span><span id="view_inspection_team-705"><a href="#view_inspection_team-705"><span class="linenos">705</span></a><span class="sd">            &quot;id&quot;: 1,</span>
</span><span id="view_inspection_team-706"><a href="#view_inspection_team-706"><span class="linenos">706</span></a><span class="sd">            &quot;name&quot;: &quot;Team A&quot;,</span>
</span><span id="view_inspection_team-707"><a href="#view_inspection_team-707"><span class="linenos">707</span></a><span class="sd">            &quot;teachers&quot;: [</span>
</span><span id="view_inspection_team-708"><a href="#view_inspection_team-708"><span class="linenos">708</span></a><span class="sd">                {</span>
</span><span id="view_inspection_team-709"><a href="#view_inspection_team-709"><span class="linenos">709</span></a><span class="sd">                    &quot;id&quot;: 10,</span>
</span><span id="view_inspection_team-710"><a href="#view_inspection_team-710"><span class="linenos">710</span></a><span class="sd">                    &quot;name&quot;: &quot;Jane&quot;,</span>
</span><span id="view_inspection_team-711"><a href="#view_inspection_team-711"><span class="linenos">711</span></a><span class="sd">                    &quot;surname&quot;: &quot;Doe&quot;,</span>
</span><span id="view_inspection_team-712"><a href="#view_inspection_team-712"><span class="linenos">712</span></a><span class="sd">                    &quot;title&quot;: &quot;Dr.&quot;</span>
</span><span id="view_inspection_team-713"><a href="#view_inspection_team-713"><span class="linenos">713</span></a><span class="sd">                },</span>
</span><span id="view_inspection_team-714"><a href="#view_inspection_team-714"><span class="linenos">714</span></a><span class="sd">                {</span>
</span><span id="view_inspection_team-715"><a href="#view_inspection_team-715"><span class="linenos">715</span></a><span class="sd">                    &quot;id&quot;: 11,</span>
</span><span id="view_inspection_team-716"><a href="#view_inspection_team-716"><span class="linenos">716</span></a><span class="sd">                    &quot;name&quot;: &quot;John&quot;,</span>
</span><span id="view_inspection_team-717"><a href="#view_inspection_team-717"><span class="linenos">717</span></a><span class="sd">                    &quot;surname&quot;: &quot;Smith&quot;,</span>
</span><span id="view_inspection_team-718"><a href="#view_inspection_team-718"><span class="linenos">718</span></a><span class="sd">                    &quot;title&quot;: &quot;Prof.&quot;</span>
</span><span id="view_inspection_team-719"><a href="#view_inspection_team-719"><span class="linenos">719</span></a><span class="sd">                }</span>
</span><span id="view_inspection_team-720"><a href="#view_inspection_team-720"><span class="linenos">720</span></a><span class="sd">            ]</span>
</span><span id="view_inspection_team-721"><a href="#view_inspection_team-721"><span class="linenos">721</span></a><span class="sd">        }</span>
</span><span id="view_inspection_team-722"><a href="#view_inspection_team-722"><span class="linenos">722</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="view_inspection_team-723"><a href="#view_inspection_team-723"><span class="linenos">723</span></a>
</span><span id="view_inspection_team-724"><a href="#view_inspection_team-724"><span class="linenos">724</span></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="view_inspection_team-725"><a href="#view_inspection_team-725"><span class="linenos">725</span></a>        <span class="n">team</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">InspectionTeam</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">InspectionTeam</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">team_id</span><span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="view_inspection_team-726"><a href="#view_inspection_team-726"><span class="linenos">726</span></a>        <span class="n">teachers</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="view_inspection_team-727"><a href="#view_inspection_team-727"><span class="linenos">727</span></a>            <span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">Teacher</span><span class="p">)</span>
</span><span id="view_inspection_team-728"><a href="#view_inspection_team-728"><span class="linenos">728</span></a>            <span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">TeacherInspectionTeam</span><span class="p">)</span>
</span><span id="view_inspection_team-729"><a href="#view_inspection_team-729"><span class="linenos">729</span></a>            <span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">TeacherInspectionTeam</span><span class="o">.</span><span class="n">fk_inspectionTeam</span> <span class="o">==</span> <span class="n">team_id</span><span class="p">)</span>
</span><span id="view_inspection_team-730"><a href="#view_inspection_team-730"><span class="linenos">730</span></a>            <span class="o">.</span><span class="n">all</span><span class="p">()</span>
</span><span id="view_inspection_team-731"><a href="#view_inspection_team-731"><span class="linenos">731</span></a>        <span class="p">)</span>
</span><span id="view_inspection_team-732"><a href="#view_inspection_team-732"><span class="linenos">732</span></a>        <span class="k">return</span> <span class="n">InspectionTeamBase</span><span class="p">(</span>
</span><span id="view_inspection_team-733"><a href="#view_inspection_team-733"><span class="linenos">733</span></a>            <span class="nb">id</span><span class="o">=</span><span class="n">team</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
</span><span id="view_inspection_team-734"><a href="#view_inspection_team-734"><span class="linenos">734</span></a>            <span class="n">name</span><span class="o">=</span><span class="n">team</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="view_inspection_team-735"><a href="#view_inspection_team-735"><span class="linenos">735</span></a>            <span class="n">teachers</span><span class="o">=</span><span class="p">[</span>
</span><span id="view_inspection_team-736"><a href="#view_inspection_team-736"><span class="linenos">736</span></a>                <span class="n">TeacherBase</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">t</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">t</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">surname</span><span class="o">=</span><span class="n">t</span><span class="o">.</span><span class="n">surname</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">t</span><span class="o">.</span><span class="n">title</span><span class="p">)</span>
</span><span id="view_inspection_team-737"><a href="#view_inspection_team-737"><span class="linenos">737</span></a>                <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">teachers</span>
</span><span id="view_inspection_team-738"><a href="#view_inspection_team-738"><span class="linenos">738</span></a>            <span class="p">],</span>
</span><span id="view_inspection_team-739"><a href="#view_inspection_team-739"><span class="linenos">739</span></a>        <span class="p">)</span>
</span><span id="view_inspection_team-740"><a href="#view_inspection_team-740"><span class="linenos">740</span></a>    <span class="k">except</span> <span class="n">NoResultFound</span><span class="p">:</span>
</span><span id="view_inspection_team-741"><a href="#view_inspection_team-741"><span class="linenos">741</span></a>        <span class="k">raise</span> <span class="n">HTTPException</span><span class="p">(</span><span class="n">status_code</span><span class="o">=</span><span class="mi">404</span><span class="p">,</span> <span class="n">detail</span><span class="o">=</span><span class="s2">&quot;Inspection Team not found&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>View details of a specific inspection team.</p>

<p>This endpoint retrieves the details of an inspection team, including its name and a list of teachers
associated with the team.</p>

<p>Args:
    team_id (int): The unique identifier of the inspection team.
    db (sessionmaker): The database session dependency injected by FastAPI.</p>

<p>Raises:
    HTTPException: If the inspection team with the given ID is not found.</p>

<p>Returns:
    InspectionTeamBase: The inspection team details along with a list of teachers:
        - id (int): The ID of the inspection team.
        - name (str): The name of the inspection team.
        - teachers (list[TeacherBase]): A list of teachers associated with the team, where each teacher
          includes their ID, name, surname, and title.</p>

<p>Example Response:
    {
        "id": 1,
        "name": "Team A",
        "teachers": [
            {
                "id": 10,
                "name": "Jane",
                "surname": "Doe",
                "title": "Dr."
            },
            {
                "id": 11,
                "name": "John",
                "surname": "Smith",
                "title": "Prof."
            }
        ]
    }</p>
</div>


                </section>
                <section id="add_teacher_to_team">
                            <input id="add_teacher_to_team-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-app.post">@app.post(&#39;/inspection-teams/{team_id}/add-teacher/&#39;)</div>

        <span class="def">def</span>
        <span class="name">add_teacher_to_team</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">team_id</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">payload</span><span class="p">:</span> <span class="n"><a href="models_pydantic.html#AddTeacherToTeam">Model.models_pydantic.AddTeacherToTeam</a></span>,</span><span class="param">	<span class="n">db</span><span class="p">:</span> <span class="n">sqlalchemy</span><span class="o">.</span><span class="n">orm</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">sessionmaker</span> <span class="o">=</span> <span class="n">Depends</span><span class="p">(</span><span class="n">get_db</span><span class="p">)</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="add_teacher_to_team-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#add_teacher_to_team"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="add_teacher_to_team-744"><a href="#add_teacher_to_team-744"><span class="linenos">744</span></a><span class="nd">@app</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="s2">&quot;/inspection-teams/</span><span class="si">{team_id}</span><span class="s2">/add-teacher/&quot;</span><span class="p">)</span>
</span><span id="add_teacher_to_team-745"><a href="#add_teacher_to_team-745"><span class="linenos">745</span></a><span class="k">def</span><span class="w"> </span><span class="nf">add_teacher_to_team</span><span class="p">(</span>
</span><span id="add_teacher_to_team-746"><a href="#add_teacher_to_team-746"><span class="linenos">746</span></a>    <span class="n">team_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">payload</span><span class="p">:</span> <span class="n">AddTeacherToTeam</span><span class="p">,</span> <span class="n">db</span><span class="p">:</span> <span class="n">sessionmaker</span> <span class="o">=</span> <span class="n">Depends</span><span class="p">(</span><span class="n">get_db</span><span class="p">)</span>
</span><span id="add_teacher_to_team-747"><a href="#add_teacher_to_team-747"><span class="linenos">747</span></a><span class="p">):</span>
</span><span id="add_teacher_to_team-748"><a href="#add_teacher_to_team-748"><span class="linenos">748</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="add_teacher_to_team-749"><a href="#add_teacher_to_team-749"><span class="linenos">749</span></a><span class="sd">    Add a teacher to an inspection team.</span>
</span><span id="add_teacher_to_team-750"><a href="#add_teacher_to_team-750"><span class="linenos">750</span></a>
</span><span id="add_teacher_to_team-751"><a href="#add_teacher_to_team-751"><span class="linenos">751</span></a><span class="sd">    This endpoint assigns a teacher to a specific inspection team. If the teacher is already part of the team,</span>
</span><span id="add_teacher_to_team-752"><a href="#add_teacher_to_team-752"><span class="linenos">752</span></a><span class="sd">    an error is raised. If the teacher or the team is not found, a corresponding error message is returned.</span>
</span><span id="add_teacher_to_team-753"><a href="#add_teacher_to_team-753"><span class="linenos">753</span></a>
</span><span id="add_teacher_to_team-754"><a href="#add_teacher_to_team-754"><span class="linenos">754</span></a><span class="sd">    Args:</span>
</span><span id="add_teacher_to_team-755"><a href="#add_teacher_to_team-755"><span class="linenos">755</span></a><span class="sd">        team_id (int): The unique identifier of the inspection team.</span>
</span><span id="add_teacher_to_team-756"><a href="#add_teacher_to_team-756"><span class="linenos">756</span></a><span class="sd">        payload (AddTeacherToTeam): The data model containing the teacher&#39;s ID to be added to the team.</span>
</span><span id="add_teacher_to_team-757"><a href="#add_teacher_to_team-757"><span class="linenos">757</span></a><span class="sd">        db (sessionmaker): The database session dependency injected by FastAPI.</span>
</span><span id="add_teacher_to_team-758"><a href="#add_teacher_to_team-758"><span class="linenos">758</span></a>
</span><span id="add_teacher_to_team-759"><a href="#add_teacher_to_team-759"><span class="linenos">759</span></a><span class="sd">    Raises:</span>
</span><span id="add_teacher_to_team-760"><a href="#add_teacher_to_team-760"><span class="linenos">760</span></a><span class="sd">        HTTPException: If the inspection team or teacher is not found, or if the teacher is already assigned to the team,</span>
</span><span id="add_teacher_to_team-761"><a href="#add_teacher_to_team-761"><span class="linenos">761</span></a><span class="sd">        or if there is an issue adding the teacher to the team.</span>
</span><span id="add_teacher_to_team-762"><a href="#add_teacher_to_team-762"><span class="linenos">762</span></a>
</span><span id="add_teacher_to_team-763"><a href="#add_teacher_to_team-763"><span class="linenos">763</span></a><span class="sd">    Returns:</span>
</span><span id="add_teacher_to_team-764"><a href="#add_teacher_to_team-764"><span class="linenos">764</span></a><span class="sd">        dict: A success message indicating the teacher was added to the team.</span>
</span><span id="add_teacher_to_team-765"><a href="#add_teacher_to_team-765"><span class="linenos">765</span></a>
</span><span id="add_teacher_to_team-766"><a href="#add_teacher_to_team-766"><span class="linenos">766</span></a><span class="sd">    Example Request Body (JSON):</span>
</span><span id="add_teacher_to_team-767"><a href="#add_teacher_to_team-767"><span class="linenos">767</span></a><span class="sd">        {</span>
</span><span id="add_teacher_to_team-768"><a href="#add_teacher_to_team-768"><span class="linenos">768</span></a><span class="sd">            &quot;teacher_id&quot;: 5</span>
</span><span id="add_teacher_to_team-769"><a href="#add_teacher_to_team-769"><span class="linenos">769</span></a><span class="sd">        }</span>
</span><span id="add_teacher_to_team-770"><a href="#add_teacher_to_team-770"><span class="linenos">770</span></a>
</span><span id="add_teacher_to_team-771"><a href="#add_teacher_to_team-771"><span class="linenos">771</span></a><span class="sd">    Example Response:</span>
</span><span id="add_teacher_to_team-772"><a href="#add_teacher_to_team-772"><span class="linenos">772</span></a><span class="sd">        {</span>
</span><span id="add_teacher_to_team-773"><a href="#add_teacher_to_team-773"><span class="linenos">773</span></a><span class="sd">            &quot;message&quot;: &quot;Teacher added to the team successfully&quot;</span>
</span><span id="add_teacher_to_team-774"><a href="#add_teacher_to_team-774"><span class="linenos">774</span></a><span class="sd">        }</span>
</span><span id="add_teacher_to_team-775"><a href="#add_teacher_to_team-775"><span class="linenos">775</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="add_teacher_to_team-776"><a href="#add_teacher_to_team-776"><span class="linenos">776</span></a>
</span><span id="add_teacher_to_team-777"><a href="#add_teacher_to_team-777"><span class="linenos">777</span></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="add_teacher_to_team-778"><a href="#add_teacher_to_team-778"><span class="linenos">778</span></a>        <span class="n">team</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">InspectionTeam</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">InspectionTeam</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">team_id</span><span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="add_teacher_to_team-779"><a href="#add_teacher_to_team-779"><span class="linenos">779</span></a>    <span class="k">except</span> <span class="n">NoResultFound</span><span class="p">:</span>
</span><span id="add_teacher_to_team-780"><a href="#add_teacher_to_team-780"><span class="linenos">780</span></a>        <span class="k">raise</span> <span class="n">HTTPException</span><span class="p">(</span><span class="n">status_code</span><span class="o">=</span><span class="mi">404</span><span class="p">,</span> <span class="n">detail</span><span class="o">=</span><span class="s2">&quot;Inspection Team not found&quot;</span><span class="p">)</span>
</span><span id="add_teacher_to_team-781"><a href="#add_teacher_to_team-781"><span class="linenos">781</span></a>
</span><span id="add_teacher_to_team-782"><a href="#add_teacher_to_team-782"><span class="linenos">782</span></a>    <span class="n">teacher</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">Teacher</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">Teacher</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">payload</span><span class="o">.</span><span class="n">teacher_id</span><span class="p">)</span><span class="o">.</span><span class="n">one_or_none</span><span class="p">()</span>
</span><span id="add_teacher_to_team-783"><a href="#add_teacher_to_team-783"><span class="linenos">783</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">teacher</span><span class="p">:</span>
</span><span id="add_teacher_to_team-784"><a href="#add_teacher_to_team-784"><span class="linenos">784</span></a>        <span class="k">raise</span> <span class="n">HTTPException</span><span class="p">(</span><span class="n">status_code</span><span class="o">=</span><span class="mi">404</span><span class="p">,</span> <span class="n">detail</span><span class="o">=</span><span class="s2">&quot;Teacher not found&quot;</span><span class="p">)</span>
</span><span id="add_teacher_to_team-785"><a href="#add_teacher_to_team-785"><span class="linenos">785</span></a>
</span><span id="add_teacher_to_team-786"><a href="#add_teacher_to_team-786"><span class="linenos">786</span></a>    <span class="n">existing_assignment</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="add_teacher_to_team-787"><a href="#add_teacher_to_team-787"><span class="linenos">787</span></a>        <span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">TeacherInspectionTeam</span><span class="p">)</span>
</span><span id="add_teacher_to_team-788"><a href="#add_teacher_to_team-788"><span class="linenos">788</span></a>        <span class="o">.</span><span class="n">filter</span><span class="p">(</span>
</span><span id="add_teacher_to_team-789"><a href="#add_teacher_to_team-789"><span class="linenos">789</span></a>            <span class="n">TeacherInspectionTeam</span><span class="o">.</span><span class="n">fk_teacher</span> <span class="o">==</span> <span class="n">payload</span><span class="o">.</span><span class="n">teacher_id</span><span class="p">,</span>
</span><span id="add_teacher_to_team-790"><a href="#add_teacher_to_team-790"><span class="linenos">790</span></a>            <span class="n">TeacherInspectionTeam</span><span class="o">.</span><span class="n">fk_inspectionTeam</span> <span class="o">==</span> <span class="n">team_id</span><span class="p">,</span>
</span><span id="add_teacher_to_team-791"><a href="#add_teacher_to_team-791"><span class="linenos">791</span></a>        <span class="p">)</span>
</span><span id="add_teacher_to_team-792"><a href="#add_teacher_to_team-792"><span class="linenos">792</span></a>        <span class="o">.</span><span class="n">one_or_none</span><span class="p">()</span>
</span><span id="add_teacher_to_team-793"><a href="#add_teacher_to_team-793"><span class="linenos">793</span></a>    <span class="p">)</span>
</span><span id="add_teacher_to_team-794"><a href="#add_teacher_to_team-794"><span class="linenos">794</span></a>
</span><span id="add_teacher_to_team-795"><a href="#add_teacher_to_team-795"><span class="linenos">795</span></a>    <span class="k">if</span> <span class="n">existing_assignment</span><span class="p">:</span>
</span><span id="add_teacher_to_team-796"><a href="#add_teacher_to_team-796"><span class="linenos">796</span></a>        <span class="k">raise</span> <span class="n">HTTPException</span><span class="p">(</span><span class="n">status_code</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> <span class="n">detail</span><span class="o">=</span><span class="s2">&quot;Teacher is already in the team&quot;</span><span class="p">)</span>
</span><span id="add_teacher_to_team-797"><a href="#add_teacher_to_team-797"><span class="linenos">797</span></a>
</span><span id="add_teacher_to_team-798"><a href="#add_teacher_to_team-798"><span class="linenos">798</span></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="add_teacher_to_team-799"><a href="#add_teacher_to_team-799"><span class="linenos">799</span></a>        <span class="n">assignment</span> <span class="o">=</span> <span class="n">TeacherInspectionTeam</span><span class="p">(</span>
</span><span id="add_teacher_to_team-800"><a href="#add_teacher_to_team-800"><span class="linenos">800</span></a>            <span class="n">fk_teacher</span><span class="o">=</span><span class="n">payload</span><span class="o">.</span><span class="n">teacher_id</span><span class="p">,</span> <span class="n">fk_inspectionTeam</span><span class="o">=</span><span class="n">team_id</span>
</span><span id="add_teacher_to_team-801"><a href="#add_teacher_to_team-801"><span class="linenos">801</span></a>        <span class="p">)</span>
</span><span id="add_teacher_to_team-802"><a href="#add_teacher_to_team-802"><span class="linenos">802</span></a>        <span class="n">db</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">assignment</span><span class="p">)</span>
</span><span id="add_teacher_to_team-803"><a href="#add_teacher_to_team-803"><span class="linenos">803</span></a>        <span class="n">db</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="add_teacher_to_team-804"><a href="#add_teacher_to_team-804"><span class="linenos">804</span></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="add_teacher_to_team-805"><a href="#add_teacher_to_team-805"><span class="linenos">805</span></a>        <span class="k">raise</span> <span class="n">HTTPException</span><span class="p">(</span>
</span><span id="add_teacher_to_team-806"><a href="#add_teacher_to_team-806"><span class="linenos">806</span></a>            <span class="n">status_code</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span>
</span><span id="add_teacher_to_team-807"><a href="#add_teacher_to_team-807"><span class="linenos">807</span></a>            <span class="n">detail</span><span class="o">=</span><span class="s2">&quot;Unable to add teacher ot the team, is the team full?&quot;</span><span class="p">,</span>
</span><span id="add_teacher_to_team-808"><a href="#add_teacher_to_team-808"><span class="linenos">808</span></a>        <span class="p">)</span>
</span><span id="add_teacher_to_team-809"><a href="#add_teacher_to_team-809"><span class="linenos">809</span></a>
</span><span id="add_teacher_to_team-810"><a href="#add_teacher_to_team-810"><span class="linenos">810</span></a>    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;Teacher added to the team successfully&quot;</span><span class="p">}</span>
</span></pre></div>


            <div class="docstring"><p>Add a teacher to an inspection team.</p>

<p>This endpoint assigns a teacher to a specific inspection team. If the teacher is already part of the team,
an error is raised. If the teacher or the team is not found, a corresponding error message is returned.</p>

<p>Args:
    team_id (int): The unique identifier of the inspection team.
    payload (AddTeacherToTeam): The data model containing the teacher's ID to be added to the team.
    db (sessionmaker): The database session dependency injected by FastAPI.</p>

<p>Raises:
    HTTPException: If the inspection team or teacher is not found, or if the teacher is already assigned to the team,
    or if there is an issue adding the teacher to the team.</p>

<p>Returns:
    dict: A success message indicating the teacher was added to the team.</p>

<p>Example Request Body (JSON):
    {
        "teacher_id": 5
    }</p>

<p>Example Response:
    {
        "message": "Teacher added to the team successfully"
    }</p>
</div>


                </section>
                <section id="get_specified_inspection_teams">
                            <input id="get_specified_inspection_teams-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-app.get">@app.get(&#39;/inspection-teams/{teacher_id}/{lesson_id}/&#39;)</div>

        <span class="def">def</span>
        <span class="name">get_specified_inspection_teams</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">teacher_id</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">lesson_id</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">db</span><span class="p">:</span> <span class="n">sqlalchemy</span><span class="o">.</span><span class="n">orm</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">sessionmaker</span> <span class="o">=</span> <span class="n">Depends</span><span class="p">(</span><span class="n">get_db</span><span class="p">)</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="get_specified_inspection_teams-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#get_specified_inspection_teams"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="get_specified_inspection_teams-867"><a href="#get_specified_inspection_teams-867"><span class="linenos">867</span></a><span class="nd">@app</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;/inspection-teams/</span><span class="si">{teacher_id}</span><span class="s2">/</span><span class="si">{lesson_id}</span><span class="s2">/&quot;</span><span class="p">)</span>
</span><span id="get_specified_inspection_teams-868"><a href="#get_specified_inspection_teams-868"><span class="linenos">868</span></a><span class="k">def</span><span class="w"> </span><span class="nf">get_specified_inspection_teams</span><span class="p">(</span>
</span><span id="get_specified_inspection_teams-869"><a href="#get_specified_inspection_teams-869"><span class="linenos">869</span></a>    <span class="n">teacher_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">lesson_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">db</span><span class="p">:</span> <span class="n">sessionmaker</span> <span class="o">=</span> <span class="n">Depends</span><span class="p">(</span><span class="n">get_db</span><span class="p">)</span>
</span><span id="get_specified_inspection_teams-870"><a href="#get_specified_inspection_teams-870"><span class="linenos">870</span></a><span class="p">):</span>
</span><span id="get_specified_inspection_teams-871"><a href="#get_specified_inspection_teams-871"><span class="linenos">871</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="get_specified_inspection_teams-872"><a href="#get_specified_inspection_teams-872"><span class="linenos">872</span></a><span class="sd">    Get available inspection teams for a specified teacher and lesson.</span>
</span><span id="get_specified_inspection_teams-873"><a href="#get_specified_inspection_teams-873"><span class="linenos">873</span></a>
</span><span id="get_specified_inspection_teams-874"><a href="#get_specified_inspection_teams-874"><span class="linenos">874</span></a><span class="sd">    This endpoint retrieves inspection teams that are available to participate in an inspection for a specific</span>
</span><span id="get_specified_inspection_teams-875"><a href="#get_specified_inspection_teams-875"><span class="linenos">875</span></a><span class="sd">    lesson, excluding teams that already have scheduling conflicts or teams with more than one member from the</span>
</span><span id="get_specified_inspection_teams-876"><a href="#get_specified_inspection_teams-876"><span class="linenos">876</span></a><span class="sd">    teacher&#39;s department.</span>
</span><span id="get_specified_inspection_teams-877"><a href="#get_specified_inspection_teams-877"><span class="linenos">877</span></a>
</span><span id="get_specified_inspection_teams-878"><a href="#get_specified_inspection_teams-878"><span class="linenos">878</span></a><span class="sd">    Args:</span>
</span><span id="get_specified_inspection_teams-879"><a href="#get_specified_inspection_teams-879"><span class="linenos">879</span></a><span class="sd">        teacher_id (int): The unique identifier of the teacher who is being inspected.</span>
</span><span id="get_specified_inspection_teams-880"><a href="#get_specified_inspection_teams-880"><span class="linenos">880</span></a><span class="sd">        lesson_id (int): The unique identifier of the lesson being inspected.</span>
</span><span id="get_specified_inspection_teams-881"><a href="#get_specified_inspection_teams-881"><span class="linenos">881</span></a><span class="sd">        db (sessionmaker): The database session dependency injected by FastAPI.</span>
</span><span id="get_specified_inspection_teams-882"><a href="#get_specified_inspection_teams-882"><span class="linenos">882</span></a>
</span><span id="get_specified_inspection_teams-883"><a href="#get_specified_inspection_teams-883"><span class="linenos">883</span></a><span class="sd">    Raises:</span>
</span><span id="get_specified_inspection_teams-884"><a href="#get_specified_inspection_teams-884"><span class="linenos">884</span></a><span class="sd">        HTTPException: If the lesson or the inspected teacher is not found.</span>
</span><span id="get_specified_inspection_teams-885"><a href="#get_specified_inspection_teams-885"><span class="linenos">885</span></a>
</span><span id="get_specified_inspection_teams-886"><a href="#get_specified_inspection_teams-886"><span class="linenos">886</span></a><span class="sd">    Returns:</span>
</span><span id="get_specified_inspection_teams-887"><a href="#get_specified_inspection_teams-887"><span class="linenos">887</span></a><span class="sd">        list[dict]: A list of inspection teams that are available for the specified lesson, including the team name</span>
</span><span id="get_specified_inspection_teams-888"><a href="#get_specified_inspection_teams-888"><span class="linenos">888</span></a><span class="sd">            and members that do not have scheduling conflicts, with no more than one member from the inspected teacher&#39;s department.</span>
</span><span id="get_specified_inspection_teams-889"><a href="#get_specified_inspection_teams-889"><span class="linenos">889</span></a>
</span><span id="get_specified_inspection_teams-890"><a href="#get_specified_inspection_teams-890"><span class="linenos">890</span></a><span class="sd">    Example Response:</span>
</span><span id="get_specified_inspection_teams-891"><a href="#get_specified_inspection_teams-891"><span class="linenos">891</span></a><span class="sd">        [</span>
</span><span id="get_specified_inspection_teams-892"><a href="#get_specified_inspection_teams-892"><span class="linenos">892</span></a><span class="sd">            {</span>
</span><span id="get_specified_inspection_teams-893"><a href="#get_specified_inspection_teams-893"><span class="linenos">893</span></a><span class="sd">                &quot;inspection_team_id&quot;: 1,</span>
</span><span id="get_specified_inspection_teams-894"><a href="#get_specified_inspection_teams-894"><span class="linenos">894</span></a><span class="sd">                &quot;inspection_team_name&quot;: &quot;Team A&quot;,</span>
</span><span id="get_specified_inspection_teams-895"><a href="#get_specified_inspection_teams-895"><span class="linenos">895</span></a><span class="sd">                &quot;members&quot;: [</span>
</span><span id="get_specified_inspection_teams-896"><a href="#get_specified_inspection_teams-896"><span class="linenos">896</span></a><span class="sd">                    {</span>
</span><span id="get_specified_inspection_teams-897"><a href="#get_specified_inspection_teams-897"><span class="linenos">897</span></a><span class="sd">                        &quot;teacher_id&quot;: 3,</span>
</span><span id="get_specified_inspection_teams-898"><a href="#get_specified_inspection_teams-898"><span class="linenos">898</span></a><span class="sd">                        &quot;teacher_name&quot;: &quot;Alice&quot;,</span>
</span><span id="get_specified_inspection_teams-899"><a href="#get_specified_inspection_teams-899"><span class="linenos">899</span></a><span class="sd">                        &quot;teacher_surname&quot;: &quot;Johnson&quot;,</span>
</span><span id="get_specified_inspection_teams-900"><a href="#get_specified_inspection_teams-900"><span class="linenos">900</span></a><span class="sd">                        &quot;teacher_title&quot;: &quot;Dr.&quot;,</span>
</span><span id="get_specified_inspection_teams-901"><a href="#get_specified_inspection_teams-901"><span class="linenos">901</span></a><span class="sd">                        &quot;teacher_department&quot;: &quot;Math&quot;</span>
</span><span id="get_specified_inspection_teams-902"><a href="#get_specified_inspection_teams-902"><span class="linenos">902</span></a><span class="sd">                    },</span>
</span><span id="get_specified_inspection_teams-903"><a href="#get_specified_inspection_teams-903"><span class="linenos">903</span></a><span class="sd">                    {</span>
</span><span id="get_specified_inspection_teams-904"><a href="#get_specified_inspection_teams-904"><span class="linenos">904</span></a><span class="sd">                        &quot;teacher_id&quot;: 4,</span>
</span><span id="get_specified_inspection_teams-905"><a href="#get_specified_inspection_teams-905"><span class="linenos">905</span></a><span class="sd">                        &quot;teacher_name&quot;: &quot;Bob&quot;,</span>
</span><span id="get_specified_inspection_teams-906"><a href="#get_specified_inspection_teams-906"><span class="linenos">906</span></a><span class="sd">                        &quot;teacher_surname&quot;: &quot;Lee&quot;,</span>
</span><span id="get_specified_inspection_teams-907"><a href="#get_specified_inspection_teams-907"><span class="linenos">907</span></a><span class="sd">                        &quot;teacher_title&quot;: &quot;Prof.&quot;,</span>
</span><span id="get_specified_inspection_teams-908"><a href="#get_specified_inspection_teams-908"><span class="linenos">908</span></a><span class="sd">                        &quot;teacher_department&quot;: &quot;Physics&quot;</span>
</span><span id="get_specified_inspection_teams-909"><a href="#get_specified_inspection_teams-909"><span class="linenos">909</span></a><span class="sd">                    }</span>
</span><span id="get_specified_inspection_teams-910"><a href="#get_specified_inspection_teams-910"><span class="linenos">910</span></a><span class="sd">                ]</span>
</span><span id="get_specified_inspection_teams-911"><a href="#get_specified_inspection_teams-911"><span class="linenos">911</span></a><span class="sd">            }</span>
</span><span id="get_specified_inspection_teams-912"><a href="#get_specified_inspection_teams-912"><span class="linenos">912</span></a><span class="sd">        ]</span>
</span><span id="get_specified_inspection_teams-913"><a href="#get_specified_inspection_teams-913"><span class="linenos">913</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="get_specified_inspection_teams-914"><a href="#get_specified_inspection_teams-914"><span class="linenos">914</span></a>
</span><span id="get_specified_inspection_teams-915"><a href="#get_specified_inspection_teams-915"><span class="linenos">915</span></a>    <span class="n">lesson</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">Lesson</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">Lesson</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">lesson_id</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
</span><span id="get_specified_inspection_teams-916"><a href="#get_specified_inspection_teams-916"><span class="linenos">916</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">lesson</span><span class="p">:</span>
</span><span id="get_specified_inspection_teams-917"><a href="#get_specified_inspection_teams-917"><span class="linenos">917</span></a>        <span class="k">raise</span> <span class="n">HTTPException</span><span class="p">(</span><span class="n">status_code</span><span class="o">=</span><span class="mi">404</span><span class="p">,</span> <span class="n">detail</span><span class="o">=</span><span class="s2">&quot;Lesson not found.&quot;</span><span class="p">)</span>
</span><span id="get_specified_inspection_teams-918"><a href="#get_specified_inspection_teams-918"><span class="linenos">918</span></a>
</span><span id="get_specified_inspection_teams-919"><a href="#get_specified_inspection_teams-919"><span class="linenos">919</span></a>    <span class="n">inspected_teacher</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">Teacher</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">Teacher</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">teacher_id</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
</span><span id="get_specified_inspection_teams-920"><a href="#get_specified_inspection_teams-920"><span class="linenos">920</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">inspected_teacher</span><span class="p">:</span>
</span><span id="get_specified_inspection_teams-921"><a href="#get_specified_inspection_teams-921"><span class="linenos">921</span></a>        <span class="k">raise</span> <span class="n">HTTPException</span><span class="p">(</span><span class="n">status_code</span><span class="o">=</span><span class="mi">404</span><span class="p">,</span> <span class="n">detail</span><span class="o">=</span><span class="s2">&quot;Inspected teacher not found.&quot;</span><span class="p">)</span>
</span><span id="get_specified_inspection_teams-922"><a href="#get_specified_inspection_teams-922"><span class="linenos">922</span></a>
</span><span id="get_specified_inspection_teams-923"><a href="#get_specified_inspection_teams-923"><span class="linenos">923</span></a>    <span class="n">inspected_department</span> <span class="o">=</span> <span class="n">inspected_teacher</span><span class="o">.</span><span class="n">department</span>
</span><span id="get_specified_inspection_teams-924"><a href="#get_specified_inspection_teams-924"><span class="linenos">924</span></a>
</span><span id="get_specified_inspection_teams-925"><a href="#get_specified_inspection_teams-925"><span class="linenos">925</span></a>    <span class="n">subquery</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="get_specified_inspection_teams-926"><a href="#get_specified_inspection_teams-926"><span class="linenos">926</span></a>        <span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">TeacherInspectionTeam</span><span class="o">.</span><span class="n">fk_inspectionTeam</span><span class="p">)</span>
</span><span id="get_specified_inspection_teams-927"><a href="#get_specified_inspection_teams-927"><span class="linenos">927</span></a>        <span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">TeacherInspectionTeam</span><span class="o">.</span><span class="n">fk_teacher</span> <span class="o">==</span> <span class="n">teacher_id</span><span class="p">)</span>
</span><span id="get_specified_inspection_teams-928"><a href="#get_specified_inspection_teams-928"><span class="linenos">928</span></a>        <span class="o">.</span><span class="n">subquery</span><span class="p">()</span>
</span><span id="get_specified_inspection_teams-929"><a href="#get_specified_inspection_teams-929"><span class="linenos">929</span></a>    <span class="p">)</span>
</span><span id="get_specified_inspection_teams-930"><a href="#get_specified_inspection_teams-930"><span class="linenos">930</span></a>
</span><span id="get_specified_inspection_teams-931"><a href="#get_specified_inspection_teams-931"><span class="linenos">931</span></a>    <span class="n">inspection_teams</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="get_specified_inspection_teams-932"><a href="#get_specified_inspection_teams-932"><span class="linenos">932</span></a>        <span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">InspectionTeam</span><span class="p">)</span>
</span><span id="get_specified_inspection_teams-933"><a href="#get_specified_inspection_teams-933"><span class="linenos">933</span></a>        <span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="get_specified_inspection_teams-934"><a href="#get_specified_inspection_teams-934"><span class="linenos">934</span></a>            <span class="n">TeacherInspectionTeam</span><span class="p">,</span>
</span><span id="get_specified_inspection_teams-935"><a href="#get_specified_inspection_teams-935"><span class="linenos">935</span></a>            <span class="n">TeacherInspectionTeam</span><span class="o">.</span><span class="n">fk_inspectionTeam</span> <span class="o">==</span> <span class="n">InspectionTeam</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
</span><span id="get_specified_inspection_teams-936"><a href="#get_specified_inspection_teams-936"><span class="linenos">936</span></a>        <span class="p">)</span>
</span><span id="get_specified_inspection_teams-937"><a href="#get_specified_inspection_teams-937"><span class="linenos">937</span></a>        <span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">InspectionTeam</span><span class="o">.</span><span class="n">id</span><span class="o">.</span><span class="n">notin_</span><span class="p">(</span><span class="n">subquery</span><span class="o">.</span><span class="n">select</span><span class="p">()))</span>
</span><span id="get_specified_inspection_teams-938"><a href="#get_specified_inspection_teams-938"><span class="linenos">938</span></a>        <span class="o">.</span><span class="n">all</span><span class="p">()</span>
</span><span id="get_specified_inspection_teams-939"><a href="#get_specified_inspection_teams-939"><span class="linenos">939</span></a>    <span class="p">)</span>
</span><span id="get_specified_inspection_teams-940"><a href="#get_specified_inspection_teams-940"><span class="linenos">940</span></a>
</span><span id="get_specified_inspection_teams-941"><a href="#get_specified_inspection_teams-941"><span class="linenos">941</span></a>    <span class="n">available_teams</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="get_specified_inspection_teams-942"><a href="#get_specified_inspection_teams-942"><span class="linenos">942</span></a>
</span><span id="get_specified_inspection_teams-943"><a href="#get_specified_inspection_teams-943"><span class="linenos">943</span></a>    <span class="k">for</span> <span class="n">team</span> <span class="ow">in</span> <span class="n">inspection_teams</span><span class="p">:</span>
</span><span id="get_specified_inspection_teams-944"><a href="#get_specified_inspection_teams-944"><span class="linenos">944</span></a>        <span class="n">department_count</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="get_specified_inspection_teams-945"><a href="#get_specified_inspection_teams-945"><span class="linenos">945</span></a>        <span class="n">available_members</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="get_specified_inspection_teams-946"><a href="#get_specified_inspection_teams-946"><span class="linenos">946</span></a>
</span><span id="get_specified_inspection_teams-947"><a href="#get_specified_inspection_teams-947"><span class="linenos">947</span></a>        <span class="k">for</span> <span class="n">member</span> <span class="ow">in</span> <span class="n">team</span><span class="o">.</span><span class="n">teachers</span><span class="p">:</span>
</span><span id="get_specified_inspection_teams-948"><a href="#get_specified_inspection_teams-948"><span class="linenos">948</span></a>            <span class="n">member_lessons</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="get_specified_inspection_teams-949"><a href="#get_specified_inspection_teams-949"><span class="linenos">949</span></a>                <span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">Lesson</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">Lesson</span><span class="o">.</span><span class="n">fk_teacher</span> <span class="o">==</span> <span class="n">member</span><span class="o">.</span><span class="n">fk_teacher</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
</span><span id="get_specified_inspection_teams-950"><a href="#get_specified_inspection_teams-950"><span class="linenos">950</span></a>            <span class="p">)</span>
</span><span id="get_specified_inspection_teams-951"><a href="#get_specified_inspection_teams-951"><span class="linenos">951</span></a>            <span class="n">member_inspections</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="get_specified_inspection_teams-952"><a href="#get_specified_inspection_teams-952"><span class="linenos">952</span></a>                <span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">Lesson</span><span class="p">)</span>
</span><span id="get_specified_inspection_teams-953"><a href="#get_specified_inspection_teams-953"><span class="linenos">953</span></a>                <span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">Inspection</span><span class="p">,</span> <span class="n">Inspection</span><span class="o">.</span><span class="n">fk_lesson</span> <span class="o">==</span> <span class="n">Lesson</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
</span><span id="get_specified_inspection_teams-954"><a href="#get_specified_inspection_teams-954"><span class="linenos">954</span></a>                <span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="get_specified_inspection_teams-955"><a href="#get_specified_inspection_teams-955"><span class="linenos">955</span></a>                    <span class="n">TeacherInspectionTeam</span><span class="p">,</span>
</span><span id="get_specified_inspection_teams-956"><a href="#get_specified_inspection_teams-956"><span class="linenos">956</span></a>                    <span class="n">TeacherInspectionTeam</span><span class="o">.</span><span class="n">fk_inspectionTeam</span> <span class="o">==</span> <span class="n">Inspection</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
</span><span id="get_specified_inspection_teams-957"><a href="#get_specified_inspection_teams-957"><span class="linenos">957</span></a>                <span class="p">)</span>
</span><span id="get_specified_inspection_teams-958"><a href="#get_specified_inspection_teams-958"><span class="linenos">958</span></a>                <span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">TeacherInspectionTeam</span><span class="o">.</span><span class="n">fk_teacher</span> <span class="o">==</span> <span class="n">member</span><span class="o">.</span><span class="n">fk_teacher</span><span class="p">)</span>
</span><span id="get_specified_inspection_teams-959"><a href="#get_specified_inspection_teams-959"><span class="linenos">959</span></a>                <span class="o">.</span><span class="n">all</span><span class="p">()</span>
</span><span id="get_specified_inspection_teams-960"><a href="#get_specified_inspection_teams-960"><span class="linenos">960</span></a>            <span class="p">)</span>
</span><span id="get_specified_inspection_teams-961"><a href="#get_specified_inspection_teams-961"><span class="linenos">961</span></a>
</span><span id="get_specified_inspection_teams-962"><a href="#get_specified_inspection_teams-962"><span class="linenos">962</span></a>            <span class="n">conflict_found</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
</span><span id="get_specified_inspection_teams-963"><a href="#get_specified_inspection_teams-963"><span class="linenos">963</span></a>                <span class="n">lesson</span><span class="o">.</span><span class="n">time</span> <span class="o">==</span> <span class="n">scheduled_lesson</span><span class="o">.</span><span class="n">time</span>
</span><span id="get_specified_inspection_teams-964"><a href="#get_specified_inspection_teams-964"><span class="linenos">964</span></a>                <span class="k">for</span> <span class="n">scheduled_lesson</span> <span class="ow">in</span> <span class="n">member_lessons</span> <span class="o">+</span> <span class="n">member_inspections</span>
</span><span id="get_specified_inspection_teams-965"><a href="#get_specified_inspection_teams-965"><span class="linenos">965</span></a>            <span class="p">)</span>
</span><span id="get_specified_inspection_teams-966"><a href="#get_specified_inspection_teams-966"><span class="linenos">966</span></a>            <span class="k">if</span> <span class="n">conflict_found</span><span class="p">:</span>
</span><span id="get_specified_inspection_teams-967"><a href="#get_specified_inspection_teams-967"><span class="linenos">967</span></a>                <span class="k">continue</span>
</span><span id="get_specified_inspection_teams-968"><a href="#get_specified_inspection_teams-968"><span class="linenos">968</span></a>
</span><span id="get_specified_inspection_teams-969"><a href="#get_specified_inspection_teams-969"><span class="linenos">969</span></a>            <span class="k">if</span> <span class="n">member</span><span class="o">.</span><span class="n">teacher</span><span class="o">.</span><span class="n">department</span> <span class="o">==</span> <span class="n">inspected_department</span><span class="p">:</span>
</span><span id="get_specified_inspection_teams-970"><a href="#get_specified_inspection_teams-970"><span class="linenos">970</span></a>                <span class="n">department_count</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="get_specified_inspection_teams-971"><a href="#get_specified_inspection_teams-971"><span class="linenos">971</span></a>                <span class="k">if</span> <span class="n">department_count</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="get_specified_inspection_teams-972"><a href="#get_specified_inspection_teams-972"><span class="linenos">972</span></a>                    <span class="k">break</span>
</span><span id="get_specified_inspection_teams-973"><a href="#get_specified_inspection_teams-973"><span class="linenos">973</span></a>
</span><span id="get_specified_inspection_teams-974"><a href="#get_specified_inspection_teams-974"><span class="linenos">974</span></a>            <span class="n">available_members</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="get_specified_inspection_teams-975"><a href="#get_specified_inspection_teams-975"><span class="linenos">975</span></a>                <span class="p">{</span>
</span><span id="get_specified_inspection_teams-976"><a href="#get_specified_inspection_teams-976"><span class="linenos">976</span></a>                    <span class="s2">&quot;teacher_id&quot;</span><span class="p">:</span> <span class="n">member</span><span class="o">.</span><span class="n">teacher</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
</span><span id="get_specified_inspection_teams-977"><a href="#get_specified_inspection_teams-977"><span class="linenos">977</span></a>                    <span class="s2">&quot;teacher_name&quot;</span><span class="p">:</span> <span class="n">member</span><span class="o">.</span><span class="n">teacher</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="get_specified_inspection_teams-978"><a href="#get_specified_inspection_teams-978"><span class="linenos">978</span></a>                    <span class="s2">&quot;teacher_surname&quot;</span><span class="p">:</span> <span class="n">member</span><span class="o">.</span><span class="n">teacher</span><span class="o">.</span><span class="n">surname</span><span class="p">,</span>
</span><span id="get_specified_inspection_teams-979"><a href="#get_specified_inspection_teams-979"><span class="linenos">979</span></a>                    <span class="s2">&quot;teacher_title&quot;</span><span class="p">:</span> <span class="n">member</span><span class="o">.</span><span class="n">teacher</span><span class="o">.</span><span class="n">title</span><span class="p">,</span>
</span><span id="get_specified_inspection_teams-980"><a href="#get_specified_inspection_teams-980"><span class="linenos">980</span></a>                    <span class="s2">&quot;teacher_department&quot;</span><span class="p">:</span> <span class="n">member</span><span class="o">.</span><span class="n">teacher</span><span class="o">.</span><span class="n">department</span><span class="p">,</span>
</span><span id="get_specified_inspection_teams-981"><a href="#get_specified_inspection_teams-981"><span class="linenos">981</span></a>                <span class="p">}</span>
</span><span id="get_specified_inspection_teams-982"><a href="#get_specified_inspection_teams-982"><span class="linenos">982</span></a>            <span class="p">)</span>
</span><span id="get_specified_inspection_teams-983"><a href="#get_specified_inspection_teams-983"><span class="linenos">983</span></a>
</span><span id="get_specified_inspection_teams-984"><a href="#get_specified_inspection_teams-984"><span class="linenos">984</span></a>        <span class="k">if</span> <span class="n">available_members</span> <span class="ow">and</span> <span class="n">department_count</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="get_specified_inspection_teams-985"><a href="#get_specified_inspection_teams-985"><span class="linenos">985</span></a>            <span class="n">available_teams</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="get_specified_inspection_teams-986"><a href="#get_specified_inspection_teams-986"><span class="linenos">986</span></a>                <span class="p">{</span>
</span><span id="get_specified_inspection_teams-987"><a href="#get_specified_inspection_teams-987"><span class="linenos">987</span></a>                    <span class="s2">&quot;inspection_team_id&quot;</span><span class="p">:</span> <span class="n">team</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
</span><span id="get_specified_inspection_teams-988"><a href="#get_specified_inspection_teams-988"><span class="linenos">988</span></a>                    <span class="s2">&quot;inspection_team_name&quot;</span><span class="p">:</span> <span class="n">team</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="get_specified_inspection_teams-989"><a href="#get_specified_inspection_teams-989"><span class="linenos">989</span></a>                    <span class="s2">&quot;members&quot;</span><span class="p">:</span> <span class="n">available_members</span><span class="p">,</span>
</span><span id="get_specified_inspection_teams-990"><a href="#get_specified_inspection_teams-990"><span class="linenos">990</span></a>                <span class="p">}</span>
</span><span id="get_specified_inspection_teams-991"><a href="#get_specified_inspection_teams-991"><span class="linenos">991</span></a>            <span class="p">)</span>
</span><span id="get_specified_inspection_teams-992"><a href="#get_specified_inspection_teams-992"><span class="linenos">992</span></a>
</span><span id="get_specified_inspection_teams-993"><a href="#get_specified_inspection_teams-993"><span class="linenos">993</span></a>    <span class="k">return</span> <span class="n">available_teams</span> <span class="k">if</span> <span class="n">available_teams</span> <span class="k">else</span> <span class="p">[]</span>
</span></pre></div>


            <div class="docstring"><p>Get available inspection teams for a specified teacher and lesson.</p>

<p>This endpoint retrieves inspection teams that are available to participate in an inspection for a specific
lesson, excluding teams that already have scheduling conflicts or teams with more than one member from the
teacher's department.</p>

<p>Args:
    teacher_id (int): The unique identifier of the teacher who is being inspected.
    lesson_id (int): The unique identifier of the lesson being inspected.
    db (sessionmaker): The database session dependency injected by FastAPI.</p>

<p>Raises:
    HTTPException: If the lesson or the inspected teacher is not found.</p>

<p>Returns:
    list[dict]: A list of inspection teams that are available for the specified lesson, including the team name
        and members that do not have scheduling conflicts, with no more than one member from the inspected teacher's department.</p>

<p>Example Response:
    [
        {
            "inspection_team_id": 1,
            "inspection_team_name": "Team A",
            "members": [
                {
                    "teacher_id": 3,
                    "teacher_name": "Alice",
                    "teacher_surname": "Johnson",
                    "teacher_title": "Dr.",
                    "teacher_department": "Math"
                },
                {
                    "teacher_id": 4,
                    "teacher_name": "Bob",
                    "teacher_surname": "Lee",
                    "teacher_title": "Prof.",
                    "teacher_department": "Physics"
                }
            ]
        }
    ]</p>
</div>


                </section>
                <section id="get_teachers">
                            <input id="get_teachers-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-app.get">@app.get(&#39;/teachers/&#39;)</div>

        <span class="def">def</span>
        <span class="name">get_teachers</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">db</span><span class="p">:</span> <span class="n">sqlalchemy</span><span class="o">.</span><span class="n">orm</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">sessionmaker</span> <span class="o">=</span> <span class="n">Depends</span><span class="p">(</span><span class="n">get_db</span><span class="p">)</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="get_teachers-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#get_teachers"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="get_teachers-996"><a href="#get_teachers-996"><span class="linenos"> 996</span></a><span class="nd">@app</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;/teachers/&quot;</span><span class="p">)</span>
</span><span id="get_teachers-997"><a href="#get_teachers-997"><span class="linenos"> 997</span></a><span class="k">def</span><span class="w"> </span><span class="nf">get_teachers</span><span class="p">(</span><span class="n">db</span><span class="p">:</span> <span class="n">sessionmaker</span> <span class="o">=</span> <span class="n">Depends</span><span class="p">(</span><span class="n">get_db</span><span class="p">)):</span>
</span><span id="get_teachers-998"><a href="#get_teachers-998"><span class="linenos"> 998</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="get_teachers-999"><a href="#get_teachers-999"><span class="linenos"> 999</span></a><span class="sd">    Fetch all teachers.</span>
</span><span id="get_teachers-1000"><a href="#get_teachers-1000"><span class="linenos">1000</span></a>
</span><span id="get_teachers-1001"><a href="#get_teachers-1001"><span class="linenos">1001</span></a><span class="sd">    This endpoint retrieves a list of all teachers, including their ID, title, name, surname, and department.</span>
</span><span id="get_teachers-1002"><a href="#get_teachers-1002"><span class="linenos">1002</span></a>
</span><span id="get_teachers-1003"><a href="#get_teachers-1003"><span class="linenos">1003</span></a><span class="sd">    Args:</span>
</span><span id="get_teachers-1004"><a href="#get_teachers-1004"><span class="linenos">1004</span></a><span class="sd">        db (sessionmaker): The database session dependency injected by FastAPI.</span>
</span><span id="get_teachers-1005"><a href="#get_teachers-1005"><span class="linenos">1005</span></a>
</span><span id="get_teachers-1006"><a href="#get_teachers-1006"><span class="linenos">1006</span></a><span class="sd">    Returns:</span>
</span><span id="get_teachers-1007"><a href="#get_teachers-1007"><span class="linenos">1007</span></a><span class="sd">        list[dict]: A list of dictionaries containing the teacher details:</span>
</span><span id="get_teachers-1008"><a href="#get_teachers-1008"><span class="linenos">1008</span></a><span class="sd">            - id (int): The ID of the teacher.</span>
</span><span id="get_teachers-1009"><a href="#get_teachers-1009"><span class="linenos">1009</span></a><span class="sd">            - title (str): The title of the teacher.</span>
</span><span id="get_teachers-1010"><a href="#get_teachers-1010"><span class="linenos">1010</span></a><span class="sd">            - name (str): The first name of the teacher.</span>
</span><span id="get_teachers-1011"><a href="#get_teachers-1011"><span class="linenos">1011</span></a><span class="sd">            - surname (str): The surname of the teacher.</span>
</span><span id="get_teachers-1012"><a href="#get_teachers-1012"><span class="linenos">1012</span></a><span class="sd">            - department (str): The department of the teacher.</span>
</span><span id="get_teachers-1013"><a href="#get_teachers-1013"><span class="linenos">1013</span></a>
</span><span id="get_teachers-1014"><a href="#get_teachers-1014"><span class="linenos">1014</span></a><span class="sd">    Example Response:</span>
</span><span id="get_teachers-1015"><a href="#get_teachers-1015"><span class="linenos">1015</span></a><span class="sd">        [</span>
</span><span id="get_teachers-1016"><a href="#get_teachers-1016"><span class="linenos">1016</span></a><span class="sd">            {</span>
</span><span id="get_teachers-1017"><a href="#get_teachers-1017"><span class="linenos">1017</span></a><span class="sd">                &quot;id&quot;: 1,</span>
</span><span id="get_teachers-1018"><a href="#get_teachers-1018"><span class="linenos">1018</span></a><span class="sd">                &quot;title&quot;: &quot;Dr.&quot;,</span>
</span><span id="get_teachers-1019"><a href="#get_teachers-1019"><span class="linenos">1019</span></a><span class="sd">                &quot;name&quot;: &quot;John&quot;,</span>
</span><span id="get_teachers-1020"><a href="#get_teachers-1020"><span class="linenos">1020</span></a><span class="sd">                &quot;surname&quot;: &quot;Doe&quot;,</span>
</span><span id="get_teachers-1021"><a href="#get_teachers-1021"><span class="linenos">1021</span></a><span class="sd">                &quot;department&quot;: &quot;Mathematics&quot;</span>
</span><span id="get_teachers-1022"><a href="#get_teachers-1022"><span class="linenos">1022</span></a><span class="sd">            },</span>
</span><span id="get_teachers-1023"><a href="#get_teachers-1023"><span class="linenos">1023</span></a><span class="sd">            {</span>
</span><span id="get_teachers-1024"><a href="#get_teachers-1024"><span class="linenos">1024</span></a><span class="sd">                &quot;id&quot;: 2,</span>
</span><span id="get_teachers-1025"><a href="#get_teachers-1025"><span class="linenos">1025</span></a><span class="sd">                &quot;title&quot;: &quot;Prof.&quot;,</span>
</span><span id="get_teachers-1026"><a href="#get_teachers-1026"><span class="linenos">1026</span></a><span class="sd">                &quot;name&quot;: &quot;Jane&quot;,</span>
</span><span id="get_teachers-1027"><a href="#get_teachers-1027"><span class="linenos">1027</span></a><span class="sd">                &quot;surname&quot;: &quot;Smith&quot;,</span>
</span><span id="get_teachers-1028"><a href="#get_teachers-1028"><span class="linenos">1028</span></a><span class="sd">                &quot;department&quot;: &quot;Physics&quot;</span>
</span><span id="get_teachers-1029"><a href="#get_teachers-1029"><span class="linenos">1029</span></a><span class="sd">            }</span>
</span><span id="get_teachers-1030"><a href="#get_teachers-1030"><span class="linenos">1030</span></a><span class="sd">        ]</span>
</span><span id="get_teachers-1031"><a href="#get_teachers-1031"><span class="linenos">1031</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="get_teachers-1032"><a href="#get_teachers-1032"><span class="linenos">1032</span></a>
</span><span id="get_teachers-1033"><a href="#get_teachers-1033"><span class="linenos">1033</span></a>    <span class="n">teachers</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">Teacher</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
</span><span id="get_teachers-1034"><a href="#get_teachers-1034"><span class="linenos">1034</span></a>    <span class="k">return</span> <span class="p">[</span>
</span><span id="get_teachers-1035"><a href="#get_teachers-1035"><span class="linenos">1035</span></a>        <span class="p">{</span>
</span><span id="get_teachers-1036"><a href="#get_teachers-1036"><span class="linenos">1036</span></a>            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="n">teacher</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
</span><span id="get_teachers-1037"><a href="#get_teachers-1037"><span class="linenos">1037</span></a>            <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="n">teacher</span><span class="o">.</span><span class="n">title</span><span class="p">,</span>
</span><span id="get_teachers-1038"><a href="#get_teachers-1038"><span class="linenos">1038</span></a>            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">teacher</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="get_teachers-1039"><a href="#get_teachers-1039"><span class="linenos">1039</span></a>            <span class="s2">&quot;surname&quot;</span><span class="p">:</span> <span class="n">teacher</span><span class="o">.</span><span class="n">surname</span><span class="p">,</span>
</span><span id="get_teachers-1040"><a href="#get_teachers-1040"><span class="linenos">1040</span></a>            <span class="s2">&quot;department&quot;</span><span class="p">:</span> <span class="n">teacher</span><span class="o">.</span><span class="n">department</span><span class="p">,</span>
</span><span id="get_teachers-1041"><a href="#get_teachers-1041"><span class="linenos">1041</span></a>        <span class="p">}</span>
</span><span id="get_teachers-1042"><a href="#get_teachers-1042"><span class="linenos">1042</span></a>        <span class="k">for</span> <span class="n">teacher</span> <span class="ow">in</span> <span class="n">teachers</span>
</span><span id="get_teachers-1043"><a href="#get_teachers-1043"><span class="linenos">1043</span></a>    <span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Fetch all teachers.</p>

<p>This endpoint retrieves a list of all teachers, including their ID, title, name, surname, and department.</p>

<p>Args:
    db (sessionmaker): The database session dependency injected by FastAPI.</p>

<p>Returns:
    list[dict]: A list of dictionaries containing the teacher details:
        - id (int): The ID of the teacher.
        - title (str): The title of the teacher.
        - name (str): The first name of the teacher.
        - surname (str): The surname of the teacher.
        - department (str): The department of the teacher.</p>

<p>Example Response:
    [
        {
            "id": 1,
            "title": "Dr.",
            "name": "John",
            "surname": "Doe",
            "department": "Mathematics"
        },
        {
            "id": 2,
            "title": "Prof.",
            "name": "Jane",
            "surname": "Smith",
            "department": "Physics"
        }
    ]</p>
</div>


                </section>
                <section id="get_subjects">
                            <input id="get_subjects-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-app.get">@app.get(&#39;/unique-subjects/{teacher_id}/&#39;)</div>

        <span class="def">def</span>
        <span class="name">get_subjects</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">teacher_id</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">db</span><span class="p">:</span> <span class="n">sqlalchemy</span><span class="o">.</span><span class="n">orm</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">sessionmaker</span> <span class="o">=</span> <span class="n">Depends</span><span class="p">(</span><span class="n">get_db</span><span class="p">)</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="get_subjects-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#get_subjects"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="get_subjects-1046"><a href="#get_subjects-1046"><span class="linenos">1046</span></a><span class="nd">@app</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;/unique-subjects/</span><span class="si">{teacher_id}</span><span class="s2">/&quot;</span><span class="p">)</span>
</span><span id="get_subjects-1047"><a href="#get_subjects-1047"><span class="linenos">1047</span></a><span class="k">def</span><span class="w"> </span><span class="nf">get_subjects</span><span class="p">(</span><span class="n">teacher_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">db</span><span class="p">:</span> <span class="n">sessionmaker</span> <span class="o">=</span> <span class="n">Depends</span><span class="p">(</span><span class="n">get_db</span><span class="p">)):</span>
</span><span id="get_subjects-1048"><a href="#get_subjects-1048"><span class="linenos">1048</span></a>    <span class="n">subjects</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="get_subjects-1049"><a href="#get_subjects-1049"><span class="linenos">1049</span></a>        <span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">Subject</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">Subject</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">Subject</span><span class="o">.</span><span class="n">code</span><span class="p">,</span> <span class="n">Subject</span><span class="o">.</span><span class="n">type</span><span class="p">)</span>
</span><span id="get_subjects-1050"><a href="#get_subjects-1050"><span class="linenos">1050</span></a>        <span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">Lesson</span><span class="p">,</span> <span class="n">Lesson</span><span class="o">.</span><span class="n">fk_subject</span> <span class="o">==</span> <span class="n">Subject</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
</span><span id="get_subjects-1051"><a href="#get_subjects-1051"><span class="linenos">1051</span></a>        <span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">Teacher</span><span class="p">,</span> <span class="n">Teacher</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">Lesson</span><span class="o">.</span><span class="n">fk_teacher</span><span class="p">)</span>
</span><span id="get_subjects-1052"><a href="#get_subjects-1052"><span class="linenos">1052</span></a>        <span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">Teacher</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">teacher_id</span><span class="p">)</span>
</span><span id="get_subjects-1053"><a href="#get_subjects-1053"><span class="linenos">1053</span></a>        <span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">Lesson</span><span class="o">.</span><span class="n">time</span> <span class="o">&gt;=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">())</span>
</span><span id="get_subjects-1054"><a href="#get_subjects-1054"><span class="linenos">1054</span></a>        <span class="o">.</span><span class="n">all</span><span class="p">()</span>
</span><span id="get_subjects-1055"><a href="#get_subjects-1055"><span class="linenos">1055</span></a>    <span class="p">)</span>
</span><span id="get_subjects-1056"><a href="#get_subjects-1056"><span class="linenos">1056</span></a>    <span class="n">result</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="get_subjects-1057"><a href="#get_subjects-1057"><span class="linenos">1057</span></a>        <span class="p">{</span>
</span><span id="get_subjects-1058"><a href="#get_subjects-1058"><span class="linenos">1058</span></a>            <span class="s2">&quot;subject_id&quot;</span><span class="p">:</span> <span class="n">subject</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
</span><span id="get_subjects-1059"><a href="#get_subjects-1059"><span class="linenos">1059</span></a>            <span class="s2">&quot;subject_name&quot;</span><span class="p">:</span> <span class="n">subject</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="get_subjects-1060"><a href="#get_subjects-1060"><span class="linenos">1060</span></a>            <span class="s2">&quot;subject_code&quot;</span><span class="p">:</span> <span class="n">subject</span><span class="o">.</span><span class="n">code</span><span class="p">,</span>
</span><span id="get_subjects-1061"><a href="#get_subjects-1061"><span class="linenos">1061</span></a>            <span class="s2">&quot;subject_type&quot;</span><span class="p">:</span> <span class="n">subject</span><span class="o">.</span><span class="n">type</span><span class="p">,</span>
</span><span id="get_subjects-1062"><a href="#get_subjects-1062"><span class="linenos">1062</span></a>        <span class="p">}</span>
</span><span id="get_subjects-1063"><a href="#get_subjects-1063"><span class="linenos">1063</span></a>        <span class="k">for</span> <span class="n">subject</span> <span class="ow">in</span> <span class="n">subjects</span>
</span><span id="get_subjects-1064"><a href="#get_subjects-1064"><span class="linenos">1064</span></a>    <span class="p">]</span>
</span><span id="get_subjects-1065"><a href="#get_subjects-1065"><span class="linenos">1065</span></a>
</span><span id="get_subjects-1066"><a href="#get_subjects-1066"><span class="linenos">1066</span></a>    <span class="k">return</span> <span class="n">result</span>
</span></pre></div>


    

                </section>
                <section id="get_lessons">
                            <input id="get_lessons-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-app.get">@app.get(&#39;/lessons/&#39;, response_model=list[LessonBase])</div>

        <span class="def">def</span>
        <span class="name">get_lessons</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">semester</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">db</span><span class="p">:</span> <span class="n">sqlalchemy</span><span class="o">.</span><span class="n">orm</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">sessionmaker</span> <span class="o">=</span> <span class="n">Depends</span><span class="p">(</span><span class="n">get_db</span><span class="p">)</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="get_lessons-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#get_lessons"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="get_lessons-1069"><a href="#get_lessons-1069"><span class="linenos">1069</span></a><span class="nd">@app</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;/lessons/&quot;</span><span class="p">,</span> <span class="n">response_model</span><span class="o">=</span><span class="nb">list</span><span class="p">[</span><span class="n">LessonBase</span><span class="p">])</span>
</span><span id="get_lessons-1070"><a href="#get_lessons-1070"><span class="linenos">1070</span></a><span class="k">def</span><span class="w"> </span><span class="nf">get_lessons</span><span class="p">(</span><span class="n">semester</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">db</span><span class="p">:</span> <span class="n">sessionmaker</span> <span class="o">=</span> <span class="n">Depends</span><span class="p">(</span><span class="n">get_db</span><span class="p">)):</span>
</span><span id="get_lessons-1071"><a href="#get_lessons-1071"><span class="linenos">1071</span></a>    <span class="n">lessons</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">Lesson</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">Lesson</span><span class="o">.</span><span class="n">semester</span> <span class="o">==</span> <span class="n">semester</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
</span><span id="get_lessons-1072"><a href="#get_lessons-1072"><span class="linenos">1072</span></a>
</span><span id="get_lessons-1073"><a href="#get_lessons-1073"><span class="linenos">1073</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">lessons</span><span class="p">:</span>
</span><span id="get_lessons-1074"><a href="#get_lessons-1074"><span class="linenos">1074</span></a>        <span class="k">raise</span> <span class="n">HTTPException</span><span class="p">(</span>
</span><span id="get_lessons-1075"><a href="#get_lessons-1075"><span class="linenos">1075</span></a>            <span class="n">status_code</span><span class="o">=</span><span class="mi">404</span><span class="p">,</span> <span class="n">detail</span><span class="o">=</span><span class="s2">&quot;No lessons found for the selected semester.&quot;</span>
</span><span id="get_lessons-1076"><a href="#get_lessons-1076"><span class="linenos">1076</span></a>        <span class="p">)</span>
</span><span id="get_lessons-1077"><a href="#get_lessons-1077"><span class="linenos">1077</span></a>
</span><span id="get_lessons-1078"><a href="#get_lessons-1078"><span class="linenos">1078</span></a>    <span class="k">return</span> <span class="n">lessons</span>
</span></pre></div>


    

                </section>
                <section id="get_available_semesters">
                            <input id="get_available_semesters-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-app.get">@app.get(&#39;/inspection-schedule/semesters/&#39;)</div>

        <span class="def">def</span>
        <span class="name">get_available_semesters</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">db</span><span class="p">:</span> <span class="n">sqlalchemy</span><span class="o">.</span><span class="n">orm</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">sessionmaker</span> <span class="o">=</span> <span class="n">Depends</span><span class="p">(</span><span class="n">get_db</span><span class="p">)</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="get_available_semesters-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#get_available_semesters"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="get_available_semesters-1081"><a href="#get_available_semesters-1081"><span class="linenos">1081</span></a><span class="nd">@app</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;/inspection-schedule/semesters/&quot;</span><span class="p">)</span>
</span><span id="get_available_semesters-1082"><a href="#get_available_semesters-1082"><span class="linenos">1082</span></a><span class="k">def</span><span class="w"> </span><span class="nf">get_available_semesters</span><span class="p">(</span><span class="n">db</span><span class="p">:</span> <span class="n">sessionmaker</span> <span class="o">=</span> <span class="n">Depends</span><span class="p">(</span><span class="n">get_db</span><span class="p">)):</span>
</span><span id="get_available_semesters-1083"><a href="#get_available_semesters-1083"><span class="linenos">1083</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="get_available_semesters-1084"><a href="#get_available_semesters-1084"><span class="linenos">1084</span></a><span class="sd">    Get a list of available semesters for inspection schedules.</span>
</span><span id="get_available_semesters-1085"><a href="#get_available_semesters-1085"><span class="linenos">1085</span></a>
</span><span id="get_available_semesters-1086"><a href="#get_available_semesters-1086"><span class="linenos">1086</span></a><span class="sd">    This endpoint retrieves a list of distinct semesters from the inspection schedules available in the database.</span>
</span><span id="get_available_semesters-1087"><a href="#get_available_semesters-1087"><span class="linenos">1087</span></a>
</span><span id="get_available_semesters-1088"><a href="#get_available_semesters-1088"><span class="linenos">1088</span></a><span class="sd">    Args:</span>
</span><span id="get_available_semesters-1089"><a href="#get_available_semesters-1089"><span class="linenos">1089</span></a><span class="sd">        db (sessionmaker): The database session dependency injected by FastAPI.</span>
</span><span id="get_available_semesters-1090"><a href="#get_available_semesters-1090"><span class="linenos">1090</span></a>
</span><span id="get_available_semesters-1091"><a href="#get_available_semesters-1091"><span class="linenos">1091</span></a><span class="sd">    Returns:</span>
</span><span id="get_available_semesters-1092"><a href="#get_available_semesters-1092"><span class="linenos">1092</span></a><span class="sd">        list[str]: A list of distinct semesters (e.g., &quot;2021-Spring&quot;, &quot;2022-Fall&quot;).</span>
</span><span id="get_available_semesters-1093"><a href="#get_available_semesters-1093"><span class="linenos">1093</span></a>
</span><span id="get_available_semesters-1094"><a href="#get_available_semesters-1094"><span class="linenos">1094</span></a><span class="sd">    Example Response:</span>
</span><span id="get_available_semesters-1095"><a href="#get_available_semesters-1095"><span class="linenos">1095</span></a><span class="sd">        [&quot;2021-Spring&quot;, &quot;2022-Fall&quot;]</span>
</span><span id="get_available_semesters-1096"><a href="#get_available_semesters-1096"><span class="linenos">1096</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="get_available_semesters-1097"><a href="#get_available_semesters-1097"><span class="linenos">1097</span></a>
</span><span id="get_available_semesters-1098"><a href="#get_available_semesters-1098"><span class="linenos">1098</span></a>    <span class="n">semesters</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">InspectionSchedule</span><span class="o">.</span><span class="n">year_semester</span><span class="p">)</span><span class="o">.</span><span class="n">distinct</span><span class="p">()</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
</span><span id="get_available_semesters-1099"><a href="#get_available_semesters-1099"><span class="linenos">1099</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">semesters</span><span class="p">:</span>
</span><span id="get_available_semesters-1100"><a href="#get_available_semesters-1100"><span class="linenos">1100</span></a>        <span class="k">return</span> <span class="p">[]</span>
</span><span id="get_available_semesters-1101"><a href="#get_available_semesters-1101"><span class="linenos">1101</span></a>    <span class="k">return</span> <span class="p">[</span><span class="n">semester</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">semester</span> <span class="ow">in</span> <span class="n">semesters</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Get a list of available semesters for inspection schedules.</p>

<p>This endpoint retrieves a list of distinct semesters from the inspection schedules available in the database.</p>

<p>Args:
    db (sessionmaker): The database session dependency injected by FastAPI.</p>

<p>Returns:
    list[str]: A list of distinct semesters (e.g., "2021-Spring", "2022-Fall").</p>

<p>Example Response:
    ["2021-Spring", "2022-Fall"]</p>
</div>


                </section>
                <section id="get_schedule">
                            <input id="get_schedule-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-app.get">@app.get(&#39;/schedule/&#39;)</div>

        <span class="def">def</span>
        <span class="name">get_schedule</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">semester</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">db</span><span class="p">:</span> <span class="n">sqlalchemy</span><span class="o">.</span><span class="n">orm</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">sessionmaker</span> <span class="o">=</span> <span class="n">Depends</span><span class="p">(</span><span class="n">get_db</span><span class="p">)</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="get_schedule-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#get_schedule"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="get_schedule-1104"><a href="#get_schedule-1104"><span class="linenos">1104</span></a><span class="nd">@app</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;/schedule/&quot;</span><span class="p">)</span>
</span><span id="get_schedule-1105"><a href="#get_schedule-1105"><span class="linenos">1105</span></a><span class="k">def</span><span class="w"> </span><span class="nf">get_schedule</span><span class="p">(</span><span class="n">semester</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">db</span><span class="p">:</span> <span class="n">sessionmaker</span> <span class="o">=</span> <span class="n">Depends</span><span class="p">(</span><span class="n">get_db</span><span class="p">)):</span>
</span><span id="get_schedule-1106"><a href="#get_schedule-1106"><span class="linenos">1106</span></a>    <span class="n">lessons</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="get_schedule-1107"><a href="#get_schedule-1107"><span class="linenos">1107</span></a>        <span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">Lesson</span><span class="p">)</span>
</span><span id="get_schedule-1108"><a href="#get_schedule-1108"><span class="linenos">1108</span></a>        <span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">Subject</span><span class="p">,</span> <span class="n">Lesson</span><span class="o">.</span><span class="n">fk_subject</span> <span class="o">==</span> <span class="n">Subject</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
</span><span id="get_schedule-1109"><a href="#get_schedule-1109"><span class="linenos">1109</span></a>        <span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">Teacher</span><span class="p">,</span> <span class="n">Lesson</span><span class="o">.</span><span class="n">fk_teacher</span> <span class="o">==</span> <span class="n">Teacher</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
</span><span id="get_schedule-1110"><a href="#get_schedule-1110"><span class="linenos">1110</span></a>        <span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">Inspection</span><span class="p">,</span> <span class="n">Inspection</span><span class="o">.</span><span class="n">fk_lesson</span> <span class="o">==</span> <span class="n">Lesson</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
</span><span id="get_schedule-1111"><a href="#get_schedule-1111"><span class="linenos">1111</span></a>        <span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="get_schedule-1112"><a href="#get_schedule-1112"><span class="linenos">1112</span></a>            <span class="n">InspectionSchedule</span><span class="p">,</span>
</span><span id="get_schedule-1113"><a href="#get_schedule-1113"><span class="linenos">1113</span></a>            <span class="n">InspectionSchedule</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">Inspection</span><span class="o">.</span><span class="n">fk_inspectionSchedule</span><span class="p">,</span>
</span><span id="get_schedule-1114"><a href="#get_schedule-1114"><span class="linenos">1114</span></a>        <span class="p">)</span>
</span><span id="get_schedule-1115"><a href="#get_schedule-1115"><span class="linenos">1115</span></a>        <span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">InspectionSchedule</span><span class="o">.</span><span class="n">year_semester</span> <span class="o">==</span> <span class="n">semester</span><span class="p">)</span>
</span><span id="get_schedule-1116"><a href="#get_schedule-1116"><span class="linenos">1116</span></a>        <span class="o">.</span><span class="n">all</span><span class="p">()</span>
</span><span id="get_schedule-1117"><a href="#get_schedule-1117"><span class="linenos">1117</span></a>    <span class="p">)</span>
</span><span id="get_schedule-1118"><a href="#get_schedule-1118"><span class="linenos">1118</span></a>
</span><span id="get_schedule-1119"><a href="#get_schedule-1119"><span class="linenos">1119</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">lessons</span><span class="p">:</span>
</span><span id="get_schedule-1120"><a href="#get_schedule-1120"><span class="linenos">1120</span></a>        <span class="k">return</span> <span class="p">[]</span>
</span><span id="get_schedule-1121"><a href="#get_schedule-1121"><span class="linenos">1121</span></a>
</span><span id="get_schedule-1122"><a href="#get_schedule-1122"><span class="linenos">1122</span></a>    <span class="n">schedule</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="get_schedule-1123"><a href="#get_schedule-1123"><span class="linenos">1123</span></a>    <span class="k">for</span> <span class="n">lesson</span> <span class="ow">in</span> <span class="n">lessons</span><span class="p">:</span>
</span><span id="get_schedule-1124"><a href="#get_schedule-1124"><span class="linenos">1124</span></a>        <span class="n">inspection</span> <span class="o">=</span> <span class="n">lesson</span><span class="o">.</span><span class="n">inspections</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">lesson</span><span class="o">.</span><span class="n">inspections</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="get_schedule-1125"><a href="#get_schedule-1125"><span class="linenos">1125</span></a>        <span class="n">teachers_in_team</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="get_schedule-1126"><a href="#get_schedule-1126"><span class="linenos">1126</span></a>
</span><span id="get_schedule-1127"><a href="#get_schedule-1127"><span class="linenos">1127</span></a>        <span class="k">if</span> <span class="n">inspection</span><span class="p">:</span>
</span><span id="get_schedule-1128"><a href="#get_schedule-1128"><span class="linenos">1128</span></a>            <span class="k">for</span> <span class="n">teacher_team</span> <span class="ow">in</span> <span class="n">inspection</span><span class="o">.</span><span class="n">inspection_team</span><span class="o">.</span><span class="n">teachers</span><span class="p">:</span>
</span><span id="get_schedule-1129"><a href="#get_schedule-1129"><span class="linenos">1129</span></a>                <span class="n">teachers_in_team</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="get_schedule-1130"><a href="#get_schedule-1130"><span class="linenos">1130</span></a>                    <span class="p">{</span>
</span><span id="get_schedule-1131"><a href="#get_schedule-1131"><span class="linenos">1131</span></a>                        <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="n">teacher_team</span><span class="o">.</span><span class="n">teacher</span><span class="o">.</span><span class="n">title</span><span class="p">,</span>
</span><span id="get_schedule-1132"><a href="#get_schedule-1132"><span class="linenos">1132</span></a>                        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">teacher_team</span><span class="o">.</span><span class="n">teacher</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="get_schedule-1133"><a href="#get_schedule-1133"><span class="linenos">1133</span></a>                        <span class="s2">&quot;surname&quot;</span><span class="p">:</span> <span class="n">teacher_team</span><span class="o">.</span><span class="n">teacher</span><span class="o">.</span><span class="n">surname</span><span class="p">,</span>
</span><span id="get_schedule-1134"><a href="#get_schedule-1134"><span class="linenos">1134</span></a>                    <span class="p">}</span>
</span><span id="get_schedule-1135"><a href="#get_schedule-1135"><span class="linenos">1135</span></a>                <span class="p">)</span>
</span><span id="get_schedule-1136"><a href="#get_schedule-1136"><span class="linenos">1136</span></a>
</span><span id="get_schedule-1137"><a href="#get_schedule-1137"><span class="linenos">1137</span></a>        <span class="n">schedule</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="get_schedule-1138"><a href="#get_schedule-1138"><span class="linenos">1138</span></a>            <span class="p">{</span>
</span><span id="get_schedule-1139"><a href="#get_schedule-1139"><span class="linenos">1139</span></a>                <span class="s2">&quot;lesson&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="get_schedule-1140"><a href="#get_schedule-1140"><span class="linenos">1140</span></a>                    <span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="n">lesson</span><span class="o">.</span><span class="n">time</span><span class="p">,</span>
</span><span id="get_schedule-1141"><a href="#get_schedule-1141"><span class="linenos">1141</span></a>                    <span class="s2">&quot;room&quot;</span><span class="p">:</span> <span class="n">lesson</span><span class="o">.</span><span class="n">room</span><span class="p">,</span>
</span><span id="get_schedule-1142"><a href="#get_schedule-1142"><span class="linenos">1142</span></a>                    <span class="s2">&quot;building&quot;</span><span class="p">:</span> <span class="n">lesson</span><span class="o">.</span><span class="n">building</span><span class="p">,</span>
</span><span id="get_schedule-1143"><a href="#get_schedule-1143"><span class="linenos">1143</span></a>                <span class="p">},</span>
</span><span id="get_schedule-1144"><a href="#get_schedule-1144"><span class="linenos">1144</span></a>                <span class="s2">&quot;subject&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="get_schedule-1145"><a href="#get_schedule-1145"><span class="linenos">1145</span></a>                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">lesson</span><span class="o">.</span><span class="n">subject</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="get_schedule-1146"><a href="#get_schedule-1146"><span class="linenos">1146</span></a>                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">lesson</span><span class="o">.</span><span class="n">subject</span><span class="o">.</span><span class="n">type</span><span class="p">,</span>
</span><span id="get_schedule-1147"><a href="#get_schedule-1147"><span class="linenos">1147</span></a>                <span class="p">},</span>
</span><span id="get_schedule-1148"><a href="#get_schedule-1148"><span class="linenos">1148</span></a>                <span class="s2">&quot;teacher&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="get_schedule-1149"><a href="#get_schedule-1149"><span class="linenos">1149</span></a>                    <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="n">lesson</span><span class="o">.</span><span class="n">teacher</span><span class="o">.</span><span class="n">title</span><span class="p">,</span>
</span><span id="get_schedule-1150"><a href="#get_schedule-1150"><span class="linenos">1150</span></a>                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">lesson</span><span class="o">.</span><span class="n">teacher</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="get_schedule-1151"><a href="#get_schedule-1151"><span class="linenos">1151</span></a>                    <span class="s2">&quot;surname&quot;</span><span class="p">:</span> <span class="n">lesson</span><span class="o">.</span><span class="n">teacher</span><span class="o">.</span><span class="n">surname</span><span class="p">,</span>
</span><span id="get_schedule-1152"><a href="#get_schedule-1152"><span class="linenos">1152</span></a>                <span class="p">},</span>
</span><span id="get_schedule-1153"><a href="#get_schedule-1153"><span class="linenos">1153</span></a>                <span class="s2">&quot;inspection_team&quot;</span><span class="p">:</span> <span class="n">teachers_in_team</span><span class="p">,</span>
</span><span id="get_schedule-1154"><a href="#get_schedule-1154"><span class="linenos">1154</span></a>            <span class="p">}</span>
</span><span id="get_schedule-1155"><a href="#get_schedule-1155"><span class="linenos">1155</span></a>        <span class="p">)</span>
</span><span id="get_schedule-1156"><a href="#get_schedule-1156"><span class="linenos">1156</span></a>
</span><span id="get_schedule-1157"><a href="#get_schedule-1157"><span class="linenos">1157</span></a>    <span class="k">return</span> <span class="n">schedule</span>
</span></pre></div>


    

                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>